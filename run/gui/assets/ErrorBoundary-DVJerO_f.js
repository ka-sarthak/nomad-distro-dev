import{R as p,r,j as e,L as R,ak as S,al as E,am as b,b0 as D,an as L,o as k,B as v,l as P}from"./material-react-table-Clsq1WEk.js";import{cw as _,ag as y,cx as w,cy as B,g as M,cz as V,bj as g,bV as W,b_ as F,cA as I,cB as N,cC as U,cD as A,O as T,cE as $,P as q,E as z,cF as G,bf as H}from"./index-ByzPaSZm.js";const J=p.forwardRef(function(s,a){const{navigate:n}=_(),l=r.useCallback(()=>{s.to&&n(s.to)},[n,s.to]);return e.jsx(R,{...s,href:"#",onClick:l,ref:a})});function K({url:t,...s}){const[a,n]=y(t||"/"),l=r.useMemo(()=>{const[d,x]=a.split("?");return{path:d,rawSearch:Object.fromEntries(new URLSearchParams(x||"").entries())}},[a]),c=r.useCallback(d=>{n(d)},[n]),i=r.useMemo(()=>({navigate:c,createLink:(d,x)=>e.jsx(J,{ref:x,...d})}),[c]);return e.jsx(w.Provider,{value:i,children:e.jsx(B,{...s,location:l,navigate:c})})}const O={routeId:"selectRoot",path:"",component:function(){return e.jsxs(v,{sx:{height:"70vh",position:"relative"},children:[e.jsx(A,{}),e.jsx(T,{})]})},errorComponent:function(){const s=$();return e.jsx(v,{sx:{height:"70vh",position:"relative"},children:e.jsx(q,{maxWidth:"unset",variant:"dialog",children:e.jsx(z,{error:s})})})},children:[G]};function te({children:t,component:s,initialPath:a,title:n,description:l,selectButtonLabel:c,onSelect:i,selectOptions:d,...x}){const f=s,[u,o]=r.useState(!1),j=r.useCallback(()=>o(!0),[o]),h=r.useCallback(()=>o(!1),[o]),C=r.useCallback(m=>{o(!1),i?.(m)},[o,i]);return e.jsxs(e.Fragment,{children:[e.jsx(f,{...x,title:n,onClick:j,children:t}),e.jsx(Q,{open:u,onCancel:h,onSelect:C,selectOptions:d,initialPath:a,title:n,description:l,selectButtonLabel:c})]})}function Q({selectOptions:t,initialPath:s,title:a,description:n,selectButtonLabel:l="Select",onSelect:c,onCancel:i,open:d,...x}){const[f,u]=r.useState(void 0),o=r.useCallback(()=>{i?.()},[i]),j=r.useCallback(()=>{M(f!==void 0,"SelectedPath must be defined when select button is clicked."),c?.(f)},[c,f]);return d?e.jsxs(S,{open:!0,onClose:o,fullWidth:!0,maxWidth:"xl",...x,children:[a&&e.jsx(E,{children:a}),n&&e.jsx(b,{children:e.jsx(D,{children:n})}),e.jsx(b,{sx:h=>({padding:0,borderWidth:1,borderStyle:"solid",borderColor:h.palette.divider,borderLeft:"none",borderRight:"none",backgroundColor:h.palette.background.default}),children:e.jsx(X,{selectOptions:t,initialPath:s,onChange:u})}),e.jsxs(L,{children:[e.jsx(k,{onClick:o,title:"Cancel",children:"Cancel"}),e.jsx(k,{onClick:j,disabled:f===void 0,title:"Select",children:l})]})]}):null}function X({selectOptions:t={},initialPath:s,onChange:a}){const[n,l]=r.useState(s),c=V(t),{entity:i}=t,d=r.useCallback(({location:x,fullMatch:f})=>{const u=f[f.length-1];l(x);let o=!1;if(i==="file"){o=g(u.route,W),o&&=u.response?.m_is==="File";const{filePattern:h}=t;if(h){const C=u.path;o&&=C.match(h)!==null}}else if(i==="directory")o=g(u.route,F),o&&=u.response?.m_is==="Directory";else if(i==="section"){o=g(u.route,I),o&&=u.response?.m_def!==void 0;const{sectionDefinition:h}=t;if(h){const C=u.response?.m_def;o&&=C.m_ref===h||C.all_base_sections.some(m=>m.m_ref===h)}}const j=decodeURIComponent(x);a?.(o?j:void 0)},[l,a,i,t]);return e.jsx(N.Provider,{value:c,children:e.jsx(K,{route:O,loader:U,url:n,onNavigate:d})})}function Y({error:t,message:s}){return e.jsxs("div",{children:[s&&e.jsxs("span",{children:[s,": "]}),e.jsx("span",{children:t.message})]})}function se(t){const{renderError:s=n=>e.jsx(Y,{error:n,message:t.message}),children:a}=t;return e.jsx(H,{fallbackRender:({error:n,resetErrorBoundary:l})=>e.jsx(P,{onClick:()=>l(),sx:{borderColor:c=>c.palette.error.main,padding:1,overflow:"auto"},children:s(n)}),children:a})}export{se as E,te as S};
