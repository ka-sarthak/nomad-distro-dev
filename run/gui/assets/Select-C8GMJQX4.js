import{j as e,aP as p,R,r,L as S,ag as E,ah as P,ai as b,a$ as D,aj as L,q as k,B as v}from"./material-react-table-DBlzLFj3.js";import{ai as y,cp as _,aN as w,cq as B,cr as M,i as N,cs as W,bg as g,bP as q,bT as I,ct as T,cu as U,cv as V,cw as $,O as F,cx as A,P as z,E as G,cy as H}from"./index-Db9INgJo.js";function J({error:t,message:s}){return e.jsxs("div",{children:[s&&e.jsxs("span",{children:[s,": "]}),e.jsx("span",{children:t.message})]})}function te(t){const{renderError:s=n=>e.jsx(J,{error:n,message:t.message}),children:a}=t;return e.jsx(y,{fallbackRender:({error:n,resetErrorBoundary:l})=>e.jsx(p,{onClick:()=>l(),sx:{borderColor:c=>c.palette.error.main,padding:1,overflow:"auto"},children:s(n)}),children:a})}const K=R.forwardRef(function(s,a){const{navigate:n}=_(),l=r.useCallback(()=>{s.to&&n(s.to)},[n,s.to]);return e.jsx(S,{...s,href:"#",onClick:l,ref:a})});function O({url:t,...s}){const[a,n]=w(t||"/"),l=r.useMemo(()=>{const[d,x]=a.split("?");return{path:d,rawSearch:Object.fromEntries(new URLSearchParams(x||"").entries())}},[a]),c=r.useCallback(d=>{n(d)},[n]),i=r.useMemo(()=>({navigate:c,createLink:(d,x)=>e.jsx(K,{ref:x,...d})}),[c]);return e.jsx(B.Provider,{value:i,children:e.jsx(M,{...s,location:l,navigate:c})})}const Q={routeId:"selectRoot",path:"",component:function(){return e.jsxs(v,{sx:{height:"70vh",position:"relative"},children:[e.jsx($,{}),e.jsx(F,{})]})},errorComponent:function(){const s=A();return e.jsx(v,{sx:{height:"70vh",position:"relative"},children:e.jsx(z,{maxWidth:"unset",variant:"dialog",children:e.jsx(G,{error:s})})})},children:[H]};function se({children:t,component:s,initialPath:a,title:n,description:l,selectButtonLabel:c,onSelect:i,selectOptions:d,...x}){const f=s,[u,o]=r.useState(!1),j=r.useCallback(()=>o(!0),[o]),h=r.useCallback(()=>o(!1),[o]),C=r.useCallback(m=>{o(!1),i?.(m)},[o,i]);return e.jsxs(e.Fragment,{children:[e.jsx(f,{...x,title:n,onClick:j,children:t}),e.jsx(X,{open:u,onCancel:h,onSelect:C,selectOptions:d,initialPath:a,title:n,description:l,selectButtonLabel:c})]})}function X({selectOptions:t,initialPath:s,title:a,description:n,selectButtonLabel:l="Select",onSelect:c,onCancel:i,open:d,...x}){const[f,u]=r.useState(void 0),o=r.useCallback(()=>{i?.()},[i]),j=r.useCallback(()=>{N(f!==void 0,"SelectedPath must be defined when select button is clicked."),c?.(f)},[c,f]);return d?e.jsxs(E,{open:!0,onClose:o,fullWidth:!0,maxWidth:"xl",...x,children:[a&&e.jsx(P,{children:a}),n&&e.jsx(b,{children:e.jsx(D,{children:n})}),e.jsx(b,{sx:h=>({padding:0,borderWidth:1,borderStyle:"solid",borderColor:h.palette.divider,borderLeft:"none",borderRight:"none",backgroundColor:h.palette.background.default}),children:e.jsx(Y,{selectOptions:t,initialPath:s,onChange:u})}),e.jsxs(L,{children:[e.jsx(k,{onClick:o,title:"Cancel",children:"Cancel"}),e.jsx(k,{onClick:j,disabled:f===void 0,title:"Select",children:l})]})]}):null}function Y({selectOptions:t={},initialPath:s,onChange:a}){const[n,l]=r.useState(s),c=W(t),{entity:i}=t,d=r.useCallback(({location:x,fullMatch:f})=>{const u=f[f.length-1];l(x);let o=!1;if(i==="file"){o=g(u.route,q),o&&=u.response?.m_is==="File";const{filePattern:h}=t;if(h){const C=u.path;o&&=C.match(h)!==null}}else if(i==="directory")o=g(u.route,I),o&&=u.response?.m_is==="Directory";else if(i==="section"){o=g(u.route,T),o&&=u.response?.m_def!==void 0;const{sectionDefinition:h}=t;if(h){const C=u.response?.m_def;o&&=C.m_ref===h||C.all_base_sections.some(m=>m.m_ref===h)}}const j=decodeURIComponent(x);a?.(o?j:void 0)},[l,a,i,t]);return e.jsx(U.Provider,{value:c,children:e.jsx(O,{route:Q,loader:V,url:n,onNavigate:d})})}export{te as E,se as S};
