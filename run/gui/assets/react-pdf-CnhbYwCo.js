import{r as reactExports,R as React,P as PropTypes,c as clsx}from"./material-react-table-Clsq1WEk.js";import{a as getAugmentedNamespace,g as getDefaultExportFromCjs}from"./@mapbox/rehype-prism-vXukC30A.js";function _mergeNamespaces(A,n){for(var _=0;_<n.length;_++){const r=n[_];if(typeof r!="string"&&!Array.isArray(r)){for(const u in r)if(u!=="default"&&!(u in A)){const w=Object.getOwnPropertyDescriptor(r,u);w&&Object.defineProperty(A,u,w.get?w:{enumerable:!0,get:()=>r[u]})}}}return Object.freeze(Object.defineProperty(A,Symbol.toStringTag,{value:"Module"}))}const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);function commonjsRequire(A){throw new Error('Could not dynamically require "'+A+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$1={exports:{}},hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,function(module,exports){(function(n,_){module.exports=n.pdfjsLib=_()})(globalThis,()=>(()=>{var __webpack_modules__=[,(A,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.VerbosityLevel=n.Util=n.UnknownErrorException=n.UnexpectedResponseException=n.TextRenderingMode=n.RenderingIntentFlag=n.PromiseCapability=n.PermissionFlag=n.PasswordResponses=n.PasswordException=n.PageActionEventType=n.OPS=n.MissingPDFException=n.MAX_IMAGE_SIZE_TO_CACHE=n.LINE_FACTOR=n.LINE_DESCENT_FACTOR=n.InvalidPDFException=n.ImageKind=n.IDENTITY_MATRIX=n.FormatError=n.FeatureTest=n.FONT_IDENTITY_MATRIX=n.DocumentActionEventType=n.CMapCompressionType=n.BaseException=n.BASELINE_FACTOR=n.AnnotationType=n.AnnotationReplyType=n.AnnotationPrefix=n.AnnotationMode=n.AnnotationFlag=n.AnnotationFieldFlag=n.AnnotationEditorType=n.AnnotationEditorPrefix=n.AnnotationEditorParamsType=n.AnnotationBorderStyleType=n.AnnotationActionEventType=n.AbortException=void 0,n.assert=d,n.bytesToString=O,n.createValidAbsoluteUrl=y,n.getModificationDate=pt,n.getUuid=St,n.getVerbosityLevel=it,n.info=K,n.isArrayBuffer=dt,n.isArrayEqual=_t,n.isNodeJS=void 0,n.normalizeUnicode=Rt,n.objectFromMap=q,n.objectSize=st,n.setVerbosityLevel=Z,n.shadow=M,n.string32=z,n.stringToBytes=W,n.stringToPDFString=lt,n.stringToUTF8String=ct,n.unreachable=b,n.utf8StringToString=ht,n.warn=L;const _=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");n.isNodeJS=_;const r=[1,0,0,1,0,0];n.IDENTITY_MATRIX=r;const u=[.001,0,0,.001,0,0];n.FONT_IDENTITY_MATRIX=u;const w=1e7;n.MAX_IMAGE_SIZE_TO_CACHE=w;const T=1.35;n.LINE_FACTOR=T;const N=.35;n.LINE_DESCENT_FACTOR=N;const F=N/T;n.BASELINE_FACTOR=F;const i={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};n.RenderingIntentFlag=i;const t={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};n.AnnotationMode=t;const s="pdfjs_internal_editor_";n.AnnotationEditorPrefix=s;const c={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};n.AnnotationEditorType=c;const l={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};n.AnnotationEditorParamsType=l;const e={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};n.PermissionFlag=e;const h={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};n.TextRenderingMode=h;const g={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};n.ImageKind=g;const o={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};n.AnnotationType=o;const S={GROUP:"Group",REPLY:"R"};n.AnnotationReplyType=S;const R={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};n.AnnotationFlag=R;const P={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};n.AnnotationFieldFlag=P;const p={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};n.AnnotationBorderStyleType=p;const E={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};n.AnnotationActionEventType=E;const j={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};n.DocumentActionEventType=j;const U={O:"PageOpen",C:"PageClose"};n.PageActionEventType=U;const I={ERRORS:0,WARNINGS:1,INFOS:5};n.VerbosityLevel=I;const G={NONE:0,BINARY:1};n.CMapCompressionType=G;const H={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};n.OPS=H;const nt={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};n.PasswordResponses=nt;let Q=I.WARNINGS;function Z(et){Number.isInteger(et)&&(Q=et)}function it(){return Q}function K(et){Q>=I.INFOS&&console.log(`Info: ${et}`)}function L(et){Q>=I.WARNINGS&&console.log(`Warning: ${et}`)}function b(et){throw new Error(et)}function d(et,V){et||b(V)}function f(et){switch(et?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function y(et,V=null,$=null){if(!et)return null;try{if($&&typeof et=="string"&&($.addDefaultProtocol&&et.startsWith("www.")&&et.match(/\./g)?.length>=2&&(et=`http://${et}`),$.tryConvertEncoding))try{et=ct(et)}catch{}const at=V?new URL(et,V):new URL(et);if(f(at))return at}catch{}return null}function M(et,V,$,at=!1){return Object.defineProperty(et,V,{value:$,enumerable:!at,configurable:!0,writable:!1}),$}const D=function(){function V($,at){this.constructor===V&&b("Cannot initialize BaseException."),this.message=$,this.name=at}return V.prototype=new Error,V.constructor=V,V}();n.BaseException=D;class B extends D{constructor(V,$){super(V,"PasswordException"),this.code=$}}n.PasswordException=B;class C extends D{constructor(V,$){super(V,"UnknownErrorException"),this.details=$}}n.UnknownErrorException=C;class a extends D{constructor(V){super(V,"InvalidPDFException")}}n.InvalidPDFException=a;class m extends D{constructor(V){super(V,"MissingPDFException")}}n.MissingPDFException=m;class v extends D{constructor(V,$){super(V,"UnexpectedResponseException"),this.status=$}}n.UnexpectedResponseException=v;class x extends D{constructor(V){super(V,"FormatError")}}n.FormatError=x;class k extends D{constructor(V){super(V,"AbortException")}}n.AbortException=k;function O(et){(typeof et!="object"||et?.length===void 0)&&b("Invalid argument for bytesToString");const V=et.length,$=8192;if(V<$)return String.fromCharCode.apply(null,et);const at=[];for(let ut=0;ut<V;ut+=$){const mt=Math.min(ut+$,V),bt=et.subarray(ut,mt);at.push(String.fromCharCode.apply(null,bt))}return at.join("")}function W(et){typeof et!="string"&&b("Invalid argument for stringToBytes");const V=et.length,$=new Uint8Array(V);for(let at=0;at<V;++at)$[at]=et.charCodeAt(at)&255;return $}function z(et){return String.fromCharCode(et>>24&255,et>>16&255,et>>8&255,et&255)}function st(et){return Object.keys(et).length}function q(et){const V=Object.create(null);for(const[$,at]of et)V[$]=at;return V}function X(){const et=new Uint8Array(4);return et[0]=1,new Uint32Array(et.buffer,0,1)[0]===1}function Y(){try{return new Function(""),!0}catch{return!1}}class J{static get isLittleEndian(){return M(this,"isLittleEndian",X())}static get isEvalSupported(){return M(this,"isEvalSupported",Y())}static get isOffscreenCanvasSupported(){return M(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?M(this,"platform",{isWin:!1,isMac:!1}):M(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){return M(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}n.FeatureTest=J;const tt=[...Array(256).keys()].map(et=>et.toString(16).padStart(2,"0"));class rt{static makeHexColor(V,$,at){return`#${tt[V]}${tt[$]}${tt[at]}`}static scaleMinMax(V,$){let at;V[0]?(V[0]<0&&(at=$[0],$[0]=$[1],$[1]=at),$[0]*=V[0],$[1]*=V[0],V[3]<0&&(at=$[2],$[2]=$[3],$[3]=at),$[2]*=V[3],$[3]*=V[3]):(at=$[0],$[0]=$[2],$[2]=at,at=$[1],$[1]=$[3],$[3]=at,V[1]<0&&(at=$[2],$[2]=$[3],$[3]=at),$[2]*=V[1],$[3]*=V[1],V[2]<0&&(at=$[0],$[0]=$[1],$[1]=at),$[0]*=V[2],$[1]*=V[2]),$[0]+=V[4],$[1]+=V[4],$[2]+=V[5],$[3]+=V[5]}static transform(V,$){return[V[0]*$[0]+V[2]*$[1],V[1]*$[0]+V[3]*$[1],V[0]*$[2]+V[2]*$[3],V[1]*$[2]+V[3]*$[3],V[0]*$[4]+V[2]*$[5]+V[4],V[1]*$[4]+V[3]*$[5]+V[5]]}static applyTransform(V,$){const at=V[0]*$[0]+V[1]*$[2]+$[4],ut=V[0]*$[1]+V[1]*$[3]+$[5];return[at,ut]}static applyInverseTransform(V,$){const at=$[0]*$[3]-$[1]*$[2],ut=(V[0]*$[3]-V[1]*$[2]+$[2]*$[5]-$[4]*$[3])/at,mt=(-V[0]*$[1]+V[1]*$[0]+$[4]*$[1]-$[5]*$[0])/at;return[ut,mt]}static getAxialAlignedBoundingBox(V,$){const at=this.applyTransform(V,$),ut=this.applyTransform(V.slice(2,4),$),mt=this.applyTransform([V[0],V[3]],$),bt=this.applyTransform([V[2],V[1]],$);return[Math.min(at[0],ut[0],mt[0],bt[0]),Math.min(at[1],ut[1],mt[1],bt[1]),Math.max(at[0],ut[0],mt[0],bt[0]),Math.max(at[1],ut[1],mt[1],bt[1])]}static inverseTransform(V){const $=V[0]*V[3]-V[1]*V[2];return[V[3]/$,-V[1]/$,-V[2]/$,V[0]/$,(V[2]*V[5]-V[4]*V[3])/$,(V[4]*V[1]-V[5]*V[0])/$]}static singularValueDecompose2dScale(V){const $=[V[0],V[2],V[1],V[3]],at=V[0]*$[0]+V[1]*$[2],ut=V[0]*$[1]+V[1]*$[3],mt=V[2]*$[0]+V[3]*$[2],bt=V[2]*$[1]+V[3]*$[3],wt=(at+bt)/2,Ct=Math.sqrt((at+bt)**2-4*(at*bt-mt*ut))/2,Pt=wt+Ct||1,yt=wt-Ct||1;return[Math.sqrt(Pt),Math.sqrt(yt)]}static normalizeRect(V){const $=V.slice(0);return V[0]>V[2]&&($[0]=V[2],$[2]=V[0]),V[1]>V[3]&&($[1]=V[3],$[3]=V[1]),$}static intersect(V,$){const at=Math.max(Math.min(V[0],V[2]),Math.min($[0],$[2])),ut=Math.min(Math.max(V[0],V[2]),Math.max($[0],$[2]));if(at>ut)return null;const mt=Math.max(Math.min(V[1],V[3]),Math.min($[1],$[3])),bt=Math.min(Math.max(V[1],V[3]),Math.max($[1],$[3]));return mt>bt?null:[at,mt,ut,bt]}static bezierBoundingBox(V,$,at,ut,mt,bt,wt,Ct){const Pt=[],yt=[[],[]];let xt,Tt,Dt,ft,Lt,Ot,It,Nt;for(let Bt=0;Bt<2;++Bt){if(Bt===0?(Tt=6*V-12*at+6*mt,xt=-3*V+9*at-9*mt+3*wt,Dt=3*at-3*V):(Tt=6*$-12*ut+6*bt,xt=-3*$+9*ut-9*bt+3*Ct,Dt=3*ut-3*$),Math.abs(xt)<1e-12){if(Math.abs(Tt)<1e-12)continue;ft=-Dt/Tt,0<ft&&ft<1&&Pt.push(ft);continue}It=Tt*Tt-4*Dt*xt,Nt=Math.sqrt(It),!(It<0)&&(Lt=(-Tt+Nt)/(2*xt),0<Lt&&Lt<1&&Pt.push(Lt),Ot=(-Tt-Nt)/(2*xt),0<Ot&&Ot<1&&Pt.push(Ot))}let Ft=Pt.length,At;const Mt=Ft;for(;Ft--;)ft=Pt[Ft],At=1-ft,yt[0][Ft]=At*At*At*V+3*At*At*ft*at+3*At*ft*ft*mt+ft*ft*ft*wt,yt[1][Ft]=At*At*At*$+3*At*At*ft*ut+3*At*ft*ft*bt+ft*ft*ft*Ct;return yt[0][Mt]=V,yt[1][Mt]=$,yt[0][Mt+1]=wt,yt[1][Mt+1]=Ct,yt[0].length=yt[1].length=Mt+2,[Math.min(...yt[0]),Math.min(...yt[1]),Math.max(...yt[0]),Math.max(...yt[1])]}}n.Util=rt;const ot=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function lt(et){if(et[0]>="ï"){let $;if(et[0]==="þ"&&et[1]==="ÿ"?$="utf-16be":et[0]==="ÿ"&&et[1]==="þ"?$="utf-16le":et[0]==="ï"&&et[1]==="»"&&et[2]==="¿"&&($="utf-8"),$)try{const at=new TextDecoder($,{fatal:!0}),ut=W(et);return at.decode(ut)}catch(at){L(`stringToPDFString: "${at}".`)}}const V=[];for(let $=0,at=et.length;$<at;$++){const ut=ot[et.charCodeAt($)];V.push(ut?String.fromCharCode(ut):et.charAt($))}return V.join("")}function ct(et){return decodeURIComponent(escape(et))}function ht(et){return unescape(encodeURIComponent(et))}function dt(et){return typeof et=="object"&&et?.byteLength!==void 0}function _t(et,V){if(et.length!==V.length)return!1;for(let $=0,at=et.length;$<at;$++)if(et[$]!==V[$])return!1;return!0}function pt(et=new Date){return[et.getUTCFullYear().toString(),(et.getUTCMonth()+1).toString().padStart(2,"0"),et.getUTCDate().toString().padStart(2,"0"),et.getUTCHours().toString().padStart(2,"0"),et.getUTCMinutes().toString().padStart(2,"0"),et.getUTCSeconds().toString().padStart(2,"0")].join("")}class Et{#t=!1;constructor(){this.promise=new Promise((V,$)=>{this.resolve=at=>{this.#t=!0,V(at)},this.reject=at=>{this.#t=!0,$(at)}})}get settled(){return this.#t}}n.PromiseCapability=Et;let gt=null,vt=null;function Rt(et){return gt||(gt=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,vt=new Map([["ﬅ","ſt"]])),et.replaceAll(gt,(V,$,at)=>$?$.normalize("NFKC"):vt.get(at))}function St(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();const et=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(et);else for(let V=0;V<32;V++)et[V]=Math.floor(Math.random()*255);return O(et)}const kt="pdfjs_internal_id_";n.AnnotationPrefix=kt},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(A){if(typeof A=="string"||A instanceof URL?A={url:A}:(0,_util.isArrayBuffer)(A)&&(A={data:A}),typeof A!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!A.url&&!A.data&&!A.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const n=new PDFDocumentLoadingTask,{docId:_}=n,r=A.url?getUrlProp(A.url):null,u=A.data?getDataProp(A.data):null,w=A.httpHeaders||null,T=A.withCredentials===!0,N=A.password??null,F=A.range instanceof PDFDataRangeTransport?A.range:null,i=Number.isInteger(A.rangeChunkSize)&&A.rangeChunkSize>0?A.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let t=A.worker instanceof PDFWorker?A.worker:null;const s=A.verbosity,c=typeof A.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(A.docBaseUrl)?A.docBaseUrl:null,l=typeof A.cMapUrl=="string"?A.cMapUrl:null,e=A.cMapPacked!==!1,h=A.CMapReaderFactory||DefaultCMapReaderFactory,g=typeof A.standardFontDataUrl=="string"?A.standardFontDataUrl:null,o=A.StandardFontDataFactory||DefaultStandardFontDataFactory,S=A.stopAtErrors!==!0,R=Number.isInteger(A.maxImageSize)&&A.maxImageSize>-1?A.maxImageSize:-1,P=A.isEvalSupported!==!1,p=typeof A.isOffscreenCanvasSupported=="boolean"?A.isOffscreenCanvasSupported:!_util.isNodeJS,E=Number.isInteger(A.canvasMaxAreaInBytes)?A.canvasMaxAreaInBytes:-1,j=typeof A.disableFontFace=="boolean"?A.disableFontFace:_util.isNodeJS,U=A.fontExtraProperties===!0,I=A.enableXfa===!0,G=A.ownerDocument||globalThis.document,H=A.disableRange===!0,nt=A.disableStream===!0,Q=A.disableAutoFetch===!0,Z=A.pdfBug===!0,it=F?F.length:A.length??NaN,K=typeof A.useSystemFonts=="boolean"?A.useSystemFonts:!_util.isNodeJS&&!j,L=typeof A.useWorkerFetch=="boolean"?A.useWorkerFetch:h===_display_utils.DOMCMapReaderFactory&&o===_display_utils.DOMStandardFontDataFactory&&l&&g&&(0,_display_utils.isValidFetchUrl)(l,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(g,document.baseURI),b=A.canvasFactory||new DefaultCanvasFactory({ownerDocument:G}),d=A.filterFactory||new DefaultFilterFactory({docId:_,ownerDocument:G}),f=null;(0,_util.setVerbosityLevel)(s);const y={canvasFactory:b,filterFactory:d};if(L||(y.cMapReaderFactory=new h({baseUrl:l,isCompressed:e}),y.standardFontDataFactory=new o({baseUrl:g})),!t){const B={verbosity:s,port:_worker_options.GlobalWorkerOptions.workerPort};t=B.port?PDFWorker.fromPort(B):new PDFWorker(B),n._worker=t}const M={docId:_,apiVersion:"3.11.174",data:u,password:N,disableAutoFetch:Q,rangeChunkSize:i,length:it,docBaseUrl:c,enableXfa:I,evaluatorOptions:{maxImageSize:R,disableFontFace:j,ignoreErrors:S,isEvalSupported:P,isOffscreenCanvasSupported:p,canvasMaxAreaInBytes:E,fontExtraProperties:U,useSystemFonts:K,cMapUrl:L?l:null,standardFontDataUrl:L?g:null}},D={ignoreErrors:S,isEvalSupported:P,disableFontFace:j,fontExtraProperties:U,enableXfa:I,ownerDocument:G,disableAutoFetch:Q,pdfBug:Z,styleElement:f};return t.promise.then(function(){if(n.destroyed)throw new Error("Loading aborted");const B=_fetchDocument(t,M),C=new Promise(function(a){let m;F?m=new _transport_stream.PDFDataTransportStream({length:it,initialData:F.initialData,progressiveDone:F.progressiveDone,contentDispositionFilename:F.contentDispositionFilename,disableRange:H,disableStream:nt},F):u||(m=(x=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(x):(0,_display_utils.isValidFetchUrl)(x.url)?new _displayFetch_stream.PDFFetchStream(x):new _displayNetwork.PDFNetworkStream(x))({url:r,length:it,httpHeaders:w,withCredentials:T,rangeChunkSize:i,disableRange:H,disableStream:nt})),a(m)});return Promise.all([B,C]).then(function([a,m]){if(n.destroyed)throw new Error("Loading aborted");const v=new _message_handler.MessageHandler(_,a,t.port),x=new WorkerTransport(v,n,m,D,y);n._transport=x,v.send("Ready",null)})}).catch(n._capability.reject),n}async function _fetchDocument(A,n){if(A.destroyed)throw new Error("Worker was destroyed");const _=await A.messageHandler.sendWithPromise("GetDocRequest",n,n.data?[n.data.buffer]:null);if(A.destroyed)throw new Error("Worker was destroyed");return _}function getUrlProp(A){if(A instanceof URL)return A.href;try{return new URL(A,window.location).href}catch{if(_util.isNodeJS&&typeof A=="string")return A}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(A){if(_util.isNodeJS&&typeof Buffer<"u"&&A instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(A instanceof Uint8Array&&A.byteLength===A.buffer.byteLength)return A;if(typeof A=="string")return(0,_util.stringToBytes)(A);if(typeof A=="object"&&!isNaN(A?.length)||(0,_util.isArrayBuffer)(A))return new Uint8Array(A);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{static#t=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#t++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(n){throw this._worker?.port&&delete this._worker._pendingDestroy,n}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(n,_,r=!1,u=null){this.length=n,this.initialData=_,this.progressiveDone=r,this.contentDispositionFilename=u,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(n){this._rangeListeners.push(n)}addProgressListener(n){this._progressListeners.push(n)}addProgressiveReadListener(n){this._progressiveReadListeners.push(n)}addProgressiveDoneListener(n){this._progressiveDoneListeners.push(n)}onDataRange(n,_){for(const r of this._rangeListeners)r(n,_)}onDataProgress(n,_){this._readyCapability.promise.then(()=>{for(const r of this._progressListeners)r(n,_)})}onDataProgressiveRead(n){this._readyCapability.promise.then(()=>{for(const _ of this._progressiveReadListeners)_(n)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const n of this._progressiveDoneListeners)n()})}transportReady(){this._readyCapability.resolve()}requestDataRange(n,_){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(n,_){this._pdfInfo=n,this._transport=_,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(r=>{if(!r)return r;const u=[];for(const w in r)u.push(...r[w]);return u}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(n){return this._transport.getPage(n)}getPageIndex(n){return this._transport.getPageIndex(n)}getDestinations(){return this._transport.getDestinations()}getDestination(n){return this._transport.getDestination(n)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(n=!1){return this._transport.startCleanup(n||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#t=null;#e=!1;constructor(n,_,r,u=!1){this._pageIndex=n,this._pageInfo=_,this._transport=r,this._stats=u?new _display_utils.StatTimer:null,this._pdfBug=u,this.commonObjs=r.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:n,rotation:_=this.rotate,offsetX:r=0,offsetY:u=0,dontFlip:w=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:n,rotation:_,offsetX:r,offsetY:u,dontFlip:w})}getAnnotations({intent:n="display"}={}){const _=this._transport.getRenderingIntent(n);return this._transport.getAnnotations(this._pageIndex,_.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:n,viewport:_,intent:r="display",annotationMode:u=_util.AnnotationMode.ENABLE,transform:w=null,background:T=null,optionalContentConfigPromise:N=null,annotationCanvasMap:F=null,pageColors:i=null,printAnnotationStorage:t=null}){this._stats?.time("Overall");const s=this._transport.getRenderingIntent(r,u,t);this.#e=!1,this.#s(),N||(N=this._transport.getOptionalContentConfig());let c=this._intentStates.get(s.cacheKey);c||(c=Object.create(null),this._intentStates.set(s.cacheKey,c)),c.streamReaderCancelTimeout&&(clearTimeout(c.streamReaderCancelTimeout),c.streamReaderCancelTimeout=null);const l=!!(s.renderingIntent&_util.RenderingIntentFlag.PRINT);c.displayReadyCapability||(c.displayReadyCapability=new _util.PromiseCapability,c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(s));const e=o=>{c.renderTasks.delete(h),(this._maybeCleanupAfterRender||l)&&(this.#e=!0),this.#n(!l),o?(h.capability.reject(o),this._abortOperatorList({intentState:c,reason:o instanceof Error?o:new Error(o)})):h.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},h=new InternalRenderTask({callback:e,params:{canvasContext:n,viewport:_,transform:w,background:T},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:F,operatorList:c.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!l,pdfBug:this._pdfBug,pageColors:i});(c.renderTasks||=new Set).add(h);const g=h.task;return Promise.all([c.displayReadyCapability.promise,N]).then(([o,S])=>{if(this.destroyed){e();return}this._stats?.time("Rendering"),h.initializeGraphics({transparency:o,optionalContentConfig:S}),h.operatorListChanged()}).catch(e),g}getOperatorList({intent:n="display",annotationMode:_=_util.AnnotationMode.ENABLE,printAnnotationStorage:r=null}={}){function u(){T.operatorList.lastChunk&&(T.opListReadCapability.resolve(T.operatorList),T.renderTasks.delete(N))}const w=this._transport.getRenderingIntent(n,_,r,!0);let T=this._intentStates.get(w.cacheKey);T||(T=Object.create(null),this._intentStates.set(w.cacheKey,T));let N;return T.opListReadCapability||(N=Object.create(null),N.operatorListChanged=u,T.opListReadCapability=new _util.PromiseCapability,(T.renderTasks||=new Set).add(N),T.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(w)),T.opListReadCapability.promise}streamTextContent({includeMarkedContent:n=!1,disableNormalization:_=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:n===!0,disableNormalization:_===!0},{highWaterMark:100,size(u){return u.items.length}})}getTextContent(n={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>_xfa_text.XfaText.textContent(r));const _=this.streamTextContent(n);return new Promise(function(r,u){function w(){T.read().then(function({value:F,done:i}){if(i){r(N);return}Object.assign(N.styles,F.styles),N.items.push(...F.items),w()},u)}const T=_.getReader(),N={items:[],styles:Object.create(null)};w()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const n=[];for(const _ of this._intentStates.values())if(this._abortOperatorList({intentState:_,reason:new Error("Page was destroyed."),force:!0}),!_.opListReadCapability)for(const r of _.renderTasks)n.push(r.completed),r.cancel();return this.objs.clear(),this.#e=!1,this.#s(),Promise.all(n)}cleanup(n=!1){this.#e=!0;const _=this.#n(!1);return n&&_&&(this._stats&&=new _display_utils.StatTimer),_}#n(n=!1){if(this.#s(),!this.#e||this.destroyed)return!1;if(n)return this.#t=setTimeout(()=>{this.#t=null,this.#n(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(const{renderTasks:_,operatorList:r}of this._intentStates.values())if(_.size>0||!r.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}#s(){this.#t&&(clearTimeout(this.#t),this.#t=null)}_startRenderPage(n,_){const r=this._intentStates.get(_);r&&(this._stats?.timeEnd("Page Request"),r.displayReadyCapability?.resolve(n))}_renderPageChunk(n,_){for(let r=0,u=n.length;r<u;r++)_.operatorList.fnArray.push(n.fnArray[r]),_.operatorList.argsArray.push(n.argsArray[r]);_.operatorList.lastChunk=n.lastChunk,_.operatorList.separateAnnots=n.separateAnnots;for(const r of _.renderTasks)r.operatorListChanged();n.lastChunk&&this.#n(!0)}_pumpOperatorList({renderingIntent:n,cacheKey:_,annotationStorageSerializable:r}){const{map:u,transfers:w}=r,N=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:n,cacheKey:_,annotationStorage:u},w).getReader(),F=this._intentStates.get(_);F.streamReader=N;const i=()=>{N.read().then(({value:t,done:s})=>{if(s){F.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(t,F),i())},t=>{if(F.streamReader=null,!this._transport.destroyed){if(F.operatorList){F.operatorList.lastChunk=!0;for(const s of F.renderTasks)s.operatorListChanged();this.#n(!0)}if(F.displayReadyCapability)F.displayReadyCapability.reject(t);else if(F.opListReadCapability)F.opListReadCapability.reject(t);else throw t}})};i()}_abortOperatorList({intentState:n,reason:_,force:r=!1}){if(n.streamReader){if(n.streamReaderCancelTimeout&&(clearTimeout(n.streamReaderCancelTimeout),n.streamReaderCancelTimeout=null),!r){if(n.renderTasks.size>0)return;if(_ instanceof _display_utils.RenderingCancelledException){let u=RENDERING_CANCELLED_TIMEOUT;_.extraDelay>0&&_.extraDelay<1e3&&(u+=_.extraDelay),n.streamReaderCancelTimeout=setTimeout(()=>{n.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:n,reason:_,force:!0})},u);return}}if(n.streamReader.cancel(new _util.AbortException(_.message)).catch(()=>{}),n.streamReader=null,!this._transport.destroyed){for(const[u,w]of this._intentStates)if(w===n){this._intentStates.delete(u);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{#t=new Set;#e=Promise.resolve();postMessage(n,_){const r={data:structuredClone(n,_?{transfer:_}:null)};this.#e.then(()=>{for(const u of this.#t)u.call(this,r)})}addEventListener(n,_){this.#t.add(_)}removeEventListener(n,_){this.#t.delete(_)}terminate(){this.#t.clear()}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const A=document?.currentScript?.src;A&&(PDFWorkerUtil.fallbackWorkerSrc=A.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(A,n){let _;try{if(_=new URL(A),!_.origin||_.origin==="null")return!1}catch{return!1}const r=new URL(n,_);return _.origin===r.origin},PDFWorkerUtil.createCDNWrapper=function(A){const n=`importScripts("${A}");`;return URL.createObjectURL(new Blob([n]))}}class PDFWorker{static#workerPorts;constructor({name:A=null,port:n=null,verbosity:_=(0,_util.getVerbosityLevel)()}={}){if(this.name=A,this.destroyed=!1,this.verbosity=_,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,n){if(PDFWorker.#workerPorts?.has(n))throw new Error("Cannot use more than one PDFWorker per port.");(PDFWorker.#workerPorts||=new WeakMap).set(n,this),this._initializeFromPort(n);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(A){this._port=A,this._messageHandler=new _message_handler.MessageHandler("main","worker",A),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:A}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,A)||(A=PDFWorkerUtil.createCDNWrapper(new URL(A,window.location).href));const n=new Worker(A),_=new _message_handler.MessageHandler("main","worker",n),r=()=>{n.removeEventListener("error",u),_.destroy(),n.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},u=()=>{this._webWorker||r()};n.addEventListener("error",u),_.on("test",T=>{if(n.removeEventListener("error",u),this.destroyed){r();return}T?(this._messageHandler=_,this._port=n,this._webWorker=n,this._readyCapability.resolve(),_.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),_.destroy(),n.terminate())}),_.on("ready",T=>{if(n.removeEventListener("error",u),this.destroyed){r();return}try{w()}catch{this._setupFakeWorker()}});const w=()=>{const T=new Uint8Array;_.send("test",T,[T.buffer])};w();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(A=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const n=new LoopbackPort;this._port=n;const _=`fake${PDFWorkerUtil.fakeWorkerId++}`,r=new _message_handler.MessageHandler(_+"_worker",_,n);A.setup(r,n);const u=new _message_handler.MessageHandler(_,_+"_worker",n);this._messageHandler=u,this._readyCapability.resolve(),u.send("configure",{verbosity:this.verbosity})}).catch(A=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${A.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#workerPorts?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(A){if(!A?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const n=this.#workerPorts?.get(A.port);if(n){if(n._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return n}return new PDFWorker(A)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker;class WorkerTransport{#t=new Map;#e=new Map;#n=new Map;#s=null;constructor(n,_,r,u,w){this.messageHandler=n,this.loadingTask=_,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:u.ownerDocument,styleElement:u.styleElement}),this._params=u,this.canvasFactory=w.canvasFactory,this.filterFactory=w.filterFactory,this.cMapReaderFactory=w.cMapReaderFactory,this.standardFontDataFactory=w.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#o(n,_=null){const r=this.#t.get(n);if(r)return r;const u=this.messageHandler.sendWithPromise(n,_);return this.#t.set(n,u),u}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(n,_=_util.AnnotationMode.ENABLE,r=null,u=!1){let w=_util.RenderingIntentFlag.DISPLAY,T=_annotation_storage.SerializableEmpty;switch(n){case"any":w=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":w=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${n}`)}switch(_){case _util.AnnotationMode.DISABLE:w+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:w+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:w+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,T=(w&_util.RenderingIntentFlag.PRINT&&r instanceof _annotation_storage.PrintAnnotationStorage?r:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${_}`)}return u&&(w+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:w,cacheKey:`${w}_${T.hash}`,annotationStorageSerializable:T}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const n=[];for(const r of this.#e.values())n.push(r._destroy());this.#e.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const _=this.messageHandler.sendWithPromise("Terminate",null);return n.push(_),Promise.all(n).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),this._networkStream?.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:n,loadingTask:_}=this;n.on("GetReader",(r,u)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=w=>{this._lastProgress={loaded:w.loaded,total:w.total}},u.onPull=()=>{this._fullReader.read().then(function({value:w,done:T}){if(T){u.close();return}(0,_util.assert)(w instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),u.enqueue(new Uint8Array(w),1,[w])}).catch(w=>{u.error(w)})},u.onCancel=w=>{this._fullReader.cancel(w),u.ready.catch(T=>{if(!this.destroyed)throw T})}}),n.on("ReaderHeadersReady",r=>{const u=new _util.PromiseCapability,w=this._fullReader;return w.headersReady.then(()=>{(!w.isStreamingSupported||!w.isRangeSupported)&&(this._lastProgress&&_.onProgress?.(this._lastProgress),w.onProgress=T=>{_.onProgress?.({loaded:T.loaded,total:T.total})}),u.resolve({isStreamingSupported:w.isStreamingSupported,isRangeSupported:w.isRangeSupported,contentLength:w.contentLength})},u.reject),u.promise}),n.on("GetRangeReader",(r,u)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const w=this._networkStream.getRangeReader(r.begin,r.end);if(!w){u.close();return}u.onPull=()=>{w.read().then(function({value:T,done:N}){if(N){u.close();return}(0,_util.assert)(T instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),u.enqueue(new Uint8Array(T),1,[T])}).catch(T=>{u.error(T)})},u.onCancel=T=>{w.cancel(T),u.ready.catch(N=>{if(!this.destroyed)throw N})}}),n.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,_._capability.resolve(new PDFDocumentProxy(r,this))}),n.on("DocException",function(r){let u;switch(r.name){case"PasswordException":u=new _util.PasswordException(r.message,r.code);break;case"InvalidPDFException":u=new _util.InvalidPDFException(r.message);break;case"MissingPDFException":u=new _util.MissingPDFException(r.message);break;case"UnexpectedResponseException":u=new _util.UnexpectedResponseException(r.message,r.status);break;case"UnknownErrorException":u=new _util.UnknownErrorException(r.message,r.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}_._capability.reject(u)}),n.on("PasswordRequest",r=>{if(this.#s=new _util.PromiseCapability,_.onPassword){const u=w=>{w instanceof Error?this.#s.reject(w):this.#s.resolve({password:w})};try{_.onPassword(u,r.code)}catch(w){this.#s.reject(w)}}else this.#s.reject(new _util.PasswordException(r.message,r.code));return this.#s.promise}),n.on("DataLoaded",r=>{_.onProgress?.({loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),n.on("StartRenderPage",r=>{if(this.destroyed)return;this.#e.get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),n.on("commonobj",([r,u,w])=>{if(!this.destroyed&&!this.commonObjs.has(r))switch(u){case"Font":const T=this._params;if("error"in w){const i=w.error;(0,_util.warn)(`Error during font loading: ${i}`),this.commonObjs.resolve(r,i);break}const N=T.pdfBug&&globalThis.FontInspector?.enabled?(i,t)=>globalThis.FontInspector.fontAdded(i,t):null,F=new _font_loader.FontFaceObject(w,{isEvalSupported:T.isEvalSupported,disableFontFace:T.disableFontFace,ignoreErrors:T.ignoreErrors,inspectFont:N});this.fontLoader.bind(F).catch(i=>n.sendWithPromise("FontFallback",{id:r})).finally(()=>{!T.fontExtraProperties&&F.data&&(F.data=null),this.commonObjs.resolve(r,F)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(r,w);break;default:throw new Error(`Got unknown common object type ${u}`)}}),n.on("obj",([r,u,w,T])=>{if(this.destroyed)return;const N=this.#e.get(u);if(!N.objs.has(r))switch(w){case"Image":if(N.objs.resolve(r,T),T){let F;if(T.bitmap){const{width:i,height:t}=T;F=i*t*4}else F=T.data?.length||0;F>_util.MAX_IMAGE_SIZE_TO_CACHE&&(N._maybeCleanupAfterRender=!0)}break;case"Pattern":N.objs.resolve(r,T);break;default:throw new Error(`Got unknown object type ${w}`)}}),n.on("DocProgress",r=>{this.destroyed||_.onProgress?.({loaded:r.loaded,total:r.total})}),n.on("FetchBuiltInCMap",r=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(r):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),n.on("FetchStandardFontData",r=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(r):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:n,transfers:_}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:n,filename:this._fullReader?.filename??null},_).finally(()=>{this.annotationStorage.resetModified()})}getPage(n){if(!Number.isInteger(n)||n<=0||n>this._numPages)return Promise.reject(new Error("Invalid page request."));const _=n-1,r=this.#n.get(_);if(r)return r;const u=this.messageHandler.sendWithPromise("GetPage",{pageIndex:_}).then(w=>{if(this.destroyed)throw new Error("Transport destroyed");const T=new PDFPageProxy(_,w,this,this._params.pdfBug);return this.#e.set(_,T),T});return this.#n.set(_,u),u}getPageIndex(n){return typeof n!="object"||n===null||!Number.isInteger(n.num)||n.num<0||!Number.isInteger(n.gen)||n.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:n.num,gen:n.gen})}getAnnotations(n,_){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:n,intent:_})}getFieldObjects(){return this.#o("GetFieldObjects")}hasJSActions(){return this.#o("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(n){return typeof n!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:n})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#o("GetDocJSActions")}getPageJSActions(n){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:n})}getStructTree(n){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:n})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(n=>new _optional_content_config.OptionalContentConfig(n))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const n="GetMetadata",_=this.#t.get(n);if(_)return _;const r=this.messageHandler.sendWithPromise(n,null).then(u=>({info:u[0],metadata:u[1]?new _metadata.Metadata(u[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(n,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(n=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const _ of this.#e.values())if(!_.cleanup())throw new Error(`startCleanup: Page ${_.pageNumber} is currently rendering.`);this.commonObjs.clear(),n||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:n,enableXfa:_}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:n,enableXfa:_})}}class PDFObjects{#t=Object.create(null);#e(n){return this.#t[n]||={capability:new _util.PromiseCapability,data:null}}get(n,_=null){if(_){const u=this.#e(n);return u.capability.promise.then(()=>_(u.data)),null}const r=this.#t[n];if(!r?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${n}.`);return r.data}has(n){return this.#t[n]?.capability.settled||!1}resolve(n,_=null){const r=this.#e(n);r.data=_,r.capability.resolve()}clear(){for(const n in this.#t){const{data:_}=this.#t[n];_?.bitmap?.close()}this.#t=Object.create(null)}}class RenderTask{#t=null;constructor(n){this.#t=n,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(n=0){this.#t.cancel(null,n)}get separateAnnots(){const{separateAnnots:n}=this.#t.operatorList;if(!n)return!1;const{annotationCanvasMap:_}=this.#t;return n.form||n.canvas&&_?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#t=new WeakSet;constructor({callback:n,params:_,objs:r,commonObjs:u,annotationCanvasMap:w,operatorList:T,pageIndex:N,canvasFactory:F,filterFactory:i,useRequestAnimationFrame:t=!1,pdfBug:s=!1,pageColors:c=null}){this.callback=n,this.params=_,this.objs=r,this.commonObjs=u,this.annotationCanvasMap=w,this.operatorListIdx=null,this.operatorList=T,this._pageIndex=N,this.canvasFactory=F,this.filterFactory=i,this._pdfBug=s,this.pageColors=c,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=t===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=_.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:n=!1,optionalContentConfig:_}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:r,viewport:u,transform:w,background:T}=this.params;this.gfx=new _canvas.CanvasGraphics(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:_},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:w,viewport:u,transparency:n,background:T}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(n=null,_=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),InternalRenderTask.#t.delete(this._canvas),this.callback(n||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,_))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),InternalRenderTask.#t.delete(this._canvas),this.callback())))}}const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SerializableEmpty=n.PrintAnnotationStorage=n.AnnotationStorage=void 0;var r=_(1),u=_(4),w=_(8);const T=Object.freeze({map:null,hash:"",transfers:void 0});n.SerializableEmpty=T;class N{#t=!1;#e=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,s){const c=this.#e.get(t);return c===void 0?s:Object.assign(s,c)}getRawValue(t){return this.#e.get(t)}remove(t){if(this.#e.delete(t),this.#e.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const s of this.#e.values())if(s instanceof u.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(t,s){const c=this.#e.get(t);let l=!1;if(c!==void 0)for(const[e,h]of Object.entries(s))c[e]!==h&&(l=!0,c[e]=h);else l=!0,this.#e.set(t,s);l&&this.#n(),s instanceof u.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(s.constructor._type)}has(t){return this.#e.has(t)}getAll(){return this.#e.size>0?(0,r.objectFromMap)(this.#e):null}setAll(t){for(const[s,c]of Object.entries(t))this.setValue(s,c)}get size(){return this.#e.size}#n(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new F(this)}get serializable(){if(this.#e.size===0)return T;const t=new Map,s=new w.MurmurHash3_64,c=[],l=Object.create(null);let e=!1;for(const[h,g]of this.#e){const o=g instanceof u.AnnotationEditor?g.serialize(!1,l):g;o&&(t.set(h,o),s.update(`${h}:${JSON.stringify(o)}`),e||=!!o.bitmap)}if(e)for(const h of t.values())h.bitmap&&c.push(h.bitmap);return t.size>0?{map:t,hash:s.hexdigest(),transfers:c}:T}}n.AnnotationStorage=N;class F extends N{#t;constructor(t){super();const{map:s,hash:c,transfers:l}=t.serializable,e=structuredClone(s,l?{transfer:l}:null);this.#t={map:e,hash:c,transfers:l}}get print(){(0,r.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}}n.PrintAnnotationStorage=F},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditor=void 0;var r=_(5),u=_(1),w=_(6);class T{#t="";#e=!1;#n=null;#s=null;#o=null;#a=!1;#r=null;#l=this.focusin.bind(this);#c=this.focusout.bind(this);#i=!1;#f=!1;#d=!1;_initialOptions=Object.create(null);_uiManager=null;_focusEventsAllowed=!0;_l10nPromise=null;#u=!1;#p=T._zIndex++;static _borderLineWidth=-1;static _colorManager=new r.ColorManager;static _zIndex=1;static SMALL_EDITOR_SIZE=0;constructor(i){this.constructor===T&&(0,u.unreachable)("Cannot initialize AnnotationEditor."),this.parent=i.parent,this.id=i.id,this.width=this.height=null,this.pageIndex=i.parent.pageIndex,this.name=i.name,this.div=null,this._uiManager=i.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=i.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:s,pageHeight:c,pageX:l,pageY:e}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,c],this.pageTranslation=[l,e];const[h,g]=this.parentDimensions;this.x=i.x/h,this.y=i.y/g,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,u.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(i){const t=new N({id:i.parent.getNextId(),parent:i.parent,uiManager:i._uiManager});t.annotationElementId=i.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(i,t=null){if(T._l10nPromise||=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(c=>[c,i.get(c)])),t?.strings)for(const c of t.strings)T._l10nPromise.set(c,i.get(c));if(T._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);T._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(i,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(i){return!1}static paste(i,t){(0,u.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#u}set _isDraggable(i){this.#u=i,this.div?.classList.toggle("draggable",i)}center(){const[i,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(i*2),this.y+=this.width*i/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(i*2),this.y-=this.width*i/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(i){this._uiManager.addCommands(i)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#p}setParent(i){i!==null&&(this.pageIndex=i.pageIndex,this.pageDimensions=i.pageDimensions),this.parent=i}focusin(i){this._focusEventsAllowed&&(this.#i?this.#i=!1:this.parent.setSelected(this))}focusout(i){!this._focusEventsAllowed||!this.isAttachedToDOM||i.relatedTarget?.closest(`#${this.id}`)||(i.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(i,t,s,c){const[l,e]=this.parentDimensions;[s,c]=this.screenToPageTranslation(s,c),this.x=(i+s)/l,this.y=(t+c)/e,this.fixAndSetPosition()}#b([i,t],s,c){[s,c]=this.screenToPageTranslation(s,c),this.x+=s/i,this.y+=c/t,this.fixAndSetPosition()}translate(i,t){this.#b(this.parentDimensions,i,t)}translateInPage(i,t){this.#b(this.pageDimensions,i,t),this.div.scrollIntoView({block:"nearest"})}drag(i,t){const[s,c]=this.parentDimensions;if(this.x+=i/s,this.y+=t/c,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:o,y:S}=this.div.getBoundingClientRect();this.parent.findNewParent(this,o,S)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:e}=this;const[h,g]=this.#m();l+=h,e+=g,this.div.style.left=`${(100*l).toFixed(2)}%`,this.div.style.top=`${(100*e).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}#m(){const[i,t]=this.parentDimensions,{_borderLineWidth:s}=T,c=s/i,l=s/t;switch(this.rotation){case 90:return[-c,l];case 180:return[c,l];case 270:return[c,-l];default:return[-c,-l]}}fixAndSetPosition(){const[i,t]=this.pageDimensions;let{x:s,y:c,width:l,height:e}=this;switch(l*=i,e*=t,s*=i,c*=t,this.rotation){case 0:s=Math.max(0,Math.min(i-l,s)),c=Math.max(0,Math.min(t-e,c));break;case 90:s=Math.max(0,Math.min(i-e,s)),c=Math.min(t,Math.max(l,c));break;case 180:s=Math.min(i,Math.max(l,s)),c=Math.min(t,Math.max(e,c));break;case 270:s=Math.min(i,Math.max(e,s)),c=Math.max(0,Math.min(t-l,c));break}this.x=s/=i,this.y=c/=t;const[h,g]=this.#m();s+=h,c+=g;const{style:o}=this.div;o.left=`${(100*s).toFixed(2)}%`,o.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}static#g(i,t,s){switch(s){case 90:return[t,-i];case 180:return[-i,-t];case 270:return[-t,i];default:return[i,t]}}screenToPageTranslation(i,t){return T.#g(i,t,this.parentRotation)}pageTranslationToScreen(i,t){return T.#g(i,t,360-this.parentRotation)}#h(i){switch(i){case 90:{const[t,s]=this.pageDimensions;return[0,-t/s,s/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,s]=this.pageDimensions;return[0,t/s,-s/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:i,pageDimensions:[t,s]}=this,c=t*i,l=s*i;return u.FeatureTest.isCSSRoundSupported?[Math.round(c),Math.round(l)]:[c,l]}setDims(i,t){const[s,c]=this.parentDimensions;this.div.style.width=`${(100*i/s).toFixed(2)}%`,this.#a||(this.div.style.height=`${(100*t/c).toFixed(2)}%`),this.#n?.classList.toggle("small",i<T.SMALL_EDITOR_SIZE||t<T.SMALL_EDITOR_SIZE)}fixDims(){const{style:i}=this.div,{height:t,width:s}=i,c=s.endsWith("%"),l=!this.#a&&t.endsWith("%");if(c&&l)return;const[e,h]=this.parentDimensions;c||(i.width=`${(100*parseFloat(s)/e).toFixed(2)}%`),!this.#a&&!l&&(i.height=`${(100*parseFloat(t)/h).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#_(){if(this.#r)return;this.#r=document.createElement("div"),this.#r.classList.add("resizers");const i=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||i.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const t of i){const s=document.createElement("div");this.#r.append(s),s.classList.add("resizer",t),s.addEventListener("pointerdown",this.#S.bind(this,t)),s.addEventListener("contextmenu",w.noContextMenu)}this.div.prepend(this.#r)}#S(i,t){t.preventDefault();const{isMac:s}=u.FeatureTest.platform;if(t.button!==0||t.ctrlKey&&s)return;const c=this.#E.bind(this,i),l=this._isDraggable;this._isDraggable=!1;const e={passive:!0,capture:!0};window.addEventListener("pointermove",c,e);const h=this.x,g=this.y,o=this.width,S=this.height,R=this.parent.div.style.cursor,P=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const p=()=>{this._isDraggable=l,window.removeEventListener("pointerup",p),window.removeEventListener("blur",p),window.removeEventListener("pointermove",c,e),this.parent.div.style.cursor=R,this.div.style.cursor=P;const E=this.x,j=this.y,U=this.width,I=this.height;E===h&&j===g&&U===o&&I===S||this.addCommands({cmd:()=>{this.width=U,this.height=I,this.x=E,this.y=j;const[G,H]=this.parentDimensions;this.setDims(G*U,H*I),this.fixAndSetPosition()},undo:()=>{this.width=o,this.height=S,this.x=h,this.y=g;const[G,H]=this.parentDimensions;this.setDims(G*o,H*S),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",p),window.addEventListener("blur",p)}#E(i,t){const[s,c]=this.parentDimensions,l=this.x,e=this.y,h=this.width,g=this.height,o=T.MIN_SIZE/s,S=T.MIN_SIZE/c,R=C=>Math.round(C*1e4)/1e4,P=this.#h(this.rotation),p=(C,a)=>[P[0]*C+P[2]*a,P[1]*C+P[3]*a],E=this.#h(360-this.rotation),j=(C,a)=>[E[0]*C+E[2]*a,E[1]*C+E[3]*a];let U,I,G=!1,H=!1;switch(i){case"topLeft":G=!0,U=(C,a)=>[0,0],I=(C,a)=>[C,a];break;case"topMiddle":U=(C,a)=>[C/2,0],I=(C,a)=>[C/2,a];break;case"topRight":G=!0,U=(C,a)=>[C,0],I=(C,a)=>[0,a];break;case"middleRight":H=!0,U=(C,a)=>[C,a/2],I=(C,a)=>[0,a/2];break;case"bottomRight":G=!0,U=(C,a)=>[C,a],I=(C,a)=>[0,0];break;case"bottomMiddle":U=(C,a)=>[C/2,a],I=(C,a)=>[C/2,0];break;case"bottomLeft":G=!0,U=(C,a)=>[0,a],I=(C,a)=>[C,0];break;case"middleLeft":H=!0,U=(C,a)=>[0,a/2],I=(C,a)=>[C,a/2];break}const nt=U(h,g),Q=I(h,g);let Z=p(...Q);const it=R(l+Z[0]),K=R(e+Z[1]);let L=1,b=1,[d,f]=this.screenToPageTranslation(t.movementX,t.movementY);if([d,f]=j(d/s,f/c),G){const C=Math.hypot(h,g);L=b=Math.max(Math.min(Math.hypot(Q[0]-nt[0]-d,Q[1]-nt[1]-f)/C,1/h,1/g),o/h,S/g)}else H?L=Math.max(o,Math.min(1,Math.abs(Q[0]-nt[0]-d)))/h:b=Math.max(S,Math.min(1,Math.abs(Q[1]-nt[1]-f)))/g;const y=R(h*L),M=R(g*b);Z=p(...I(y,M));const D=it-Z[0],B=K-Z[1];this.width=y,this.height=M,this.x=D,this.y=B,this.setDims(s*y,c*M),this.fixAndSetPosition()}async addAltTextButton(){if(this.#n)return;const i=this.#n=document.createElement("button");i.className="altText";const t=await T._l10nPromise.get("editor_alt_text_button_label");i.textContent=t,i.setAttribute("aria-label",t),i.tabIndex="0",i.addEventListener("contextmenu",w.noContextMenu),i.addEventListener("pointerdown",s=>s.stopPropagation()),i.addEventListener("click",s=>{s.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),i.addEventListener("keydown",s=>{s.target===i&&s.key==="Enter"&&(s.preventDefault(),this._uiManager.editAltText(this))}),this.#w(),this.div.append(i),T.SMALL_EDITOR_SIZE||(T.SMALL_EDITOR_SIZE=Math.min(128,Math.round(i.getBoundingClientRect().width*1.4)))}async#w(){const i=this.#n;if(!i)return;if(!this.#t&&!this.#e){i.classList.remove("done"),this.#s?.remove();return}T._l10nPromise.get("editor_alt_text_edit_button_label").then(s=>{i.setAttribute("aria-label",s)});let t=this.#s;if(!t){this.#s=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip");const s=t.id=`alt-text-tooltip-${this.id}`;i.setAttribute("aria-describedby",s);const c=100;i.addEventListener("mouseenter",()=>{this.#o=setTimeout(()=>{this.#o=null,this.#s.classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},c)}),i.addEventListener("mouseleave",()=>{clearTimeout(this.#o),this.#o=null,this.#s?.classList.remove("show")})}i.classList.add("done"),t.innerText=this.#e?await T._l10nPromise.get("editor_alt_text_decorative_tooltip"):this.#t,t.parentNode||i.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:this.#t,decorative:this.#e}}set altTextData({altText:i,decorative:t}){this.#t===i&&this.#e===t||(this.#t=i,this.#e=t,this.#w())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#l),this.div.addEventListener("focusout",this.#c);const[i,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/i).toFixed(2)}%`,this.div.style.maxHeight=`${(100*i/t).toFixed(2)}%`);const[s,c]=this.getInitialTranslation();return this.translate(s,c),(0,r.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(i){const{isMac:t}=u.FeatureTest.platform;if(i.button!==0||i.ctrlKey&&t){i.preventDefault();return}this.#i=!0,this.#x(i)}#x(i){if(!this._isDraggable)return;const t=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let s,c;t&&(s={passive:!0,capture:!0},c=e=>{const[h,g]=this.screenToPageTranslation(e.movementX,e.movementY);this._uiManager.dragSelectedEditors(h,g)},window.addEventListener("pointermove",c,s));const l=()=>{if(window.removeEventListener("pointerup",l),window.removeEventListener("blur",l),t&&window.removeEventListener("pointermove",c,s),this.#i=!1,!this._uiManager.endDragSession()){const{isMac:e}=u.FeatureTest.platform;i.ctrlKey&&!e||i.shiftKey||i.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",l),window.addEventListener("blur",l)}moveInDOM(){this.parent?.moveEditorInDOM(this)}_setParentAndPosition(i,t,s){i.changeParent(this),this.x=t,this.y=s,this.fixAndSetPosition()}getRect(i,t){const s=this.parentScale,[c,l]=this.pageDimensions,[e,h]=this.pageTranslation,g=i/s,o=t/s,S=this.x*c,R=this.y*l,P=this.width*c,p=this.height*l;switch(this.rotation){case 0:return[S+g+e,l-R-o-p+h,S+g+P+e,l-R-o+h];case 90:return[S+o+e,l-R+g+h,S+o+p+e,l-R+g+P+h];case 180:return[S-g-P+e,l-R+o+h,S-g+e,l-R+o+p+h];case 270:return[S-o-p+e,l-R-g-P+h,S-o+e,l-R-g+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(i,t){const[s,c,l,e]=i,h=l-s,g=e-c;switch(this.rotation){case 0:return[s,t-e,h,g];case 90:return[s,t-c,g,h];case 180:return[l,t-c,h,g];case 270:return[l,t-e,g,h];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#d=!0}disableEditMode(){this.#d=!1}isInEditMode(){return this.#d}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#l),this.div?.addEventListener("focusout",this.#c)}serialize(i=!1,t=null){(0,u.unreachable)("An editor must be serializable")}static deserialize(i,t,s){const c=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:s});c.rotation=i.rotation;const[l,e]=c.pageDimensions,[h,g,o,S]=c.getRectInCurrentCoords(i.rect,e);return c.x=h/l,c.y=g/e,c.width=o/l,c.height=S/e,c}remove(){this.div.removeEventListener("focusin",this.#l),this.div.removeEventListener("focusout",this.#c),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#n?.remove(),this.#n=null,this.#s=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#_(),this.#r.classList.remove("hidden"))}select(){this.makeResizable(),this.div?.classList.add("selectedEditor")}unselect(){this.#r?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(i,t){}disableEditing(){this.#n&&(this.#n.hidden=!0)}enableEditing(){this.#n&&(this.#n.hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return this.#f}set isEditing(i){this.#f=i,this.parent&&(i?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(i,t){this.#a=!0;const s=i/t,{style:c}=this.div;c.aspectRatio=s,c.height="auto"}static get MIN_SIZE(){return 16}}n.AnnotationEditor=T;class N extends T{constructor(i){super(i),this.annotationElementId=i.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.KeyboardManager=n.CommandManager=n.ColorManager=n.AnnotationEditorUIManager=void 0,n.bindEvents=w,n.opacityToHex=T;var r=_(1),u=_(6);function w(l,e,h){for(const g of h)e.addEventListener(g,l[g].bind(l))}function T(l){return Math.round(Math.min(255,Math.max(1,255*l))).toString(16).padStart(2,"0")}class N{#t=0;getId(){return`${r.AnnotationEditorPrefix}${this.#t++}`}}class F{#t=(0,r.getUuid)();#e=0;#n=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',g=new OffscreenCanvas(1,3).getContext("2d"),o=new Image;o.src=e;const S=o.decode().then(()=>(g.drawImage(o,0,0,1,1,0,0,1,3),new Uint32Array(g.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,r.shadow)(this,"_isSVGFittingCanvas",S)}async#s(e,h){this.#n||=new Map;let g=this.#n.get(e);if(g===null)return null;if(g?.bitmap)return g.refCounter+=1,g;try{g||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let o;if(typeof h=="string"){g.url=h;const S=await fetch(h);if(!S.ok)throw new Error(S.statusText);o=await S.blob()}else o=g.file=h;if(o.type==="image/svg+xml"){const S=F._isSVGFittingCanvas,R=new FileReader,P=new Image,p=new Promise((E,j)=>{P.onload=()=>{g.bitmap=P,g.isSvg=!0,E()},R.onload=async()=>{const U=g.svgUrl=R.result;P.src=await S?`${U}#svgView(preserveAspectRatio(none))`:U},P.onerror=R.onerror=j});R.readAsDataURL(o),await p}else g.bitmap=await createImageBitmap(o);g.refCounter=1}catch(o){console.error(o),g=null}return this.#n.set(e,g),g&&this.#n.set(g.id,g),g}async getFromFile(e){const{lastModified:h,name:g,size:o,type:S}=e;return this.#s(`${h}_${g}_${o}_${S}`,e)}async getFromUrl(e){return this.#s(e,e)}async getFromId(e){this.#n||=new Map;const h=this.#n.get(e);return h?h.bitmap?(h.refCounter+=1,h):h.file?this.getFromFile(h.file):this.getFromUrl(h.url):null}getSvgUrl(e){const h=this.#n.get(e);return h?.isSvg?h.svgUrl:null}deleteId(e){this.#n||=new Map;const h=this.#n.get(e);h&&(h.refCounter-=1,h.refCounter===0&&(h.bitmap=null))}isValidId(e){return e.startsWith(`image_${this.#t}_`)}}class i{#t=[];#e=!1;#n;#s=-1;constructor(e=128){this.#n=e}add({cmd:e,undo:h,mustExec:g,type:o=NaN,overwriteIfSameType:S=!1,keepUndo:R=!1}){if(g&&e(),this.#e)return;const P={cmd:e,undo:h,type:o};if(this.#s===-1){this.#t.length>0&&(this.#t.length=0),this.#s=0,this.#t.push(P);return}if(S&&this.#t[this.#s].type===o){R&&(P.undo=this.#t[this.#s].undo),this.#t[this.#s]=P;return}const p=this.#s+1;p===this.#n?this.#t.splice(0,1):(this.#s=p,p<this.#t.length&&this.#t.splice(p)),this.#t.push(P)}undo(){this.#s!==-1&&(this.#e=!0,this.#t[this.#s].undo(),this.#e=!1,this.#s-=1)}redo(){this.#s<this.#t.length-1&&(this.#s+=1,this.#e=!0,this.#t[this.#s].cmd(),this.#e=!1)}hasSomethingToUndo(){return this.#s!==-1}hasSomethingToRedo(){return this.#s<this.#t.length-1}destroy(){this.#t=null}}n.CommandManager=i;class t{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:h}=r.FeatureTest.platform;for(const[g,o,S={}]of e)for(const R of g){const P=R.startsWith("mac+");h&&P?(this.callbacks.set(R.slice(4),{callback:o,options:S}),this.allKeys.add(R.split("+").at(-1))):!h&&!P&&(this.callbacks.set(R,{callback:o,options:S}),this.allKeys.add(R.split("+").at(-1)))}}#t(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const h=this.buffer.join("+");return this.buffer.length=0,h}exec(e,h){if(!this.allKeys.has(h.key))return;const g=this.callbacks.get(this.#t(h));if(!g)return;const{callback:o,options:{bubbles:S=!1,args:R=[],checker:P=null}}=g;P&&!P(e,h)||(o.bind(e,...R)(),S||(h.stopPropagation(),h.preventDefault()))}}n.KeyboardManager=t;class s{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return(0,u.getColorValues)(e),(0,r.shadow)(this,"_colors",e)}convert(e){const h=(0,u.getRGB)(e);if(!window.matchMedia("(forced-colors: active)").matches)return h;for(const[g,o]of this._colors)if(o.every((S,R)=>S===h[R]))return s._colorsMapping.get(g);return h}getHexCode(e){const h=this._colors.get(e);return h?r.Util.makeHexColor(...h):e}}n.ColorManager=s;class c{#t=null;#e=new Map;#n=new Map;#s=null;#o=null;#a=new i;#r=0;#l=new Set;#c=null;#i=null;#f=new Set;#d=null;#u=new N;#p=!1;#b=!1;#m=null;#g=r.AnnotationEditorType.NONE;#h=new Set;#_=null;#S=this.blur.bind(this);#E=this.focus.bind(this);#w=this.copy.bind(this);#x=this.cut.bind(this);#L=this.paste.bind(this);#O=this.keydown.bind(this);#I=this.onEditingAction.bind(this);#y=this.onPageChanging.bind(this);#D=this.onScaleChanging.bind(this);#R=this.onRotationChanging.bind(this);#k={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#A=[0,0];#C=null;#T=null;#N=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=c.prototype,h=S=>{const{activeElement:R}=document;return R&&S.#T.contains(R)&&S.hasSomethingToControl()},g=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return(0,r.shadow)(this,"_keyboardManager",new t([[["ctrl+a","mac+meta+a"],e.selectAll],[["ctrl+z","mac+meta+z"],e.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-g,0],checker:h}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-o,0],checker:h}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[g,0],checker:h}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[o,0],checker:h}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-g],checker:h}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-o],checker:h}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,g],checker:h}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,o],checker:h}]]))}constructor(e,h,g,o,S,R){this.#T=e,this.#N=h,this.#s=g,this._eventBus=o,this._eventBus._on("editingaction",this.#I),this._eventBus._on("pagechanging",this.#y),this._eventBus._on("scalechanging",this.#D),this._eventBus._on("rotationchanging",this.#R),this.#o=S.annotationStorage,this.#d=S.filterFactory,this.#_=R,this.viewParameters={realScale:u.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#F(),this.#j(),this._eventBus._off("editingaction",this.#I),this._eventBus._off("pagechanging",this.#y),this._eventBus._off("scalechanging",this.#D),this._eventBus._off("rotationchanging",this.#R);for(const e of this.#n.values())e.destroy();this.#n.clear(),this.#e.clear(),this.#f.clear(),this.#t=null,this.#h.clear(),this.#a.destroy(),this.#s.destroy()}get hcmFilter(){return(0,r.shadow)(this,"hcmFilter",this.#_?this.#d.addHCMFilter(this.#_.foreground,this.#_.background):"none")}get direction(){return(0,r.shadow)(this,"direction",getComputedStyle(this.#T).direction)}editAltText(e){this.#s?.editAltText(this,e)}onPageChanging({pageNumber:e}){this.#r=e-1}focusMainContainer(){this.#T.focus()}findParent(e,h){for(const g of this.#n.values()){const{x:o,y:S,width:R,height:P}=g.div.getBoundingClientRect();if(e>=o&&e<=o+R&&h>=S&&h<=S+P)return g}return null}disableUserSelect(e=!1){this.#N.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#f.add(e)}removeShouldRescale(e){this.#f.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*u.PixelsPerInch.PDF_TO_CSS_UNITS;for(const h of this.#f)h.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}addToAnnotationStorage(e){!e.isEmpty()&&this.#o&&!this.#o.has(e.id)&&this.#o.setValue(e.id,e)}#B(){window.addEventListener("focus",this.#E),window.addEventListener("blur",this.#S)}#j(){window.removeEventListener("focus",this.#E),window.removeEventListener("blur",this.#S)}blur(){if(!this.hasSelection)return;const{activeElement:e}=document;for(const h of this.#h)if(h.div.contains(e)){this.#m=[h,e],h._focusEventsAllowed=!1;break}}focus(){if(!this.#m)return;const[e,h]=this.#m;this.#m=null,h.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0}),h.focus()}#U(){window.addEventListener("keydown",this.#O,{capture:!0})}#F(){window.removeEventListener("keydown",this.#O,{capture:!0})}#M(){document.addEventListener("copy",this.#w),document.addEventListener("cut",this.#x),document.addEventListener("paste",this.#L)}#P(){document.removeEventListener("copy",this.#w),document.removeEventListener("cut",this.#x),document.removeEventListener("paste",this.#L)}addEditListeners(){this.#U(),this.#M()}removeEditListeners(){this.#F(),this.#P()}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const h=[];for(const g of this.#h){const o=g.serialize(!0);o&&h.push(o)}h.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(h))}cut(e){this.copy(e),this.delete()}paste(e){e.preventDefault();const{clipboardData:h}=e;for(const S of h.items)for(const R of this.#i)if(R.isHandlingMimeForPasting(S.type)){R.paste(S,this.currentLayer);return}let g=h.getData("application/pdfjs");if(!g)return;try{g=JSON.parse(g)}catch(S){(0,r.warn)(`paste: "${S.message}".`);return}if(!Array.isArray(g))return;this.unselectAll();const o=this.currentLayer;try{const S=[];for(const p of g){const E=o.deserialize(p);if(!E)return;S.push(E)}const R=()=>{for(const p of S)this.#G(p);this.#$(S)},P=()=>{for(const p of S)p.remove()};this.addCommands({cmd:R,undo:P,mustExec:!0})}catch(S){(0,r.warn)(`paste: "${S.message}".`)}}keydown(e){this.getActive()?.shouldGetKeyboardEvents()||c._keyboardManager.exec(this,e)}onEditingAction(e){["undo","redo","delete","selectAll"].includes(e.name)&&this[e.name]()}#v(e){Object.entries(e).some(([g,o])=>this.#k[g]!==o)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#k,e)})}#W(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#B(),this.#U(),this.#M(),this.#v({isEditing:this.#g!==r.AnnotationEditorType.NONE,isEmpty:this.#H(),hasSomethingToUndo:this.#a.hasSomethingToUndo(),hasSomethingToRedo:this.#a.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#j(),this.#F(),this.#P(),this.#v({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#i){this.#i=e;for(const h of this.#i)this.#W(h.defaultPropertiesToUpdate)}}getId(){return this.#u.getId()}get currentLayer(){return this.#n.get(this.#r)}getLayer(e){return this.#n.get(e)}get currentPageIndex(){return this.#r}addLayer(e){this.#n.set(e.pageIndex,e),this.#p?e.enable():e.disable()}removeLayer(e){this.#n.delete(e.pageIndex)}updateMode(e,h=null){if(this.#g!==e){if(this.#g=e,e===r.AnnotationEditorType.NONE){this.setEditingState(!1),this.#q();return}this.setEditingState(!0),this.#V(),this.unselectAll();for(const g of this.#n.values())g.updateMode(e);if(h){for(const g of this.#e.values())if(g.annotationElementId===h){this.setSelected(g),g.enterInEditMode();break}}}}updateToolbar(e){e!==this.#g&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,h){if(this.#i){if(e===r.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(e);return}for(const g of this.#h)g.updateParams(e,h);for(const g of this.#i)g.updateDefaultParams(e,h)}}enableWaiting(e=!1){if(this.#b!==e){this.#b=e;for(const h of this.#n.values())e?h.disableClick():h.enableClick(),h.div.classList.toggle("waiting",e)}}#V(){if(!this.#p){this.#p=!0;for(const e of this.#n.values())e.enable()}}#q(){if(this.unselectAll(),this.#p){this.#p=!1;for(const e of this.#n.values())e.disable()}}getEditors(e){const h=[];for(const g of this.#e.values())g.pageIndex===e&&h.push(g);return h}getEditor(e){return this.#e.get(e)}addEditor(e){this.#e.set(e.id,e)}removeEditor(e){this.#e.delete(e.id),this.unselect(e),(!e.annotationElementId||!this.#l.has(e.annotationElementId))&&this.#o?.remove(e.id)}addDeletedAnnotationElement(e){this.#l.add(e.annotationElementId),e.deleted=!0}isDeletedAnnotationElement(e){return this.#l.has(e)}removeDeletedAnnotationElement(e){this.#l.delete(e.annotationElementId),e.deleted=!1}#G(e){const h=this.#n.get(e.pageIndex);h?h.addOrRebuild(e):this.addEditor(e)}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#W(e.propertiesToUpdate))}toggleSelected(e){if(this.#h.has(e)){this.#h.delete(e),e.unselect(),this.#v({hasSelectedEditor:this.hasSelection});return}this.#h.add(e),e.select(),this.#W(e.propertiesToUpdate),this.#v({hasSelectedEditor:!0})}setSelected(e){for(const h of this.#h)h!==e&&h.unselect();this.#h.clear(),this.#h.add(e),e.select(),this.#W(e.propertiesToUpdate),this.#v({hasSelectedEditor:!0})}isSelected(e){return this.#h.has(e)}unselect(e){e.unselect(),this.#h.delete(e),this.#v({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#h.size!==0}undo(){this.#a.undo(),this.#v({hasSomethingToUndo:this.#a.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#H()})}redo(){this.#a.redo(),this.#v({hasSomethingToUndo:!0,hasSomethingToRedo:this.#a.hasSomethingToRedo(),isEmpty:this.#H()})}addCommands(e){this.#a.add(e),this.#v({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#H()})}#H(){if(this.#e.size===0)return!0;if(this.#e.size===1)for(const e of this.#e.values())return e.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const e=[...this.#h],h=()=>{for(const o of e)o.remove()},g=()=>{for(const o of e)this.#G(o)};this.addCommands({cmd:h,undo:g,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#$(e){this.#h.clear();for(const h of e)h.isEmpty()||(this.#h.add(h),h.select());this.#v({hasSelectedEditor:!0})}selectAll(){for(const e of this.#h)e.commit();this.#$(this.#e.values())}unselectAll(){if(this.#t){this.#t.commitOrRemove();return}if(this.hasSelection){for(const e of this.#h)e.unselect();this.#h.clear(),this.#v({hasSelectedEditor:!1})}}translateSelectedEditors(e,h,g=!1){if(g||this.commitOrRemove(),!this.hasSelection)return;this.#A[0]+=e,this.#A[1]+=h;const[o,S]=this.#A,R=[...this.#h],P=1e3;this.#C&&clearTimeout(this.#C),this.#C=setTimeout(()=>{this.#C=null,this.#A[0]=this.#A[1]=0,this.addCommands({cmd:()=>{for(const p of R)this.#e.has(p.id)&&p.translateInPage(o,S)},undo:()=>{for(const p of R)this.#e.has(p.id)&&p.translateInPage(-o,-S)},mustExec:!1})},P);for(const p of R)p.translateInPage(e,h)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#c=new Map;for(const e of this.#h)this.#c.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#c)return!1;this.disableUserSelect(!1);const e=this.#c;this.#c=null;let h=!1;for(const[{x:o,y:S,pageIndex:R},P]of e)P.newX=o,P.newY=S,P.newPageIndex=R,h||=o!==P.savedX||S!==P.savedY||R!==P.savedPageIndex;if(!h)return!1;const g=(o,S,R,P)=>{if(this.#e.has(o.id)){const p=this.#n.get(P);p?o._setParentAndPosition(p,S,R):(o.pageIndex=P,o.x=S,o.y=R)}};return this.addCommands({cmd:()=>{for(const[o,{newX:S,newY:R,newPageIndex:P}]of e)g(o,S,R,P)},undo:()=>{for(const[o,{savedX:S,savedY:R,savedPageIndex:P}]of e)g(o,S,R,P)},mustExec:!0}),!0}dragSelectedEditors(e,h){if(this.#c)for(const g of this.#c.keys())g.drag(e,h)}rebuild(e){if(e.parent===null){const h=this.getLayer(e.pageIndex);h?(h.changeParent(e),h.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#g}get imageManager(){return(0,r.shadow)(this,"imageManager",new F)}}n.AnnotationEditorUIManager=c},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.StatTimer=n.RenderingCancelledException=n.PixelsPerInch=n.PageViewport=n.PDFDateString=n.DOMStandardFontDataFactory=n.DOMSVGFactory=n.DOMFilterFactory=n.DOMCanvasFactory=n.DOMCMapReaderFactory=void 0,n.deprecated=j,n.getColorValues=nt,n.getCurrentTransform=Q,n.getCurrentTransformInverse=Z,n.getFilenameFromUrl=o,n.getPdfFilenameFromUrl=S,n.getRGB=H,n.getXfaPageViewport=G,n.isDataScheme=h,n.isPdfFile=g,n.isValidFetchUrl=P,n.loadScript=E,n.noContextMenu=p,n.setLayerDimensions=it;var r=_(7),u=_(1);const w="http://www.w3.org/2000/svg";class T{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}n.PixelsPerInch=T;class N extends r.BaseFilterFactory{#t;#e;#n;#s;#o;#a;#r;#l;#c;#i;#f=0;constructor({docId:L,ownerDocument:b=globalThis.document}={}){super(),this.#n=L,this.#s=b}get#d(){return this.#t||=new Map}get#u(){if(!this.#e){const L=this.#s.createElement("div"),{style:b}=L;b.visibility="hidden",b.contain="strict",b.width=b.height=0,b.position="absolute",b.top=b.left=0,b.zIndex=-1;const d=this.#s.createElementNS(w,"svg");d.setAttribute("width",0),d.setAttribute("height",0),this.#e=this.#s.createElementNS(w,"defs"),L.append(d),d.append(this.#e),this.#s.body.append(L)}return this.#e}addFilter(L){if(!L)return"none";let b=this.#d.get(L);if(b)return b;let d,f,y,M;if(L.length===1){const a=L[0],m=new Array(256);for(let v=0;v<256;v++)m[v]=a[v]/255;M=d=f=y=m.join(",")}else{const[a,m,v]=L,x=new Array(256),k=new Array(256),O=new Array(256);for(let W=0;W<256;W++)x[W]=a[W]/255,k[W]=m[W]/255,O[W]=v[W]/255;d=x.join(","),f=k.join(","),y=O.join(","),M=`${d}${f}${y}`}if(b=this.#d.get(M),b)return this.#d.set(L,b),b;const D=`g_${this.#n}_transfer_map_${this.#f++}`,B=`url(#${D})`;this.#d.set(L,B),this.#d.set(M,B);const C=this.#b(D);return this.#g(d,f,y,C),B}addHCMFilter(L,b){const d=`${L}-${b}`;if(this.#a===d)return this.#r;if(this.#a=d,this.#r="none",this.#o?.remove(),!L||!b)return this.#r;const f=this.#h(L);L=u.Util.makeHexColor(...f);const y=this.#h(b);if(b=u.Util.makeHexColor(...y),this.#u.style.color="",L==="#000000"&&b==="#ffffff"||L===b)return this.#r;const M=new Array(256);for(let m=0;m<=255;m++){const v=m/255;M[m]=v<=.03928?v/12.92:((v+.055)/1.055)**2.4}const D=M.join(","),B=`g_${this.#n}_hcm_filter`,C=this.#l=this.#b(B);this.#g(D,D,D,C),this.#p(C);const a=(m,v)=>{const x=f[m]/255,k=y[m]/255,O=new Array(v+1);for(let W=0;W<=v;W++)O[W]=x+W/v*(k-x);return O.join(",")};return this.#g(a(0,5),a(1,5),a(2,5),C),this.#r=`url(#${B})`,this.#r}addHighlightHCMFilter(L,b,d,f){const y=`${L}-${b}-${d}-${f}`;if(this.#c===y)return this.#i;if(this.#c=y,this.#i="none",this.#l?.remove(),!L||!b)return this.#i;const[M,D]=[L,b].map(this.#h.bind(this));let B=Math.round(.2126*M[0]+.7152*M[1]+.0722*M[2]),C=Math.round(.2126*D[0]+.7152*D[1]+.0722*D[2]),[a,m]=[d,f].map(this.#h.bind(this));C<B&&([B,C,a,m]=[C,B,m,a]),this.#u.style.color="";const v=(O,W,z)=>{const st=new Array(256),q=(C-B)/z,X=O/255,Y=(W-O)/(255*z);let J=0;for(let tt=0;tt<=z;tt++){const rt=Math.round(B+tt*q),ot=X+tt*Y;for(let lt=J;lt<=rt;lt++)st[lt]=ot;J=rt+1}for(let tt=J;tt<256;tt++)st[tt]=st[J-1];return st.join(",")},x=`g_${this.#n}_hcm_highlight_filter`,k=this.#l=this.#b(x);return this.#p(k),this.#g(v(a[0],m[0],5),v(a[1],m[1],5),v(a[2],m[2],5),k),this.#i=`url(#${x})`,this.#i}destroy(L=!1){L&&(this.#r||this.#i)||(this.#e&&(this.#e.parentNode.parentNode.remove(),this.#e=null),this.#t&&(this.#t.clear(),this.#t=null),this.#f=0)}#p(L){const b=this.#s.createElementNS(w,"feColorMatrix");b.setAttribute("type","matrix"),b.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),L.append(b)}#b(L){const b=this.#s.createElementNS(w,"filter");return b.setAttribute("color-interpolation-filters","sRGB"),b.setAttribute("id",L),this.#u.append(b),b}#m(L,b,d){const f=this.#s.createElementNS(w,b);f.setAttribute("type","discrete"),f.setAttribute("tableValues",d),L.append(f)}#g(L,b,d,f){const y=this.#s.createElementNS(w,"feComponentTransfer");f.append(y),this.#m(y,"feFuncR",L),this.#m(y,"feFuncG",b),this.#m(y,"feFuncB",d)}#h(L){return this.#u.style.color=L,H(getComputedStyle(this.#u).getPropertyValue("color"))}}n.DOMFilterFactory=N;class F extends r.BaseCanvasFactory{constructor({ownerDocument:L=globalThis.document}={}){super(),this._document=L}_createCanvas(L,b){const d=this._document.createElement("canvas");return d.width=L,d.height=b,d}}n.DOMCanvasFactory=F;async function i(K,L=!1){if(P(K,document.baseURI)){const b=await fetch(K);if(!b.ok)throw new Error(b.statusText);return L?new Uint8Array(await b.arrayBuffer()):(0,u.stringToBytes)(await b.text())}return new Promise((b,d)=>{const f=new XMLHttpRequest;f.open("GET",K,!0),L&&(f.responseType="arraybuffer"),f.onreadystatechange=()=>{if(f.readyState===XMLHttpRequest.DONE){if(f.status===200||f.status===0){let y;if(L&&f.response?y=new Uint8Array(f.response):!L&&f.responseText&&(y=(0,u.stringToBytes)(f.responseText)),y){b(y);return}}d(new Error(f.statusText))}},f.send(null)})}class t extends r.BaseCMapReaderFactory{_fetchData(L,b){return i(L,this.isCompressed).then(d=>({cMapData:d,compressionType:b}))}}n.DOMCMapReaderFactory=t;class s extends r.BaseStandardFontDataFactory{_fetchData(L){return i(L,!0)}}n.DOMStandardFontDataFactory=s;class c extends r.BaseSVGFactory{_createSVG(L){return document.createElementNS(w,L)}}n.DOMSVGFactory=c;class l{constructor({viewBox:L,scale:b,rotation:d,offsetX:f=0,offsetY:y=0,dontFlip:M=!1}){this.viewBox=L,this.scale=b,this.rotation=d,this.offsetX=f,this.offsetY=y;const D=(L[2]+L[0])/2,B=(L[3]+L[1])/2;let C,a,m,v;switch(d%=360,d<0&&(d+=360),d){case 180:C=-1,a=0,m=0,v=1;break;case 90:C=0,a=1,m=1,v=0;break;case 270:C=0,a=-1,m=-1,v=0;break;case 0:C=1,a=0,m=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}M&&(m=-m,v=-v);let x,k,O,W;C===0?(x=Math.abs(B-L[1])*b+f,k=Math.abs(D-L[0])*b+y,O=(L[3]-L[1])*b,W=(L[2]-L[0])*b):(x=Math.abs(D-L[0])*b+f,k=Math.abs(B-L[1])*b+y,O=(L[2]-L[0])*b,W=(L[3]-L[1])*b),this.transform=[C*b,a*b,m*b,v*b,x-C*b*D-m*b*B,k-a*b*D-v*b*B],this.width=O,this.height=W}get rawDims(){const{viewBox:L}=this;return(0,u.shadow)(this,"rawDims",{pageWidth:L[2]-L[0],pageHeight:L[3]-L[1],pageX:L[0],pageY:L[1]})}clone({scale:L=this.scale,rotation:b=this.rotation,offsetX:d=this.offsetX,offsetY:f=this.offsetY,dontFlip:y=!1}={}){return new l({viewBox:this.viewBox.slice(),scale:L,rotation:b,offsetX:d,offsetY:f,dontFlip:y})}convertToViewportPoint(L,b){return u.Util.applyTransform([L,b],this.transform)}convertToViewportRectangle(L){const b=u.Util.applyTransform([L[0],L[1]],this.transform),d=u.Util.applyTransform([L[2],L[3]],this.transform);return[b[0],b[1],d[0],d[1]]}convertToPdfPoint(L,b){return u.Util.applyInverseTransform([L,b],this.transform)}}n.PageViewport=l;class e extends u.BaseException{constructor(L,b=0){super(L,"RenderingCancelledException"),this.extraDelay=b}}n.RenderingCancelledException=e;function h(K){const L=K.length;let b=0;for(;b<L&&K[b].trim()==="";)b++;return K.substring(b,b+5).toLowerCase()==="data:"}function g(K){return typeof K=="string"&&/\.pdf$/i.test(K)}function o(K,L=!1){return L||([K]=K.split(/[#?]/,1)),K.substring(K.lastIndexOf("/")+1)}function S(K,L="document.pdf"){if(typeof K!="string")return L;if(h(K))return(0,u.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),L;const b=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,d=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,f=b.exec(K);let y=d.exec(f[1])||d.exec(f[2])||d.exec(f[3]);if(y&&(y=y[0],y.includes("%")))try{y=d.exec(decodeURIComponent(y))[0]}catch{}return y||L}class R{started=Object.create(null);times=[];time(L){L in this.started&&(0,u.warn)(`Timer is already running for ${L}`),this.started[L]=Date.now()}timeEnd(L){L in this.started||(0,u.warn)(`Timer has not been started for ${L}`),this.times.push({name:L,start:this.started[L],end:Date.now()}),delete this.started[L]}toString(){const L=[];let b=0;for(const{name:d}of this.times)b=Math.max(d.length,b);for(const{name:d,start:f,end:y}of this.times)L.push(`${d.padEnd(b)} ${y-f}ms
`);return L.join("")}}n.StatTimer=R;function P(K,L){try{const{protocol:b}=L?new URL(K,L):new URL(K);return b==="http:"||b==="https:"}catch{return!1}}function p(K){K.preventDefault()}function E(K,L=!1){return new Promise((b,d)=>{const f=document.createElement("script");f.src=K,f.onload=function(y){L&&f.remove(),b(y)},f.onerror=function(){d(new Error(`Cannot load script at: ${f.src}`))},(document.head||document.documentElement).append(f)})}function j(K){console.log("Deprecated API usage: "+K)}let U;class I{static toDateObject(L){if(!L||typeof L!="string")return null;U||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const b=U.exec(L);if(!b)return null;const d=parseInt(b[1],10);let f=parseInt(b[2],10);f=f>=1&&f<=12?f-1:0;let y=parseInt(b[3],10);y=y>=1&&y<=31?y:1;let M=parseInt(b[4],10);M=M>=0&&M<=23?M:0;let D=parseInt(b[5],10);D=D>=0&&D<=59?D:0;let B=parseInt(b[6],10);B=B>=0&&B<=59?B:0;const C=b[7]||"Z";let a=parseInt(b[8],10);a=a>=0&&a<=23?a:0;let m=parseInt(b[9],10)||0;return m=m>=0&&m<=59?m:0,C==="-"?(M+=a,D+=m):C==="+"&&(M-=a,D-=m),new Date(Date.UTC(d,f,y,M,D,B))}}n.PDFDateString=I;function G(K,{scale:L=1,rotation:b=0}){const{width:d,height:f}=K.attributes.style,y=[0,0,parseInt(d),parseInt(f)];return new l({viewBox:y,scale:L,rotation:b})}function H(K){if(K.startsWith("#")){const L=parseInt(K.slice(1),16);return[(L&16711680)>>16,(L&65280)>>8,L&255]}return K.startsWith("rgb(")?K.slice(4,-1).split(",").map(L=>parseInt(L)):K.startsWith("rgba(")?K.slice(5,-1).split(",").map(L=>parseInt(L)).slice(0,3):((0,u.warn)(`Not a valid color format: "${K}"`),[0,0,0])}function nt(K){const L=document.createElement("span");L.style.visibility="hidden",document.body.append(L);for(const b of K.keys()){L.style.color=b;const d=window.getComputedStyle(L).color;K.set(b,H(d))}L.remove()}function Q(K){const{a:L,b,c:d,d:f,e:y,f:M}=K.getTransform();return[L,b,d,f,y,M]}function Z(K){const{a:L,b,c:d,d:f,e:y,f:M}=K.getTransform().invertSelf();return[L,b,d,f,y,M]}function it(K,L,b=!1,d=!0){if(L instanceof l){const{pageWidth:f,pageHeight:y}=L.rawDims,{style:M}=K,D=u.FeatureTest.isCSSRoundSupported,B=`var(--scale-factor) * ${f}px`,C=`var(--scale-factor) * ${y}px`,a=D?`round(${B}, 1px)`:`calc(${B})`,m=D?`round(${C}, 1px)`:`calc(${C})`;!b||L.rotation%180===0?(M.width=a,M.height=m):(M.width=m,M.height=a)}d&&K.setAttribute("data-main-rotation",L.rotation)}},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BaseStandardFontDataFactory=n.BaseSVGFactory=n.BaseFilterFactory=n.BaseCanvasFactory=n.BaseCMapReaderFactory=void 0;var r=_(1);class u{constructor(){this.constructor===u&&(0,r.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(t){return"none"}addHCMFilter(t,s){return"none"}addHighlightHCMFilter(t,s,c,l){return"none"}destroy(t=!1){}}n.BaseFilterFactory=u;class w{constructor(){this.constructor===w&&(0,r.unreachable)("Cannot initialize BaseCanvasFactory.")}create(t,s){if(t<=0||s<=0)throw new Error("Invalid canvas size");const c=this._createCanvas(t,s);return{canvas:c,context:c.getContext("2d")}}reset(t,s,c){if(!t.canvas)throw new Error("Canvas is not specified");if(s<=0||c<=0)throw new Error("Invalid canvas size");t.canvas.width=s,t.canvas.height=c}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,s){(0,r.unreachable)("Abstract method `_createCanvas` called.")}}n.BaseCanvasFactory=w;class T{constructor({baseUrl:t=null,isCompressed:s=!0}){this.constructor===T&&(0,r.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=t,this.isCompressed=s}async fetch({name:t}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!t)throw new Error("CMap name must be specified.");const s=this.baseUrl+t+(this.isCompressed?".bcmap":""),c=this.isCompressed?r.CMapCompressionType.BINARY:r.CMapCompressionType.NONE;return this._fetchData(s,c).catch(l=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${s}`)})}_fetchData(t,s){(0,r.unreachable)("Abstract method `_fetchData` called.")}}n.BaseCMapReaderFactory=T;class N{constructor({baseUrl:t=null}){this.constructor===N&&(0,r.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!t)throw new Error("Font filename must be specified.");const s=`${this.baseUrl}${t}`;return this._fetchData(s).catch(c=>{throw new Error(`Unable to load font data at: ${s}`)})}_fetchData(t){(0,r.unreachable)("Abstract method `_fetchData` called.")}}n.BaseStandardFontDataFactory=N;class F{constructor(){this.constructor===F&&(0,r.unreachable)("Cannot initialize BaseSVGFactory.")}create(t,s,c=!1){if(t<=0||s<=0)throw new Error("Invalid SVG dimensions");const l=this._createSVG("svg:svg");return l.setAttribute("version","1.1"),c||(l.setAttribute("width",`${t}px`),l.setAttribute("height",`${s}px`)),l.setAttribute("preserveAspectRatio","none"),l.setAttribute("viewBox",`0 0 ${t} ${s}`),l}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){(0,r.unreachable)("Abstract method `_createSVG` called.")}}n.BaseSVGFactory=F},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MurmurHash3_64=void 0;var r=_(1);const u=3285377520,w=4294901760,T=65535;class N{constructor(i){this.h1=i?i&4294967295:u,this.h2=i?i&4294967295:u}update(i){let t,s;if(typeof i=="string"){t=new Uint8Array(i.length*2),s=0;for(let j=0,U=i.length;j<U;j++){const I=i.charCodeAt(j);I<=255?t[s++]=I:(t[s++]=I>>>8,t[s++]=I&255)}}else if((0,r.isArrayBuffer)(i))t=i.slice(),s=t.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const c=s>>2,l=s-c*4,e=new Uint32Array(t.buffer,0,c);let h=0,g=0,o=this.h1,S=this.h2;const R=3432918353,P=461845907,p=R&T,E=P&T;for(let j=0;j<c;j++)j&1?(h=e[j],h=h*R&w|h*p&T,h=h<<15|h>>>17,h=h*P&w|h*E&T,o^=h,o=o<<13|o>>>19,o=o*5+3864292196):(g=e[j],g=g*R&w|g*p&T,g=g<<15|g>>>17,g=g*P&w|g*E&T,S^=g,S=S<<13|S>>>19,S=S*5+3864292196);switch(h=0,l){case 3:h^=t[c*4+2]<<16;case 2:h^=t[c*4+1]<<8;case 1:h^=t[c*4],h=h*R&w|h*p&T,h=h<<15|h>>>17,h=h*P&w|h*E&T,c&1?o^=h:S^=h}this.h1=o,this.h2=S}hexdigest(){let i=this.h1,t=this.h2;return i^=t>>>1,i=i*3981806797&w|i*36045&T,t=t*4283543511&w|((t<<16|i>>>16)*2950163797&w)>>>16,i^=t>>>1,i=i*444984403&w|i*60499&T,t=t*3301882366&w|((t<<16|i>>>16)*3120437893&w)>>>16,i^=t>>>1,(i>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}n.MurmurHash3_64=N},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FontLoader=n.FontFaceObject=void 0;var r=_(1);class u{#t=new Set;constructor({ownerDocument:N=globalThis.document,styleElement:F=null}){this._document=N,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(N){this.nativeFontFaces.add(N),this._document.fonts.add(N)}removeNativeFontFace(N){this.nativeFontFaces.delete(N),this._document.fonts.delete(N)}insertRule(N){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const F=this.styleElement.sheet;F.insertRule(N,F.cssRules.length)}clear(){for(const N of this.nativeFontFaces)this._document.fonts.delete(N);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(N){if(!(!N||this.#t.has(N.loadedName))){if((0,r.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:F,src:i,style:t}=N,s=new FontFace(F,i,t);this.addNativeFontFace(s);try{await s.load(),this.#t.add(F)}catch{(0,r.warn)(`Cannot load system font: ${N.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(s)}return}(0,r.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(N){if(N.attached||N.missingFile&&!N.systemFontInfo)return;if(N.attached=!0,N.systemFontInfo){await this.loadSystemFont(N.systemFontInfo);return}if(this.isFontLoadingAPISupported){const i=N.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(t){throw(0,r.warn)(`Failed to load font '${i.family}': '${t}'.`),N.disableFontFace=!0,t}}return}const F=N.createFontFaceRule();if(F){if(this.insertRule(F),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const t=this._queueLoadingCallback(i);this._prepareFontLoadEvent(N,t)})}}get isFontLoadingAPISupported(){const N=!!this._document?.fonts;return(0,r.shadow)(this,"isFontLoadingAPISupported",N)}get isSyncFontLoadingSupported(){let N=!1;return(r.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(N=!0),(0,r.shadow)(this,"isSyncFontLoadingSupported",N)}_queueLoadingCallback(N){function F(){for((0,r.assert)(!t.done,"completeRequest() cannot be called twice."),t.done=!0;i.length>0&&i[0].done;){const s=i.shift();setTimeout(s.callback,0)}}const{loadingRequests:i}=this,t={done:!1,complete:F,callback:N};return i.push(t),t}get _loadTestFont(){const N=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,r.shadow)(this,"_loadTestFont",N)}_prepareFontLoadEvent(N,F){function i(G,H){return G.charCodeAt(H)<<24|G.charCodeAt(H+1)<<16|G.charCodeAt(H+2)<<8|G.charCodeAt(H+3)&255}function t(G,H,nt,Q){const Z=G.substring(0,H),it=G.substring(H+nt);return Z+Q+it}let s,c;const l=this._document.createElement("canvas");l.width=1,l.height=1;const e=l.getContext("2d");let h=0;function g(G,H){if(++h>30){(0,r.warn)("Load test font never loaded."),H();return}if(e.font="30px "+G,e.fillText(".",0,20),e.getImageData(0,0,1,1).data[3]>0){H();return}setTimeout(g.bind(null,G,H))}const o=`lt${Date.now()}${this.loadTestFontId++}`;let S=this._loadTestFont;S=t(S,976,o.length,o);const P=16,p=1482184792;let E=i(S,P);for(s=0,c=o.length-3;s<c;s+=4)E=E-p+i(o,s)|0;s<o.length&&(E=E-p+i(o+"XXX",s)|0),S=t(S,P,4,(0,r.string32)(E));const j=`url(data:font/opentype;base64,${btoa(S)});`,U=`@font-face {font-family:"${o}";src:${j}}`;this.insertRule(U);const I=this._document.createElement("div");I.style.visibility="hidden",I.style.width=I.style.height="10px",I.style.position="absolute",I.style.top=I.style.left="0px";for(const G of[N.loadedName,o]){const H=this._document.createElement("span");H.textContent="Hi",H.style.fontFamily=G,I.append(H)}this._document.body.append(I),g(o,()=>{I.remove(),F.complete()})}}n.FontLoader=u;class w{constructor(N,{isEvalSupported:F=!0,disableFontFace:i=!1,ignoreErrors:t=!1,inspectFont:s=null}){this.compiledGlyphs=Object.create(null);for(const c in N)this[c]=N[c];this.isEvalSupported=F!==!1,this.disableFontFace=i===!0,this.ignoreErrors=t===!0,this._inspectFont=s}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let N;if(!this.cssFontInfo)N=new FontFace(this.loadedName,this.data,{});else{const F={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(F.style=`oblique ${this.cssFontInfo.italicAngle}deg`),N=new FontFace(this.cssFontInfo.fontFamily,this.data,F)}return this._inspectFont?.(this),N}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const N=(0,r.bytesToString)(this.data),F=`url(data:${this.mimetype};base64,${btoa(N)});`;let i;if(!this.cssFontInfo)i=`@font-face {font-family:"${this.loadedName}";src:${F}}`;else{let t=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(t+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),i=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${t}src:${F}}`}return this._inspectFont?.(this,F),i}getPathGenerator(N,F){if(this.compiledGlyphs[F]!==void 0)return this.compiledGlyphs[F];let i;try{i=N.get(this.loadedName+"_path_"+F)}catch(t){if(!this.ignoreErrors)throw t;return(0,r.warn)(`getPathGenerator - ignoring character: "${t}".`),this.compiledGlyphs[F]=function(s,c){}}if(this.isEvalSupported&&r.FeatureTest.isEvalSupported){const t=[];for(const s of i){const c=s.args!==void 0?s.args.join(","):"";t.push("c.",s.cmd,"(",c,`);
`)}return this.compiledGlyphs[F]=new Function("c","size",t.join(""))}return this.compiledGlyphs[F]=function(t,s){for(const c of i)c.cmd==="scale"&&(c.args=[s,-s]),t[c.cmd].apply(t,c.args)}}}n.FontFaceObject=w},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.NodeStandardFontDataFactory=n.NodeFilterFactory=n.NodeCanvasFactory=n.NodeCMapReaderFactory=void 0;var r=_(7);_(1);const u=function(i){return new Promise((t,s)=>{require$$5.readFile(i,(l,e)=>{if(l||!e){s(new Error(l));return}t(new Uint8Array(e))})})};class w extends r.BaseFilterFactory{}n.NodeFilterFactory=w;class T extends r.BaseCanvasFactory{_createCanvas(t,s){return require$$5.createCanvas(t,s)}}n.NodeCanvasFactory=T;class N extends r.BaseCMapReaderFactory{_fetchData(t,s){return u(t).then(c=>({cMapData:c,compressionType:s}))}}n.NodeCMapReaderFactory=N;class F extends r.BaseStandardFontDataFactory{_fetchData(t){return u(t)}}n.NodeStandardFontDataFactory=F},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CanvasGraphics=void 0;var r=_(1),u=_(6),w=_(12),T=_(13);const N=16,F=100,i=4096,t=15,s=10,c=1e3,l=16;function e(b,d){if(b._removeMirroring)throw new Error("Context is already forwarding operations.");b.__originalSave=b.save,b.__originalRestore=b.restore,b.__originalRotate=b.rotate,b.__originalScale=b.scale,b.__originalTranslate=b.translate,b.__originalTransform=b.transform,b.__originalSetTransform=b.setTransform,b.__originalResetTransform=b.resetTransform,b.__originalClip=b.clip,b.__originalMoveTo=b.moveTo,b.__originalLineTo=b.lineTo,b.__originalBezierCurveTo=b.bezierCurveTo,b.__originalRect=b.rect,b.__originalClosePath=b.closePath,b.__originalBeginPath=b.beginPath,b._removeMirroring=()=>{b.save=b.__originalSave,b.restore=b.__originalRestore,b.rotate=b.__originalRotate,b.scale=b.__originalScale,b.translate=b.__originalTranslate,b.transform=b.__originalTransform,b.setTransform=b.__originalSetTransform,b.resetTransform=b.__originalResetTransform,b.clip=b.__originalClip,b.moveTo=b.__originalMoveTo,b.lineTo=b.__originalLineTo,b.bezierCurveTo=b.__originalBezierCurveTo,b.rect=b.__originalRect,b.closePath=b.__originalClosePath,b.beginPath=b.__originalBeginPath,delete b._removeMirroring},b.save=function(){d.save(),this.__originalSave()},b.restore=function(){d.restore(),this.__originalRestore()},b.translate=function(y,M){d.translate(y,M),this.__originalTranslate(y,M)},b.scale=function(y,M){d.scale(y,M),this.__originalScale(y,M)},b.transform=function(y,M,D,B,C,a){d.transform(y,M,D,B,C,a),this.__originalTransform(y,M,D,B,C,a)},b.setTransform=function(y,M,D,B,C,a){d.setTransform(y,M,D,B,C,a),this.__originalSetTransform(y,M,D,B,C,a)},b.resetTransform=function(){d.resetTransform(),this.__originalResetTransform()},b.rotate=function(y){d.rotate(y),this.__originalRotate(y)},b.clip=function(y){d.clip(y),this.__originalClip(y)},b.moveTo=function(f,y){d.moveTo(f,y),this.__originalMoveTo(f,y)},b.lineTo=function(f,y){d.lineTo(f,y),this.__originalLineTo(f,y)},b.bezierCurveTo=function(f,y,M,D,B,C){d.bezierCurveTo(f,y,M,D,B,C),this.__originalBezierCurveTo(f,y,M,D,B,C)},b.rect=function(f,y,M,D){d.rect(f,y,M,D),this.__originalRect(f,y,M,D)},b.closePath=function(){d.closePath(),this.__originalClosePath()},b.beginPath=function(){d.beginPath(),this.__originalBeginPath()}}class h{constructor(d){this.canvasFactory=d,this.cache=Object.create(null)}getCanvas(d,f,y){let M;return this.cache[d]!==void 0?(M=this.cache[d],this.canvasFactory.reset(M,f,y)):(M=this.canvasFactory.create(f,y),this.cache[d]=M),M}delete(d){delete this.cache[d]}clear(){for(const d in this.cache){const f=this.cache[d];this.canvasFactory.destroy(f),delete this.cache[d]}}}function g(b,d,f,y,M,D,B,C,a,m){const[v,x,k,O,W,z]=(0,u.getCurrentTransform)(b);if(x===0&&k===0){const X=B*v+W,Y=Math.round(X),J=C*O+z,tt=Math.round(J),rt=(B+a)*v+W,ot=Math.abs(Math.round(rt)-Y)||1,lt=(C+m)*O+z,ct=Math.abs(Math.round(lt)-tt)||1;return b.setTransform(Math.sign(v),0,0,Math.sign(O),Y,tt),b.drawImage(d,f,y,M,D,0,0,ot,ct),b.setTransform(v,x,k,O,W,z),[ot,ct]}if(v===0&&O===0){const X=C*k+W,Y=Math.round(X),J=B*x+z,tt=Math.round(J),rt=(C+m)*k+W,ot=Math.abs(Math.round(rt)-Y)||1,lt=(B+a)*x+z,ct=Math.abs(Math.round(lt)-tt)||1;return b.setTransform(0,Math.sign(x),Math.sign(k),0,Y,tt),b.drawImage(d,f,y,M,D,0,0,ct,ot),b.setTransform(v,x,k,O,W,z),[ct,ot]}b.drawImage(d,f,y,M,D,B,C,a,m);const st=Math.hypot(v,x),q=Math.hypot(k,O);return[st*a,q*m]}function o(b){const{width:d,height:f}=b;if(d>c||f>c)return null;const y=1e3,M=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),D=d+1;let B=new Uint8Array(D*(f+1)),C,a,m;const v=d+7&-8;let x=new Uint8Array(v*f),k=0;for(const q of b.data){let X=128;for(;X>0;)x[k++]=q&X?0:255,X>>=1}let O=0;for(k=0,x[k]!==0&&(B[0]=1,++O),a=1;a<d;a++)x[k]!==x[k+1]&&(B[a]=x[k]?2:1,++O),k++;for(x[k]!==0&&(B[a]=2,++O),C=1;C<f;C++){k=C*v,m=C*D,x[k-v]!==x[k]&&(B[m]=x[k]?1:8,++O);let q=(x[k]?4:0)+(x[k-v]?8:0);for(a=1;a<d;a++)q=(q>>2)+(x[k+1]?4:0)+(x[k-v+1]?8:0),M[q]&&(B[m+a]=M[q],++O),k++;if(x[k-v]!==x[k]&&(B[m+a]=x[k]?2:4,++O),O>y)return null}for(k=v*(f-1),m=C*D,x[k]!==0&&(B[m]=8,++O),a=1;a<d;a++)x[k]!==x[k+1]&&(B[m+a]=x[k]?4:8,++O),k++;if(x[k]!==0&&(B[m+a]=4,++O),O>y)return null;const W=new Int32Array([0,D,-1,0,-D,0,0,0,1]),z=new Path2D;for(C=0;O&&C<=f;C++){let q=C*D;const X=q+d;for(;q<X&&!B[q];)q++;if(q===X)continue;z.moveTo(q%D,C);const Y=q;let J=B[q];do{const tt=W[J];do q+=tt;while(!B[q]);const rt=B[q];rt!==5&&rt!==10?(J=rt,B[q]=0):(J=rt&51*J>>4,B[q]&=J>>2|J<<2),z.lineTo(q%D,q/D|0),B[q]||--O}while(Y!==q);--C}return x=null,B=null,function(q){q.save(),q.scale(1/d,-1/f),q.translate(0,-f),q.fill(z),q.beginPath(),q.restore()}}class S{constructor(d,f){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=r.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=r.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=r.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,d,f])}clone(){const d=Object.create(this);return d.clipBox=this.clipBox.slice(),d}setCurrentPoint(d,f){this.x=d,this.y=f}updatePathMinMax(d,f,y){[f,y]=r.Util.applyTransform([f,y],d),this.minX=Math.min(this.minX,f),this.minY=Math.min(this.minY,y),this.maxX=Math.max(this.maxX,f),this.maxY=Math.max(this.maxY,y)}updateRectMinMax(d,f){const y=r.Util.applyTransform(f,d),M=r.Util.applyTransform(f.slice(2),d);this.minX=Math.min(this.minX,y[0],M[0]),this.minY=Math.min(this.minY,y[1],M[1]),this.maxX=Math.max(this.maxX,y[0],M[0]),this.maxY=Math.max(this.maxY,y[1],M[1])}updateScalingPathMinMax(d,f){r.Util.scaleMinMax(d,f),this.minX=Math.min(this.minX,f[0]),this.maxX=Math.max(this.maxX,f[1]),this.minY=Math.min(this.minY,f[2]),this.maxY=Math.max(this.maxY,f[3])}updateCurvePathMinMax(d,f,y,M,D,B,C,a,m,v){const x=r.Util.bezierBoundingBox(f,y,M,D,B,C,a,m);if(v){v[0]=Math.min(v[0],x[0],x[2]),v[1]=Math.max(v[1],x[0],x[2]),v[2]=Math.min(v[2],x[1],x[3]),v[3]=Math.max(v[3],x[1],x[3]);return}this.updateRectMinMax(d,x)}getPathBoundingBox(d=w.PathType.FILL,f=null){const y=[this.minX,this.minY,this.maxX,this.maxY];if(d===w.PathType.STROKE){f||(0,r.unreachable)("Stroke bounding box must include transform.");const M=r.Util.singularValueDecompose2dScale(f),D=M[0]*this.lineWidth/2,B=M[1]*this.lineWidth/2;y[0]-=D,y[1]-=B,y[2]+=D,y[3]+=B}return y}updateClipFromPath(){const d=r.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(d||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(d){this.clipBox=d,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(d=w.PathType.FILL,f=null){return r.Util.intersect(this.clipBox,this.getPathBoundingBox(d,f))}}function R(b,d){if(typeof ImageData<"u"&&d instanceof ImageData){b.putImageData(d,0,0);return}const f=d.height,y=d.width,M=f%l,D=(f-M)/l,B=M===0?D:D+1,C=b.createImageData(y,l);let a=0,m;const v=d.data,x=C.data;let k,O,W,z;if(d.kind===r.ImageKind.GRAYSCALE_1BPP){const st=v.byteLength,q=new Uint32Array(x.buffer,0,x.byteLength>>2),X=q.length,Y=y+7>>3,J=4294967295,tt=r.FeatureTest.isLittleEndian?4278190080:255;for(k=0;k<B;k++){for(W=k<D?l:M,m=0,O=0;O<W;O++){const rt=st-a;let ot=0;const lt=rt>Y?y:rt*8-7,ct=lt&-8;let ht=0,dt=0;for(;ot<ct;ot+=8)dt=v[a++],q[m++]=dt&128?J:tt,q[m++]=dt&64?J:tt,q[m++]=dt&32?J:tt,q[m++]=dt&16?J:tt,q[m++]=dt&8?J:tt,q[m++]=dt&4?J:tt,q[m++]=dt&2?J:tt,q[m++]=dt&1?J:tt;for(;ot<lt;ot++)ht===0&&(dt=v[a++],ht=128),q[m++]=dt&ht?J:tt,ht>>=1}for(;m<X;)q[m++]=0;b.putImageData(C,0,k*l)}}else if(d.kind===r.ImageKind.RGBA_32BPP){for(O=0,z=y*l*4,k=0;k<D;k++)x.set(v.subarray(a,a+z)),a+=z,b.putImageData(C,0,O),O+=l;k<B&&(z=y*M*4,x.set(v.subarray(a,a+z)),b.putImageData(C,0,O))}else if(d.kind===r.ImageKind.RGB_24BPP)for(W=l,z=y*W,k=0;k<B;k++){for(k>=D&&(W=M,z=y*W),m=0,O=z;O--;)x[m++]=v[a++],x[m++]=v[a++],x[m++]=v[a++],x[m++]=255;b.putImageData(C,0,k*l)}else throw new Error(`bad image kind: ${d.kind}`)}function P(b,d){if(d.bitmap){b.drawImage(d.bitmap,0,0);return}const f=d.height,y=d.width,M=f%l,D=(f-M)/l,B=M===0?D:D+1,C=b.createImageData(y,l);let a=0;const m=d.data,v=C.data;for(let x=0;x<B;x++){const k=x<D?l:M;({srcPos:a}=(0,T.convertBlackAndWhiteToRGBA)({src:m,srcPos:a,dest:v,width:y,height:k,nonBlackColor:0})),b.putImageData(C,0,x*l)}}function p(b,d){const f=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const y of f)b[y]!==void 0&&(d[y]=b[y]);b.setLineDash!==void 0&&(d.setLineDash(b.getLineDash()),d.lineDashOffset=b.lineDashOffset)}function E(b){if(b.strokeStyle=b.fillStyle="#000000",b.fillRule="nonzero",b.globalAlpha=1,b.lineWidth=1,b.lineCap="butt",b.lineJoin="miter",b.miterLimit=10,b.globalCompositeOperation="source-over",b.font="10px sans-serif",b.setLineDash!==void 0&&(b.setLineDash([]),b.lineDashOffset=0),!r.isNodeJS){const{filter:d}=b;d!=="none"&&d!==""&&(b.filter="none")}}function j(b,d,f,y){const M=b.length;for(let D=3;D<M;D+=4){const B=b[D];if(B===0)b[D-3]=d,b[D-2]=f,b[D-1]=y;else if(B<255){const C=255-B;b[D-3]=b[D-3]*B+d*C>>8,b[D-2]=b[D-2]*B+f*C>>8,b[D-1]=b[D-1]*B+y*C>>8}}}function U(b,d,f){const y=b.length,M=1/255;for(let D=3;D<y;D+=4){const B=f?f[b[D]]:b[D];d[D]=d[D]*B*M|0}}function I(b,d,f){const y=b.length;for(let M=3;M<y;M+=4){const D=b[M-3]*77+b[M-2]*152+b[M-1]*28;d[M]=f?d[M]*f[D>>8]>>8:d[M]*D>>16}}function G(b,d,f,y,M,D,B,C,a,m,v){const x=!!D,k=x?D[0]:0,O=x?D[1]:0,W=x?D[2]:0,z=M==="Luminosity"?I:U,q=Math.min(y,Math.ceil(1048576/f));for(let X=0;X<y;X+=q){const Y=Math.min(q,y-X),J=b.getImageData(C-m,X+(a-v),f,Y),tt=d.getImageData(C,X+a,f,Y);x&&j(J.data,k,O,W),z(J.data,tt.data,B),d.putImageData(tt,C,X+a)}}function H(b,d,f,y){const M=y[0],D=y[1],B=y[2]-M,C=y[3]-D;B===0||C===0||(G(d.context,f,B,C,d.subtype,d.backdrop,d.transferMap,M,D,d.offsetX,d.offsetY),b.save(),b.globalAlpha=1,b.globalCompositeOperation="source-over",b.setTransform(1,0,0,1,0,0),b.drawImage(f.canvas,0,0),b.restore())}function nt(b,d){const f=r.Util.singularValueDecompose2dScale(b);f[0]=Math.fround(f[0]),f[1]=Math.fround(f[1]);const y=Math.fround((globalThis.devicePixelRatio||1)*u.PixelsPerInch.PDF_TO_CSS_UNITS);return d!==void 0?d:f[0]<=y||f[1]<=y}const Q=["butt","round","square"],Z=["miter","round","bevel"],it={},K={};class L{constructor(d,f,y,M,D,{optionalContentConfig:B,markedContentStack:C=null},a,m){this.ctx=d,this.current=new S(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=f,this.objs=y,this.canvasFactory=M,this.filterFactory=D,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=C||[],this.optionalContentConfig=B,this.cachedCanvases=new h(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=a,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=m,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(d,f=null){return typeof d=="string"?d.startsWith("g_")?this.commonObjs.get(d):this.objs.get(d):f}beginDrawing({transform:d,viewport:f,transparency:y=!1,background:M=null}){const D=this.ctx.canvas.width,B=this.ctx.canvas.height,C=this.ctx.fillStyle;if(this.ctx.fillStyle=M||"#ffffff",this.ctx.fillRect(0,0,D,B),this.ctx.fillStyle=C,y){const a=this.cachedCanvases.getCanvas("transparent",D,B);this.compositeCtx=this.ctx,this.transparentCanvas=a.canvas,this.ctx=a.context,this.ctx.save(),this.ctx.transform(...(0,u.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),E(this.ctx),d&&(this.ctx.transform(...d),this.outputScaleX=d[0],this.outputScaleY=d[0]),this.ctx.transform(...f.transform),this.viewportScale=f.scale,this.baseTransform=(0,u.getCurrentTransform)(this.ctx)}executeOperatorList(d,f,y,M){const D=d.argsArray,B=d.fnArray;let C=f||0;const a=D.length;if(a===C)return C;const m=a-C>s&&typeof y=="function",v=m?Date.now()+t:0;let x=0;const k=this.commonObjs,O=this.objs;let W;for(;;){if(M!==void 0&&C===M.nextBreakPoint)return M.breakIt(C,y),C;if(W=B[C],W!==r.OPS.dependency)this[W].apply(this,D[C]);else for(const z of D[C]){const st=z.startsWith("g_")?k:O;if(!st.has(z))return st.get(z,y),C}if(C++,C===a)return C;if(m&&++x>s){if(Date.now()>v)return y(),C;x=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const d of this._cachedBitmapsMap.values()){for(const f of d.values())typeof HTMLCanvasElement<"u"&&f instanceof HTMLCanvasElement&&(f.width=f.height=0);d.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const d=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(d!=="none"){const f=this.ctx.filter;this.ctx.filter=d,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=f}}}_scaleImage(d,f){const y=d.width,M=d.height;let D=Math.max(Math.hypot(f[0],f[1]),1),B=Math.max(Math.hypot(f[2],f[3]),1),C=y,a=M,m="prescale1",v,x;for(;D>2&&C>1||B>2&&a>1;){let k=C,O=a;D>2&&C>1&&(k=C>=16384?Math.floor(C/2)-1||1:Math.ceil(C/2),D/=C/k),B>2&&a>1&&(O=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a)/2,B/=a/O),v=this.cachedCanvases.getCanvas(m,k,O),x=v.context,x.clearRect(0,0,k,O),x.drawImage(d,0,0,C,a,0,0,k,O),d=v.canvas,C=k,a=O,m=m==="prescale1"?"prescale2":"prescale1"}return{img:d,paintWidth:C,paintHeight:a}}_createMaskCanvas(d){const f=this.ctx,{width:y,height:M}=d,D=this.current.fillColor,B=this.current.patternFill,C=(0,u.getCurrentTransform)(f);let a,m,v,x;if((d.bitmap||d.data)&&d.count>1){const ot=d.bitmap||d.data.buffer;m=JSON.stringify(B?C:[C.slice(0,4),D]),a=this._cachedBitmapsMap.get(ot),a||(a=new Map,this._cachedBitmapsMap.set(ot,a));const lt=a.get(m);if(lt&&!B){const ct=Math.round(Math.min(C[0],C[2])+C[4]),ht=Math.round(Math.min(C[1],C[3])+C[5]);return{canvas:lt,offsetX:ct,offsetY:ht}}v=lt}v||(x=this.cachedCanvases.getCanvas("maskCanvas",y,M),P(x.context,d));let k=r.Util.transform(C,[1/y,0,0,-1/M,0,0]);k=r.Util.transform(k,[1,0,0,1,0,-M]);const O=r.Util.applyTransform([0,0],k),W=r.Util.applyTransform([y,M],k),z=r.Util.normalizeRect([O[0],O[1],W[0],W[1]]),st=Math.round(z[2]-z[0])||1,q=Math.round(z[3]-z[1])||1,X=this.cachedCanvases.getCanvas("fillCanvas",st,q),Y=X.context,J=Math.min(O[0],W[0]),tt=Math.min(O[1],W[1]);Y.translate(-J,-tt),Y.transform(...k),v||(v=this._scaleImage(x.canvas,(0,u.getCurrentTransformInverse)(Y)),v=v.img,a&&B&&a.set(m,v)),Y.imageSmoothingEnabled=nt((0,u.getCurrentTransform)(Y),d.interpolate),g(Y,v,0,0,v.width,v.height,0,0,y,M),Y.globalCompositeOperation="source-in";const rt=r.Util.transform((0,u.getCurrentTransformInverse)(Y),[1,0,0,1,-J,-tt]);return Y.fillStyle=B?D.getPattern(f,this,rt,w.PathType.FILL):D,Y.fillRect(0,0,y,M),a&&!B&&(this.cachedCanvases.delete("fillCanvas"),a.set(m,X.canvas)),{canvas:X.canvas,offsetX:Math.round(J),offsetY:Math.round(tt)}}setLineWidth(d){d!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=d,this.ctx.lineWidth=d}setLineCap(d){this.ctx.lineCap=Q[d]}setLineJoin(d){this.ctx.lineJoin=Z[d]}setMiterLimit(d){this.ctx.miterLimit=d}setDash(d,f){const y=this.ctx;y.setLineDash!==void 0&&(y.setLineDash(d),y.lineDashOffset=f)}setRenderingIntent(d){}setFlatness(d){}setGState(d){for(const[f,y]of d)switch(f){case"LW":this.setLineWidth(y);break;case"LC":this.setLineCap(y);break;case"LJ":this.setLineJoin(y);break;case"ML":this.setMiterLimit(y);break;case"D":this.setDash(y[0],y[1]);break;case"RI":this.setRenderingIntent(y);break;case"FL":this.setFlatness(y);break;case"Font":this.setFont(y[0],y[1]);break;case"CA":this.current.strokeAlpha=y;break;case"ca":this.current.fillAlpha=y,this.ctx.globalAlpha=y;break;case"BM":this.ctx.globalCompositeOperation=y;break;case"SMask":this.current.activeSMask=y?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(y);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const d=this.inSMaskMode;this.current.activeSMask&&!d?this.beginSMaskMode():!this.current.activeSMask&&d&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const d=this.ctx.canvas.width,f=this.ctx.canvas.height,y="smaskGroupAt"+this.groupLevel,M=this.cachedCanvases.getCanvas(y,d,f);this.suspendedCtx=this.ctx,this.ctx=M.context;const D=this.ctx;D.setTransform(...(0,u.getCurrentTransform)(this.suspendedCtx)),p(this.suspendedCtx,D),e(D,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),p(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(d){if(!this.current.activeSMask)return;d?(d[0]=Math.floor(d[0]),d[1]=Math.floor(d[1]),d[2]=Math.ceil(d[2]),d[3]=Math.ceil(d[3])):d=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const f=this.current.activeSMask,y=this.suspendedCtx;H(y,f,this.ctx,d),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(p(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const d=this.current;this.stateStack.push(d),this.current=d.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),p(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(d,f,y,M,D,B){this.ctx.transform(d,f,y,M,D,B),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(d,f,y){const M=this.ctx,D=this.current;let B=D.x,C=D.y,a,m;const v=(0,u.getCurrentTransform)(M),x=v[0]===0&&v[3]===0||v[1]===0&&v[2]===0,k=x?y.slice(0):null;for(let O=0,W=0,z=d.length;O<z;O++)switch(d[O]|0){case r.OPS.rectangle:B=f[W++],C=f[W++];const st=f[W++],q=f[W++],X=B+st,Y=C+q;M.moveTo(B,C),st===0||q===0?M.lineTo(X,Y):(M.lineTo(X,C),M.lineTo(X,Y),M.lineTo(B,Y)),x||D.updateRectMinMax(v,[B,C,X,Y]),M.closePath();break;case r.OPS.moveTo:B=f[W++],C=f[W++],M.moveTo(B,C),x||D.updatePathMinMax(v,B,C);break;case r.OPS.lineTo:B=f[W++],C=f[W++],M.lineTo(B,C),x||D.updatePathMinMax(v,B,C);break;case r.OPS.curveTo:a=B,m=C,B=f[W+4],C=f[W+5],M.bezierCurveTo(f[W],f[W+1],f[W+2],f[W+3],B,C),D.updateCurvePathMinMax(v,a,m,f[W],f[W+1],f[W+2],f[W+3],B,C,k),W+=6;break;case r.OPS.curveTo2:a=B,m=C,M.bezierCurveTo(B,C,f[W],f[W+1],f[W+2],f[W+3]),D.updateCurvePathMinMax(v,a,m,B,C,f[W],f[W+1],f[W+2],f[W+3],k),B=f[W+2],C=f[W+3],W+=4;break;case r.OPS.curveTo3:a=B,m=C,B=f[W+2],C=f[W+3],M.bezierCurveTo(f[W],f[W+1],B,C,B,C),D.updateCurvePathMinMax(v,a,m,f[W],f[W+1],B,C,B,C,k),W+=4;break;case r.OPS.closePath:M.closePath();break}x&&D.updateScalingPathMinMax(v,k),D.setCurrentPoint(B,C)}closePath(){this.ctx.closePath()}stroke(d=!0){const f=this.ctx,y=this.current.strokeColor;f.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof y=="object"&&y?.getPattern?(f.save(),f.strokeStyle=y.getPattern(f,this,(0,u.getCurrentTransformInverse)(f),w.PathType.STROKE),this.rescaleAndStroke(!1),f.restore()):this.rescaleAndStroke(!0)),d&&this.consumePath(this.current.getClippedPathBoundingBox()),f.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(d=!0){const f=this.ctx,y=this.current.fillColor,M=this.current.patternFill;let D=!1;M&&(f.save(),f.fillStyle=y.getPattern(f,this,(0,u.getCurrentTransformInverse)(f),w.PathType.FILL),D=!0);const B=this.current.getClippedPathBoundingBox();this.contentVisible&&B!==null&&(this.pendingEOFill?(f.fill("evenodd"),this.pendingEOFill=!1):f.fill()),D&&f.restore(),d&&this.consumePath(B)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=it}eoClip(){this.pendingClip=K}beginText(){this.current.textMatrix=r.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const d=this.pendingTextPaths,f=this.ctx;if(d===void 0){f.beginPath();return}f.save(),f.beginPath();for(const y of d)f.setTransform(...y.transform),f.translate(y.x,y.y),y.addToPath(f,y.fontSize);f.restore(),f.clip(),f.beginPath(),delete this.pendingTextPaths}setCharSpacing(d){this.current.charSpacing=d}setWordSpacing(d){this.current.wordSpacing=d}setHScale(d){this.current.textHScale=d/100}setLeading(d){this.current.leading=-d}setFont(d,f){const y=this.commonObjs.get(d),M=this.current;if(!y)throw new Error(`Can't find font for ${d}`);if(M.fontMatrix=y.fontMatrix||r.FONT_IDENTITY_MATRIX,(M.fontMatrix[0]===0||M.fontMatrix[3]===0)&&(0,r.warn)("Invalid font matrix for font "+d),f<0?(f=-f,M.fontDirection=-1):M.fontDirection=1,this.current.font=y,this.current.fontSize=f,y.isType3Font)return;const D=y.loadedName||"sans-serif",B=y.systemFontInfo?.css||`"${D}", ${y.fallbackName}`;let C="normal";y.black?C="900":y.bold&&(C="bold");const a=y.italic?"italic":"normal";let m=f;f<N?m=N:f>F&&(m=F),this.current.fontSizeScale=f/m,this.ctx.font=`${a} ${C} ${m}px ${B}`}setTextRenderingMode(d){this.current.textRenderingMode=d}setTextRise(d){this.current.textRise=d}moveText(d,f){this.current.x=this.current.lineX+=d,this.current.y=this.current.lineY+=f}setLeadingMoveText(d,f){this.setLeading(-f),this.moveText(d,f)}setTextMatrix(d,f,y,M,D,B){this.current.textMatrix=[d,f,y,M,D,B],this.current.textMatrixScale=Math.hypot(d,f),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(d,f,y,M){const D=this.ctx,B=this.current,C=B.font,a=B.textRenderingMode,m=B.fontSize/B.fontSizeScale,v=a&r.TextRenderingMode.FILL_STROKE_MASK,x=!!(a&r.TextRenderingMode.ADD_TO_PATH_FLAG),k=B.patternFill&&!C.missingFile;let O;(C.disableFontFace||x||k)&&(O=C.getPathGenerator(this.commonObjs,d)),C.disableFontFace||k?(D.save(),D.translate(f,y),D.beginPath(),O(D,m),M&&D.setTransform(...M),(v===r.TextRenderingMode.FILL||v===r.TextRenderingMode.FILL_STROKE)&&D.fill(),(v===r.TextRenderingMode.STROKE||v===r.TextRenderingMode.FILL_STROKE)&&D.stroke(),D.restore()):((v===r.TextRenderingMode.FILL||v===r.TextRenderingMode.FILL_STROKE)&&D.fillText(d,f,y),(v===r.TextRenderingMode.STROKE||v===r.TextRenderingMode.FILL_STROKE)&&D.strokeText(d,f,y)),x&&(this.pendingTextPaths||=[]).push({transform:(0,u.getCurrentTransform)(D),x:f,y,fontSize:m,addToPath:O})}get isFontSubpixelAAEnabled(){const{context:d}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);d.scale(1.5,1),d.fillText("I",0,10);const f=d.getImageData(0,0,10,10).data;let y=!1;for(let M=3;M<f.length;M+=4)if(f[M]>0&&f[M]<255){y=!0;break}return(0,r.shadow)(this,"isFontSubpixelAAEnabled",y)}showText(d){const f=this.current,y=f.font;if(y.isType3Font)return this.showType3Text(d);const M=f.fontSize;if(M===0)return;const D=this.ctx,B=f.fontSizeScale,C=f.charSpacing,a=f.wordSpacing,m=f.fontDirection,v=f.textHScale*m,x=d.length,k=y.vertical,O=k?1:-1,W=y.defaultVMetrics,z=M*f.fontMatrix[0],st=f.textRenderingMode===r.TextRenderingMode.FILL&&!y.disableFontFace&&!f.patternFill;D.save(),D.transform(...f.textMatrix),D.translate(f.x,f.y+f.textRise),m>0?D.scale(v,-1):D.scale(v,1);let q;if(f.patternFill){D.save();const rt=f.fillColor.getPattern(D,this,(0,u.getCurrentTransformInverse)(D),w.PathType.FILL);q=(0,u.getCurrentTransform)(D),D.restore(),D.fillStyle=rt}let X=f.lineWidth;const Y=f.textMatrixScale;if(Y===0||X===0){const rt=f.textRenderingMode&r.TextRenderingMode.FILL_STROKE_MASK;(rt===r.TextRenderingMode.STROKE||rt===r.TextRenderingMode.FILL_STROKE)&&(X=this.getSinglePixelWidth())}else X/=Y;if(B!==1&&(D.scale(B,B),X/=B),D.lineWidth=X,y.isInvalidPDFjsFont){const rt=[];let ot=0;for(const lt of d)rt.push(lt.unicode),ot+=lt.width;D.fillText(rt.join(""),0,0),f.x+=ot*z*v,D.restore(),this.compose();return}let J=0,tt;for(tt=0;tt<x;++tt){const rt=d[tt];if(typeof rt=="number"){J+=O*rt*M/1e3;continue}let ot=!1;const lt=(rt.isSpace?a:0)+C,ct=rt.fontChar,ht=rt.accent;let dt,_t,pt=rt.width;if(k){const gt=rt.vmetric||W,vt=-(rt.vmetric?gt[1]:pt*.5)*z,Rt=gt[2]*z;pt=gt?-gt[0]:pt,dt=vt/B,_t=(J+Rt)/B}else dt=J/B,_t=0;if(y.remeasure&&pt>0){const gt=D.measureText(ct).width*1e3/M*B;if(pt<gt&&this.isFontSubpixelAAEnabled){const vt=pt/gt;ot=!0,D.save(),D.scale(vt,1),dt/=vt}else pt!==gt&&(dt+=(pt-gt)/2e3*M/B)}if(this.contentVisible&&(rt.isInFont||y.missingFile)){if(st&&!ht)D.fillText(ct,dt,_t);else if(this.paintChar(ct,dt,_t,q),ht){const gt=dt+M*ht.offset.x/B,vt=_t-M*ht.offset.y/B;this.paintChar(ht.fontChar,gt,vt,q)}}const Et=k?pt*z-lt*m:pt*z+lt*m;J+=Et,ot&&D.restore()}k?f.y-=J:f.x+=J*v,D.restore(),this.compose()}showType3Text(d){const f=this.ctx,y=this.current,M=y.font,D=y.fontSize,B=y.fontDirection,C=M.vertical?1:-1,a=y.charSpacing,m=y.wordSpacing,v=y.textHScale*B,x=y.fontMatrix||r.FONT_IDENTITY_MATRIX,k=d.length,O=y.textRenderingMode===r.TextRenderingMode.INVISIBLE;let W,z,st,q;if(!(O||D===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,f.save(),f.transform(...y.textMatrix),f.translate(y.x,y.y),f.scale(v,B),W=0;W<k;++W){if(z=d[W],typeof z=="number"){q=C*z*D/1e3,this.ctx.translate(q,0),y.x+=q*v;continue}const X=(z.isSpace?m:0)+a,Y=M.charProcOperatorList[z.operatorListId];if(!Y){(0,r.warn)(`Type3 character "${z.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=z,this.save(),f.scale(D,D),f.transform(...x),this.executeOperatorList(Y),this.restore()),st=r.Util.applyTransform([z.width,0],x)[0]*D+X,f.translate(st,0),y.x+=st*v}f.restore(),this.processingType3=null}}setCharWidth(d,f){}setCharWidthAndBounds(d,f,y,M,D,B){this.ctx.rect(y,M,D-y,B-M),this.ctx.clip(),this.endPath()}getColorN_Pattern(d){let f;if(d[0]==="TilingPattern"){const y=d[1],M=this.baseTransform||(0,u.getCurrentTransform)(this.ctx),D={createCanvasGraphics:B=>new L(B,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};f=new w.TilingPattern(d,y,this.ctx,D,M)}else f=this._getPattern(d[1],d[2]);return f}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(d,f,y){const M=r.Util.makeHexColor(d,f,y);this.ctx.strokeStyle=M,this.current.strokeColor=M}setFillRGBColor(d,f,y){const M=r.Util.makeHexColor(d,f,y);this.ctx.fillStyle=M,this.current.fillColor=M,this.current.patternFill=!1}_getPattern(d,f=null){let y;return this.cachedPatterns.has(d)?y=this.cachedPatterns.get(d):(y=(0,w.getShadingPattern)(this.getObject(d)),this.cachedPatterns.set(d,y)),f&&(y.matrix=f),y}shadingFill(d){if(!this.contentVisible)return;const f=this.ctx;this.save();const y=this._getPattern(d);f.fillStyle=y.getPattern(f,this,(0,u.getCurrentTransformInverse)(f),w.PathType.SHADING);const M=(0,u.getCurrentTransformInverse)(f);if(M){const{width:D,height:B}=f.canvas,[C,a,m,v]=r.Util.getAxialAlignedBoundingBox([0,0,D,B],M);this.ctx.fillRect(C,a,m-C,v-a)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,r.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,r.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(d,f){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(d)&&d.length===6&&this.transform(...d),this.baseTransform=(0,u.getCurrentTransform)(this.ctx),f)){const y=f[2]-f[0],M=f[3]-f[1];this.ctx.rect(f[0],f[1],y,M),this.current.updateRectMinMax((0,u.getCurrentTransform)(this.ctx),f),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(d){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const f=this.ctx;d.isolated||(0,r.info)("TODO: Support non-isolated groups."),d.knockout&&(0,r.warn)("Knockout groups not supported.");const y=(0,u.getCurrentTransform)(f);if(d.matrix&&f.transform(...d.matrix),!d.bbox)throw new Error("Bounding box is required.");let M=r.Util.getAxialAlignedBoundingBox(d.bbox,(0,u.getCurrentTransform)(f));const D=[0,0,f.canvas.width,f.canvas.height];M=r.Util.intersect(M,D)||[0,0,0,0];const B=Math.floor(M[0]),C=Math.floor(M[1]);let a=Math.max(Math.ceil(M[2])-B,1),m=Math.max(Math.ceil(M[3])-C,1),v=1,x=1;a>i&&(v=a/i,a=i),m>i&&(x=m/i,m=i),this.current.startNewPathAndClipBox([0,0,a,m]);let k="groupAt"+this.groupLevel;d.smask&&(k+="_smask_"+this.smaskCounter++%2);const O=this.cachedCanvases.getCanvas(k,a,m),W=O.context;W.scale(1/v,1/x),W.translate(-B,-C),W.transform(...y),d.smask?this.smaskStack.push({canvas:O.canvas,context:W,offsetX:B,offsetY:C,scaleX:v,scaleY:x,subtype:d.smask.subtype,backdrop:d.smask.backdrop,transferMap:d.smask.transferMap||null,startTransformInverse:null}):(f.setTransform(1,0,0,1,0,0),f.translate(B,C),f.scale(v,x),f.save()),p(f,W),this.ctx=W,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(f),this.groupLevel++}endGroup(d){if(!this.contentVisible)return;this.groupLevel--;const f=this.ctx,y=this.groupStack.pop();if(this.ctx=y,this.ctx.imageSmoothingEnabled=!1,d.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const M=(0,u.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...M);const D=r.Util.getAxialAlignedBoundingBox([0,0,f.canvas.width,f.canvas.height],M);this.ctx.drawImage(f.canvas,0,0),this.ctx.restore(),this.compose(D)}}beginAnnotation(d,f,y,M,D){if(this.#t(),E(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(f)&&f.length===4){const B=f[2]-f[0],C=f[3]-f[1];if(D&&this.annotationCanvasMap){y=y.slice(),y[4]-=f[0],y[5]-=f[1],f=f.slice(),f[0]=f[1]=0,f[2]=B,f[3]=C;const[a,m]=r.Util.singularValueDecompose2dScale((0,u.getCurrentTransform)(this.ctx)),{viewportScale:v}=this,x=Math.ceil(B*this.outputScaleX*v),k=Math.ceil(C*this.outputScaleY*v);this.annotationCanvas=this.canvasFactory.create(x,k);const{canvas:O,context:W}=this.annotationCanvas;this.annotationCanvasMap.set(d,O),this.annotationCanvas.savedCtx=this.ctx,this.ctx=W,this.ctx.save(),this.ctx.setTransform(a,0,0,-m,0,C*m),E(this.ctx)}else E(this.ctx),this.ctx.rect(f[0],f[1],B,C),this.ctx.clip(),this.endPath()}this.current=new S(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...y),this.transform(...M)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(d){if(!this.contentVisible)return;const f=d.count;d=this.getObject(d.data,d),d.count=f;const y=this.ctx,M=this.processingType3;if(M&&(M.compiled===void 0&&(M.compiled=o(d)),M.compiled)){M.compiled(y);return}const D=this._createMaskCanvas(d),B=D.canvas;y.save(),y.setTransform(1,0,0,1,0,0),y.drawImage(B,D.offsetX,D.offsetY),y.restore(),this.compose()}paintImageMaskXObjectRepeat(d,f,y=0,M=0,D,B){if(!this.contentVisible)return;d=this.getObject(d.data,d);const C=this.ctx;C.save();const a=(0,u.getCurrentTransform)(C);C.transform(f,y,M,D,0,0);const m=this._createMaskCanvas(d);C.setTransform(1,0,0,1,m.offsetX-a[4],m.offsetY-a[5]);for(let v=0,x=B.length;v<x;v+=2){const k=r.Util.transform(a,[f,y,M,D,B[v],B[v+1]]),[O,W]=r.Util.applyTransform([0,0],k);C.drawImage(m.canvas,O,W)}C.restore(),this.compose()}paintImageMaskXObjectGroup(d){if(!this.contentVisible)return;const f=this.ctx,y=this.current.fillColor,M=this.current.patternFill;for(const D of d){const{data:B,width:C,height:a,transform:m}=D,v=this.cachedCanvases.getCanvas("maskCanvas",C,a),x=v.context;x.save();const k=this.getObject(B,D);P(x,k),x.globalCompositeOperation="source-in",x.fillStyle=M?y.getPattern(x,this,(0,u.getCurrentTransformInverse)(f),w.PathType.FILL):y,x.fillRect(0,0,C,a),x.restore(),f.save(),f.transform(...m),f.scale(1,-1),g(f,v.canvas,0,0,C,a,0,-1,1,1),f.restore()}this.compose()}paintImageXObject(d){if(!this.contentVisible)return;const f=this.getObject(d);if(!f){(0,r.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(f)}paintImageXObjectRepeat(d,f,y,M){if(!this.contentVisible)return;const D=this.getObject(d);if(!D){(0,r.warn)("Dependent image isn't ready yet");return}const B=D.width,C=D.height,a=[];for(let m=0,v=M.length;m<v;m+=2)a.push({transform:[f,0,0,y,M[m],M[m+1]],x:0,y:0,w:B,h:C});this.paintInlineImageXObjectGroup(D,a)}applyTransferMapsToCanvas(d){return this.current.transferMaps!=="none"&&(d.filter=this.current.transferMaps,d.drawImage(d.canvas,0,0),d.filter="none"),d.canvas}applyTransferMapsToBitmap(d){if(this.current.transferMaps==="none")return d.bitmap;const{bitmap:f,width:y,height:M}=d,D=this.cachedCanvases.getCanvas("inlineImage",y,M),B=D.context;return B.filter=this.current.transferMaps,B.drawImage(f,0,0),B.filter="none",D.canvas}paintInlineImageXObject(d){if(!this.contentVisible)return;const f=d.width,y=d.height,M=this.ctx;if(this.save(),!r.isNodeJS){const{filter:C}=M;C!=="none"&&C!==""&&(M.filter="none")}M.scale(1/f,-1/y);let D;if(d.bitmap)D=this.applyTransferMapsToBitmap(d);else if(typeof HTMLElement=="function"&&d instanceof HTMLElement||!d.data)D=d;else{const a=this.cachedCanvases.getCanvas("inlineImage",f,y).context;R(a,d),D=this.applyTransferMapsToCanvas(a)}const B=this._scaleImage(D,(0,u.getCurrentTransformInverse)(M));M.imageSmoothingEnabled=nt((0,u.getCurrentTransform)(M),d.interpolate),g(M,B.img,0,0,B.paintWidth,B.paintHeight,0,-y,f,y),this.compose(),this.restore()}paintInlineImageXObjectGroup(d,f){if(!this.contentVisible)return;const y=this.ctx;let M;if(d.bitmap)M=d.bitmap;else{const D=d.width,B=d.height,a=this.cachedCanvases.getCanvas("inlineImage",D,B).context;R(a,d),M=this.applyTransferMapsToCanvas(a)}for(const D of f)y.save(),y.transform(...D.transform),y.scale(1,-1),g(y,M,D.x,D.y,D.w,D.h,0,-1,1,1),y.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(d){}markPointProps(d,f){}beginMarkedContent(d){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(d,f){d==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(f)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(d){const f=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(d);const y=this.ctx;this.pendingClip&&(f||(this.pendingClip===K?y.clip("evenodd"):y.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),y.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const d=(0,u.getCurrentTransform)(this.ctx);if(d[1]===0&&d[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(d[0]),Math.abs(d[3]));else{const f=Math.abs(d[0]*d[3]-d[2]*d[1]),y=Math.hypot(d[0],d[2]),M=Math.hypot(d[1],d[3]);this._cachedGetSinglePixelWidth=Math.max(y,M)/f}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:d}=this.current,{a:f,b:y,c:M,d:D}=this.ctx.getTransform();let B,C;if(y===0&&M===0){const a=Math.abs(f),m=Math.abs(D);if(a===m)if(d===0)B=C=1/a;else{const v=a*d;B=C=v<1?1/v:1}else if(d===0)B=1/a,C=1/m;else{const v=a*d,x=m*d;B=v<1?1/v:1,C=x<1?1/x:1}}else{const a=Math.abs(f*D-y*M),m=Math.hypot(f,y),v=Math.hypot(M,D);if(d===0)B=v/a,C=m/a;else{const x=d*a;B=v>x?v/x:1,C=m>x?m/x:1}}this._cachedScaleForStroking[0]=B,this._cachedScaleForStroking[1]=C}return this._cachedScaleForStroking}rescaleAndStroke(d){const{ctx:f}=this,{lineWidth:y}=this.current,[M,D]=this.getScaleForStroking();if(f.lineWidth=y||1,M===1&&D===1){f.stroke();return}const B=f.getLineDash();if(d&&f.save(),f.scale(M,D),B.length>0){const C=Math.max(M,D);f.setLineDash(B.map(a=>a/C)),f.lineDashOffset/=C}f.stroke(),d&&f.restore()}isContentVisible(){for(let d=this.markedContentStack.length-1;d>=0;d--)if(!this.markedContentStack[d].visible)return!1;return!0}}n.CanvasGraphics=L;for(const b in r.OPS)L.prototype[b]!==void 0&&(L.prototype[r.OPS[b]]=L.prototype[b])},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TilingPattern=n.PathType=void 0,n.getShadingPattern=l;var r=_(1),u=_(6);const w={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};n.PathType=w;function T(g,o){if(!o)return;const S=o[2]-o[0],R=o[3]-o[1],P=new Path2D;P.rect(o[0],o[1],S,R),g.clip(P)}class N{constructor(){this.constructor===N&&(0,r.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,r.unreachable)("Abstract method `getPattern` called.")}}class F extends N{constructor(o){super(),this._type=o[1],this._bbox=o[2],this._colorStops=o[3],this._p0=o[4],this._p1=o[5],this._r0=o[6],this._r1=o[7],this.matrix=null}_createGradient(o){let S;this._type==="axial"?S=o.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(S=o.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const R of this._colorStops)S.addColorStop(R[0],R[1]);return S}getPattern(o,S,R,P){let p;if(P===w.STROKE||P===w.FILL){const E=S.current.getClippedPathBoundingBox(P,(0,u.getCurrentTransform)(o))||[0,0,0,0],j=Math.ceil(E[2]-E[0])||1,U=Math.ceil(E[3]-E[1])||1,I=S.cachedCanvases.getCanvas("pattern",j,U,!0),G=I.context;G.clearRect(0,0,G.canvas.width,G.canvas.height),G.beginPath(),G.rect(0,0,G.canvas.width,G.canvas.height),G.translate(-E[0],-E[1]),R=r.Util.transform(R,[1,0,0,1,E[0],E[1]]),G.transform(...S.baseTransform),this.matrix&&G.transform(...this.matrix),T(G,this._bbox),G.fillStyle=this._createGradient(G),G.fill(),p=o.createPattern(I.canvas,"no-repeat");const H=new DOMMatrix(R);p.setTransform(H)}else T(o,this._bbox),p=this._createGradient(o);return p}}function i(g,o,S,R,P,p,E,j){const U=o.coords,I=o.colors,G=g.data,H=g.width*4;let nt;U[S+1]>U[R+1]&&(nt=S,S=R,R=nt,nt=p,p=E,E=nt),U[R+1]>U[P+1]&&(nt=R,R=P,P=nt,nt=E,E=j,j=nt),U[S+1]>U[R+1]&&(nt=S,S=R,R=nt,nt=p,p=E,E=nt);const Q=(U[S]+o.offsetX)*o.scaleX,Z=(U[S+1]+o.offsetY)*o.scaleY,it=(U[R]+o.offsetX)*o.scaleX,K=(U[R+1]+o.offsetY)*o.scaleY,L=(U[P]+o.offsetX)*o.scaleX,b=(U[P+1]+o.offsetY)*o.scaleY;if(Z>=b)return;const d=I[p],f=I[p+1],y=I[p+2],M=I[E],D=I[E+1],B=I[E+2],C=I[j],a=I[j+1],m=I[j+2],v=Math.round(Z),x=Math.round(b);let k,O,W,z,st,q,X,Y;for(let J=v;J<=x;J++){if(J<K){const ct=J<Z?0:(Z-J)/(Z-K);k=Q-(Q-it)*ct,O=d-(d-M)*ct,W=f-(f-D)*ct,z=y-(y-B)*ct}else{let ct;J>b?ct=1:K===b?ct=0:ct=(K-J)/(K-b),k=it-(it-L)*ct,O=M-(M-C)*ct,W=D-(D-a)*ct,z=B-(B-m)*ct}let tt;J<Z?tt=0:J>b?tt=1:tt=(Z-J)/(Z-b),st=Q-(Q-L)*tt,q=d-(d-C)*tt,X=f-(f-a)*tt,Y=y-(y-m)*tt;const rt=Math.round(Math.min(k,st)),ot=Math.round(Math.max(k,st));let lt=H*J+rt*4;for(let ct=rt;ct<=ot;ct++)tt=(k-ct)/(k-st),tt<0?tt=0:tt>1&&(tt=1),G[lt++]=O-(O-q)*tt|0,G[lt++]=W-(W-X)*tt|0,G[lt++]=z-(z-Y)*tt|0,G[lt++]=255}}function t(g,o,S){const R=o.coords,P=o.colors;let p,E;switch(o.type){case"lattice":const j=o.verticesPerRow,U=Math.floor(R.length/j)-1,I=j-1;for(p=0;p<U;p++){let G=p*j;for(let H=0;H<I;H++,G++)i(g,S,R[G],R[G+1],R[G+j],P[G],P[G+1],P[G+j]),i(g,S,R[G+j+1],R[G+1],R[G+j],P[G+j+1],P[G+1],P[G+j])}break;case"triangles":for(p=0,E=R.length;p<E;p+=3)i(g,S,R[p],R[p+1],R[p+2],P[p],P[p+1],P[p+2]);break;default:throw new Error("illegal figure")}}class s extends N{constructor(o){super(),this._coords=o[2],this._colors=o[3],this._figures=o[4],this._bounds=o[5],this._bbox=o[7],this._background=o[8],this.matrix=null}_createMeshCanvas(o,S,R){const j=Math.floor(this._bounds[0]),U=Math.floor(this._bounds[1]),I=Math.ceil(this._bounds[2])-j,G=Math.ceil(this._bounds[3])-U,H=Math.min(Math.ceil(Math.abs(I*o[0]*1.1)),3e3),nt=Math.min(Math.ceil(Math.abs(G*o[1]*1.1)),3e3),Q=I/H,Z=G/nt,it={coords:this._coords,colors:this._colors,offsetX:-j,offsetY:-U,scaleX:1/Q,scaleY:1/Z},K=H+2*2,L=nt+2*2,b=R.getCanvas("mesh",K,L,!1),d=b.context,f=d.createImageData(H,nt);if(S){const M=f.data;for(let D=0,B=M.length;D<B;D+=4)M[D]=S[0],M[D+1]=S[1],M[D+2]=S[2],M[D+3]=255}for(const M of this._figures)t(f,M,it);return d.putImageData(f,2,2),{canvas:b.canvas,offsetX:j-2*Q,offsetY:U-2*Z,scaleX:Q,scaleY:Z}}getPattern(o,S,R,P){T(o,this._bbox);let p;if(P===w.SHADING)p=r.Util.singularValueDecompose2dScale((0,u.getCurrentTransform)(o));else if(p=r.Util.singularValueDecompose2dScale(S.baseTransform),this.matrix){const j=r.Util.singularValueDecompose2dScale(this.matrix);p=[p[0]*j[0],p[1]*j[1]]}const E=this._createMeshCanvas(p,P===w.SHADING?null:this._background,S.cachedCanvases);return P!==w.SHADING&&(o.setTransform(...S.baseTransform),this.matrix&&o.transform(...this.matrix)),o.translate(E.offsetX,E.offsetY),o.scale(E.scaleX,E.scaleY),o.createPattern(E.canvas,"no-repeat")}}class c extends N{getPattern(){return"hotpink"}}function l(g){switch(g[0]){case"RadialAxial":return new F(g);case"Mesh":return new s(g);case"Dummy":return new c}throw new Error(`Unknown IR type: ${g[0]}`)}const e={COLORED:1,UNCOLORED:2};class h{static MAX_PATTERN_SIZE=3e3;constructor(o,S,R,P,p){this.operatorList=o[2],this.matrix=o[3]||[1,0,0,1,0,0],this.bbox=o[4],this.xstep=o[5],this.ystep=o[6],this.paintType=o[7],this.tilingType=o[8],this.color=S,this.ctx=R,this.canvasGraphicsFactory=P,this.baseTransform=p}createPatternCanvas(o){const S=this.operatorList,R=this.bbox,P=this.xstep,p=this.ystep,E=this.paintType,j=this.tilingType,U=this.color,I=this.canvasGraphicsFactory;(0,r.info)("TilingType: "+j);const G=R[0],H=R[1],nt=R[2],Q=R[3],Z=r.Util.singularValueDecompose2dScale(this.matrix),it=r.Util.singularValueDecompose2dScale(this.baseTransform),K=[Z[0]*it[0],Z[1]*it[1]],L=this.getSizeAndScale(P,this.ctx.canvas.width,K[0]),b=this.getSizeAndScale(p,this.ctx.canvas.height,K[1]),d=o.cachedCanvases.getCanvas("pattern",L.size,b.size,!0),f=d.context,y=I.createCanvasGraphics(f);y.groupLevel=o.groupLevel,this.setFillAndStrokeStyleToContext(y,E,U);let M=G,D=H,B=nt,C=Q;return G<0&&(M=0,B+=Math.abs(G)),H<0&&(D=0,C+=Math.abs(H)),f.translate(-(L.scale*M),-(b.scale*D)),y.transform(L.scale,0,0,b.scale,0,0),f.save(),this.clipBbox(y,M,D,B,C),y.baseTransform=(0,u.getCurrentTransform)(y.ctx),y.executeOperatorList(S),y.endDrawing(),{canvas:d.canvas,scaleX:L.scale,scaleY:b.scale,offsetX:M,offsetY:D}}getSizeAndScale(o,S,R){o=Math.abs(o);const P=Math.max(h.MAX_PATTERN_SIZE,S);let p=Math.ceil(o*R);return p>=P?p=P:R=p/o,{scale:R,size:p}}clipBbox(o,S,R,P,p){const E=P-S,j=p-R;o.ctx.rect(S,R,E,j),o.current.updateRectMinMax((0,u.getCurrentTransform)(o.ctx),[S,R,P,p]),o.clip(),o.endPath()}setFillAndStrokeStyleToContext(o,S,R){const P=o.ctx,p=o.current;switch(S){case e.COLORED:const E=this.ctx;P.fillStyle=E.fillStyle,P.strokeStyle=E.strokeStyle,p.fillColor=E.fillStyle,p.strokeColor=E.strokeStyle;break;case e.UNCOLORED:const j=r.Util.makeHexColor(R[0],R[1],R[2]);P.fillStyle=j,P.strokeStyle=j,p.fillColor=j,p.strokeColor=j;break;default:throw new r.FormatError(`Unsupported paint type: ${S}`)}}getPattern(o,S,R,P){let p=R;P!==w.SHADING&&(p=r.Util.transform(p,S.baseTransform),this.matrix&&(p=r.Util.transform(p,this.matrix)));const E=this.createPatternCanvas(S);let j=new DOMMatrix(p);j=j.translate(E.offsetX,E.offsetY),j=j.scale(1/E.scaleX,1/E.scaleY);const U=o.createPattern(E.canvas,"repeat");return U.setTransform(j),U}}n.TilingPattern=h},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.convertBlackAndWhiteToRGBA=w,n.convertToRGBA=u,n.grayToRGBA=N;var r=_(1);function u(F){switch(F.kind){case r.ImageKind.GRAYSCALE_1BPP:return w(F);case r.ImageKind.RGB_24BPP:return T(F)}return null}function w({src:F,srcPos:i=0,dest:t,width:s,height:c,nonBlackColor:l=4294967295,inverseDecode:e=!1}){const h=r.FeatureTest.isLittleEndian?4278190080:255,[g,o]=e?[l,h]:[h,l],S=s>>3,R=s&7,P=F.length;t=new Uint32Array(t.buffer);let p=0;for(let E=0;E<c;E++){for(const U=i+S;i<U;i++){const I=i<P?F[i]:255;t[p++]=I&128?o:g,t[p++]=I&64?o:g,t[p++]=I&32?o:g,t[p++]=I&16?o:g,t[p++]=I&8?o:g,t[p++]=I&4?o:g,t[p++]=I&2?o:g,t[p++]=I&1?o:g}if(R===0)continue;const j=i<P?F[i++]:255;for(let U=0;U<R;U++)t[p++]=j&1<<7-U?o:g}return{srcPos:i,destPos:p}}function T({src:F,srcPos:i=0,dest:t,destPos:s=0,width:c,height:l}){let e=0;const h=F.length>>2,g=new Uint32Array(F.buffer,i,h);if(r.FeatureTest.isLittleEndian){for(;e<h-2;e+=3,s+=4){const o=g[e],S=g[e+1],R=g[e+2];t[s]=o|4278190080,t[s+1]=o>>>24|S<<8|4278190080,t[s+2]=S>>>16|R<<16|4278190080,t[s+3]=R>>>8|4278190080}for(let o=e*4,S=F.length;o<S;o+=3)t[s++]=F[o]|F[o+1]<<8|F[o+2]<<16|4278190080}else{for(;e<h-2;e+=3,s+=4){const o=g[e],S=g[e+1],R=g[e+2];t[s]=o|255,t[s+1]=o<<24|S>>>8|255,t[s+2]=S<<16|R>>>16|255,t[s+3]=R<<8|255}for(let o=e*4,S=F.length;o<S;o+=3)t[s++]=F[o]<<24|F[o+1]<<16|F[o+2]<<8|255}return{srcPos:i,destPos:s}}function N(F,i){if(r.FeatureTest.isLittleEndian)for(let t=0,s=F.length;t<s;t++)i[t]=F[t]*65793|4278190080;else for(let t=0,s=F.length;t<s;t++)i[t]=F[t]*16843008|255}},(A,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.GlobalWorkerOptions=void 0;const _=Object.create(null);n.GlobalWorkerOptions=_,_.workerPort=null,_.workerSrc=""},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MessageHandler=void 0;var r=_(1);const u={UNKNOWN:0,DATA:1,ERROR:2},w={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function T(F){switch(F instanceof Error||typeof F=="object"&&F!==null||(0,r.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),F.name){case"AbortException":return new r.AbortException(F.message);case"MissingPDFException":return new r.MissingPDFException(F.message);case"PasswordException":return new r.PasswordException(F.message,F.code);case"UnexpectedResponseException":return new r.UnexpectedResponseException(F.message,F.status);case"UnknownErrorException":return new r.UnknownErrorException(F.message,F.details);default:return new r.UnknownErrorException(F.message,F.toString())}}class N{constructor(i,t,s){this.sourceName=i,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=c=>{const l=c.data;if(l.targetName!==this.sourceName)return;if(l.stream){this.#e(l);return}if(l.callback){const h=l.callbackId,g=this.callbackCapabilities[h];if(!g)throw new Error(`Cannot resolve callback ${h}`);if(delete this.callbackCapabilities[h],l.callback===u.DATA)g.resolve(l.data);else if(l.callback===u.ERROR)g.reject(T(l.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[l.action];if(!e)throw new Error(`Unknown action from worker: ${l.action}`);if(l.callbackId){const h=this.sourceName,g=l.sourceName;new Promise(function(o){o(e(l.data))}).then(function(o){s.postMessage({sourceName:h,targetName:g,callback:u.DATA,callbackId:l.callbackId,data:o})},function(o){s.postMessage({sourceName:h,targetName:g,callback:u.ERROR,callbackId:l.callbackId,reason:T(o)})});return}if(l.streamId){this.#t(l);return}e(l.data)},s.addEventListener("message",this._onComObjOnMessage)}on(i,t){const s=this.actionHandler;if(s[i])throw new Error(`There is already an actionName called "${i}"`);s[i]=t}send(i,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:i,data:t},s)}sendWithPromise(i,t,s){const c=this.callbackId++,l=new r.PromiseCapability;this.callbackCapabilities[c]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:i,callbackId:c,data:t},s)}catch(e){l.reject(e)}return l.promise}sendWithStream(i,t,s,c){const l=this.streamId++,e=this.sourceName,h=this.targetName,g=this.comObj;return new ReadableStream({start:o=>{const S=new r.PromiseCapability;return this.streamControllers[l]={controller:o,startCall:S,pullCall:null,cancelCall:null,isClosed:!1},g.postMessage({sourceName:e,targetName:h,action:i,streamId:l,data:t,desiredSize:o.desiredSize},c),S.promise},pull:o=>{const S=new r.PromiseCapability;return this.streamControllers[l].pullCall=S,g.postMessage({sourceName:e,targetName:h,stream:w.PULL,streamId:l,desiredSize:o.desiredSize}),S.promise},cancel:o=>{(0,r.assert)(o instanceof Error,"cancel must have a valid reason");const S=new r.PromiseCapability;return this.streamControllers[l].cancelCall=S,this.streamControllers[l].isClosed=!0,g.postMessage({sourceName:e,targetName:h,stream:w.CANCEL,streamId:l,reason:T(o)}),S.promise}},s)}#t(i){const t=i.streamId,s=this.sourceName,c=i.sourceName,l=this.comObj,e=this,h=this.actionHandler[i.action],g={enqueue(o,S=1,R){if(this.isCancelled)return;const P=this.desiredSize;this.desiredSize-=S,P>0&&this.desiredSize<=0&&(this.sinkCapability=new r.PromiseCapability,this.ready=this.sinkCapability.promise),l.postMessage({sourceName:s,targetName:c,stream:w.ENQUEUE,streamId:t,chunk:o},R)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:s,targetName:c,stream:w.CLOSE,streamId:t}),delete e.streamSinks[t])},error(o){(0,r.assert)(o instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:s,targetName:c,stream:w.ERROR,streamId:t,reason:T(o)}))},sinkCapability:new r.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:i.desiredSize,ready:null};g.sinkCapability.resolve(),g.ready=g.sinkCapability.promise,this.streamSinks[t]=g,new Promise(function(o){o(h(i.data,g))}).then(function(){l.postMessage({sourceName:s,targetName:c,stream:w.START_COMPLETE,streamId:t,success:!0})},function(o){l.postMessage({sourceName:s,targetName:c,stream:w.START_COMPLETE,streamId:t,reason:T(o)})})}#e(i){const t=i.streamId,s=this.sourceName,c=i.sourceName,l=this.comObj,e=this.streamControllers[t],h=this.streamSinks[t];switch(i.stream){case w.START_COMPLETE:i.success?e.startCall.resolve():e.startCall.reject(T(i.reason));break;case w.PULL_COMPLETE:i.success?e.pullCall.resolve():e.pullCall.reject(T(i.reason));break;case w.PULL:if(!h){l.postMessage({sourceName:s,targetName:c,stream:w.PULL_COMPLETE,streamId:t,success:!0});break}h.desiredSize<=0&&i.desiredSize>0&&h.sinkCapability.resolve(),h.desiredSize=i.desiredSize,new Promise(function(g){g(h.onPull?.())}).then(function(){l.postMessage({sourceName:s,targetName:c,stream:w.PULL_COMPLETE,streamId:t,success:!0})},function(g){l.postMessage({sourceName:s,targetName:c,stream:w.PULL_COMPLETE,streamId:t,reason:T(g)})});break;case w.ENQUEUE:if((0,r.assert)(e,"enqueue should have stream controller"),e.isClosed)break;e.controller.enqueue(i.chunk);break;case w.CLOSE:if((0,r.assert)(e,"close should have stream controller"),e.isClosed)break;e.isClosed=!0,e.controller.close(),this.#n(e,t);break;case w.ERROR:(0,r.assert)(e,"error should have stream controller"),e.controller.error(T(i.reason)),this.#n(e,t);break;case w.CANCEL_COMPLETE:i.success?e.cancelCall.resolve():e.cancelCall.reject(T(i.reason)),this.#n(e,t);break;case w.CANCEL:if(!h)break;new Promise(function(g){g(h.onCancel?.(T(i.reason)))}).then(function(){l.postMessage({sourceName:s,targetName:c,stream:w.CANCEL_COMPLETE,streamId:t,success:!0})},function(g){l.postMessage({sourceName:s,targetName:c,stream:w.CANCEL_COMPLETE,streamId:t,reason:T(g)})}),h.sinkCapability.reject(T(i.reason)),h.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#n(i,t){await Promise.allSettled([i.startCall?.promise,i.pullCall?.promise,i.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}n.MessageHandler=N},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Metadata=void 0;var r=_(1);class u{#t;#e;constructor({parsedData:T,rawData:N}){this.#t=T,this.#e=N}getRaw(){return this.#e}get(T){return this.#t.get(T)??null}getAll(){return(0,r.objectFromMap)(this.#t)}has(T){return this.#t.has(T)}}n.Metadata=u},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OptionalContentConfig=void 0;var r=_(1),u=_(8);const w=Symbol("INTERNAL");class T{#t=!0;constructor(i,t){this.name=i,this.intent=t}get visible(){return this.#t}_setVisible(i,t){i!==w&&(0,r.unreachable)("Internal method `_setVisible` called."),this.#t=t}}class N{#t=null;#e=new Map;#n=null;#s=null;constructor(i){if(this.name=null,this.creator=null,i!==null){this.name=i.name,this.creator=i.creator,this.#s=i.order;for(const t of i.groups)this.#e.set(t.id,new T(t.name,t.intent));if(i.baseState==="OFF")for(const t of this.#e.values())t._setVisible(w,!1);for(const t of i.on)this.#e.get(t)._setVisible(w,!0);for(const t of i.off)this.#e.get(t)._setVisible(w,!1);this.#n=this.getHash()}}#o(i){const t=i.length;if(t<2)return!0;const s=i[0];for(let c=1;c<t;c++){const l=i[c];let e;if(Array.isArray(l))e=this.#o(l);else if(this.#e.has(l))e=this.#e.get(l).visible;else return(0,r.warn)(`Optional content group not found: ${l}`),!0;switch(s){case"And":if(!e)return!1;break;case"Or":if(e)return!0;break;case"Not":return!e;default:return!0}}return s==="And"}isVisible(i){if(this.#e.size===0)return!0;if(!i)return(0,r.warn)("Optional content group not defined."),!0;if(i.type==="OCG")return this.#e.has(i.id)?this.#e.get(i.id).visible:((0,r.warn)(`Optional content group not found: ${i.id}`),!0);if(i.type==="OCMD"){if(i.expression)return this.#o(i.expression);if(!i.policy||i.policy==="AnyOn"){for(const t of i.ids){if(!this.#e.has(t))return(0,r.warn)(`Optional content group not found: ${t}`),!0;if(this.#e.get(t).visible)return!0}return!1}else if(i.policy==="AllOn"){for(const t of i.ids){if(!this.#e.has(t))return(0,r.warn)(`Optional content group not found: ${t}`),!0;if(!this.#e.get(t).visible)return!1}return!0}else if(i.policy==="AnyOff"){for(const t of i.ids){if(!this.#e.has(t))return(0,r.warn)(`Optional content group not found: ${t}`),!0;if(!this.#e.get(t).visible)return!0}return!1}else if(i.policy==="AllOff"){for(const t of i.ids){if(!this.#e.has(t))return(0,r.warn)(`Optional content group not found: ${t}`),!0;if(this.#e.get(t).visible)return!1}return!0}return(0,r.warn)(`Unknown optional content policy ${i.policy}.`),!0}return(0,r.warn)(`Unknown group type ${i.type}.`),!0}setVisibility(i,t=!0){if(!this.#e.has(i)){(0,r.warn)(`Optional content group not found: ${i}`);return}this.#e.get(i)._setVisible(w,!!t),this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#s?this.#s.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?(0,r.objectFromMap)(this.#e):null}getGroup(i){return this.#e.get(i)||null}getHash(){if(this.#t!==null)return this.#t;const i=new u.MurmurHash3_64;for(const[t,s]of this.#e)i.update(`${t}:${s.visible}`);return this.#t=i.hexdigest()}}n.OptionalContentConfig=N},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFDataTransportStream=void 0;var r=_(1),u=_(6);class w{constructor({length:i,initialData:t,progressiveDone:s=!1,contentDispositionFilename:c=null,disableRange:l=!1,disableStream:e=!1},h){if((0,r.assert)(h,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=s,this._contentDispositionFilename=c,t?.length>0){const g=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;this._queuedChunks.push(g)}this._pdfDataRangeTransport=h,this._isStreamingSupported=!e,this._isRangeSupported=!l,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((g,o)=>{this._onReceiveData({begin:g,chunk:o})}),this._pdfDataRangeTransport.addProgressListener((g,o)=>{this._onProgress({loaded:g,total:o})}),this._pdfDataRangeTransport.addProgressiveReadListener(g=>{this._onReceiveData({chunk:g})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:i,chunk:t}){const s=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(i===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const c=this._rangeReaders.some(function(l){return l._begin!==i?!1:(l._enqueue(s),!0)});(0,r.assert)(c,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(i){i.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:i.loaded}):this._fullRequestReader?.onProgress?.({loaded:i.loaded,total:i.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(i){const t=this._rangeReaders.indexOf(i);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){(0,r.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const i=this._queuedChunks;return this._queuedChunks=null,new T(this,i,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(i,t){if(t<=this._progressiveDataLength)return null;const s=new N(this,i,t);return this._pdfDataRangeTransport.requestDataRange(i,t),this._rangeReaders.push(s),s}cancelAllRequests(i){this._fullRequestReader?.cancel(i);for(const t of this._rangeReaders.slice(0))t.cancel(i);this._pdfDataRangeTransport.abort()}}n.PDFDataTransportStream=w;class T{constructor(i,t,s=!1,c=null){this._stream=i,this._done=s||!1,this._filename=(0,u.isPdfFile)(c)?c:null,this._queuedChunks=t||[],this._loaded=0;for(const l of this._queuedChunks)this._loaded+=l.byteLength;this._requests=[],this._headersReady=Promise.resolve(),i._fullRequestReader=this,this.onProgress=null}_enqueue(i){this._done||(this._requests.length>0?this._requests.shift().resolve({value:i,done:!1}):this._queuedChunks.push(i),this._loaded+=i.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const i=new r.PromiseCapability;return this._requests.push(i),i.promise}cancel(i){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class N{constructor(i,t,s){this._stream=i,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(i){if(!this._done){if(this._requests.length===0)this._queuedChunk=i;else{this._requests.shift().resolve({value:i,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const i=new r.PromiseCapability;return this._requests.push(i),i.promise}cancel(i){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFFetchStream=void 0;var r=_(1),u=_(20);function w(s,c,l){return{method:"GET",headers:s,signal:l.signal,mode:"cors",credentials:c?"include":"same-origin",redirect:"follow"}}function T(s){const c=new Headers;for(const l in s){const e=s[l];e!==void 0&&c.append(l,e)}return c}function N(s){return s instanceof Uint8Array?s.buffer:s instanceof ArrayBuffer?s:((0,r.warn)(`getArrayBuffer - unexpected data format: ${s}`),new Uint8Array(s).buffer)}class F{constructor(c){this.source=c,this.isHttp=/^https?:/i.test(c.url),this.httpHeaders=this.isHttp&&c.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new i(this),this._fullRequestReader}getRangeReader(c,l){if(l<=this._progressiveDataLength)return null;const e=new t(this,c,l);return this._rangeRequestReaders.push(e),e}cancelAllRequests(c){this._fullRequestReader?.cancel(c);for(const l of this._rangeRequestReaders.slice(0))l.cancel(c)}}n.PDFFetchStream=F;class i{constructor(c){this._stream=c,this._reader=null,this._loaded=0,this._filename=null;const l=c.source;this._withCredentials=l.withCredentials||!1,this._contentLength=l.length,this._headersCapability=new r.PromiseCapability,this._disableRange=l.disableRange||!1,this._rangeChunkSize=l.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!l.disableStream,this._isRangeSupported=!l.disableRange,this._headers=T(this._stream.httpHeaders);const e=l.url;fetch(e,w(this._headers,this._withCredentials,this._abortController)).then(h=>{if(!(0,u.validateResponseStatus)(h.status))throw(0,u.createResponseStatusError)(h.status,e);this._reader=h.body.getReader(),this._headersCapability.resolve();const g=R=>h.headers.get(R),{allowRangeRequests:o,suggestedLength:S}=(0,u.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=S||this._contentLength,this._filename=(0,u.extractFilenameFromHeader)(g),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new r.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:c,done:l}=await this._reader.read();return l?{value:c,done:l}:(this._loaded+=c.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:N(c),done:!1})}cancel(c){this._reader?.cancel(c),this._abortController.abort()}}class t{constructor(c,l,e){this._stream=c,this._reader=null,this._loaded=0;const h=c.source;this._withCredentials=h.withCredentials||!1,this._readCapability=new r.PromiseCapability,this._isStreamingSupported=!h.disableStream,this._abortController=new AbortController,this._headers=T(this._stream.httpHeaders),this._headers.append("Range",`bytes=${l}-${e-1}`);const g=h.url;fetch(g,w(this._headers,this._withCredentials,this._abortController)).then(o=>{if(!(0,u.validateResponseStatus)(o.status))throw(0,u.createResponseStatusError)(o.status,g);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:c,done:l}=await this._reader.read();return l?{value:c,done:l}:(this._loaded+=c.byteLength,this.onProgress?.({loaded:this._loaded}),{value:N(c),done:!1})}cancel(c){this._reader?.cancel(c),this._abortController.abort()}}},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createResponseStatusError=F,n.extractFilenameFromHeader=N,n.validateRangeRequestCapabilities=T,n.validateResponseStatus=i;var r=_(1),u=_(21),w=_(6);function T({getResponseHeader:t,isHttp:s,rangeChunkSize:c,disableRange:l}){const e={allowRangeRequests:!1,suggestedLength:void 0},h=parseInt(t("Content-Length"),10);return!Number.isInteger(h)||(e.suggestedLength=h,h<=2*c)||l||!s||t("Accept-Ranges")!=="bytes"||(t("Content-Encoding")||"identity")!=="identity"||(e.allowRangeRequests=!0),e}function N(t){const s=t("Content-Disposition");if(s){let c=(0,u.getFilenameFromContentDispositionHeader)(s);if(c.includes("%"))try{c=decodeURIComponent(c)}catch{}if((0,w.isPdfFile)(c))return c}return null}function F(t,s){return t===404||t===0&&s.startsWith("file:")?new r.MissingPDFException('Missing PDF "'+s+'".'):new r.UnexpectedResponseException(`Unexpected server response (${t}) while retrieving PDF "${s}".`,t)}function i(t){return t===200||t===206}},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getFilenameFromContentDispositionHeader=u;var r=_(1);function u(w){let T=!0,N=F("filename\\*","i").exec(w);if(N){N=N[1];let h=c(N);return h=unescape(h),h=l(h),h=e(h),t(h)}if(N=s(w),N){const h=e(N);return t(h)}if(N=F("filename","i").exec(w),N){N=N[1];let h=c(N);return h=e(h),t(h)}function F(h,g){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function i(h,g){if(h){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const o=new TextDecoder(h,{fatal:!0}),S=(0,r.stringToBytes)(g);g=o.decode(S),T=!1}catch{}}return g}function t(h){return T&&/[\x80-\xff]/.test(h)&&(h=i("utf-8",h),T&&(h=i("iso-8859-1",h))),h}function s(h){const g=[];let o;const S=F("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(o=S.exec(h))!==null;){let[,P,p,E]=o;if(P=parseInt(P,10),P in g){if(P===0)break;continue}g[P]=[p,E]}const R=[];for(let P=0;P<g.length&&P in g;++P){let[p,E]=g[P];E=c(E),p&&(E=unescape(E),P===0&&(E=l(E))),R.push(E)}return R.join("")}function c(h){if(h.startsWith('"')){const g=h.slice(1).split('\\"');for(let o=0;o<g.length;++o){const S=g[o].indexOf('"');S!==-1&&(g[o]=g[o].slice(0,S),g.length=o+1),g[o]=g[o].replaceAll(/\\(.)/g,"$1")}h=g.join('"')}return h}function l(h){const g=h.indexOf("'");if(g===-1)return h;const o=h.slice(0,g),R=h.slice(g+1).replace(/^[^']*'/,"");return i(o,R)}function e(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,o,S,R){if(S==="q"||S==="Q")return R=R.replaceAll("_"," "),R=R.replaceAll(/=([0-9a-fA-F]{2})/g,function(P,p){return String.fromCharCode(parseInt(p,16))}),i(o,R);try{R=atob(R)}catch{}return i(o,R)})}return""}},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNetworkStream=void 0;var r=_(1),u=_(20);const w=200,T=206;function N(c){const l=c.response;return typeof l!="string"?l:(0,r.stringToBytes)(l).buffer}class F{constructor(l,e={}){this.url=l,this.isHttp=/^https?:/i.test(l),this.httpHeaders=this.isHttp&&e.httpHeaders||Object.create(null),this.withCredentials=e.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(l,e,h){const g={begin:l,end:e};for(const o in h)g[o]=h[o];return this.request(g)}requestFull(l){return this.request(l)}request(l){const e=new XMLHttpRequest,h=this.currXhrId++,g=this.pendingRequests[h]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const o in this.httpHeaders){const S=this.httpHeaders[o];S!==void 0&&e.setRequestHeader(o,S)}return this.isHttp&&"begin"in l&&"end"in l?(e.setRequestHeader("Range",`bytes=${l.begin}-${l.end-1}`),g.expectedStatus=T):g.expectedStatus=w,e.responseType="arraybuffer",l.onError&&(e.onerror=function(o){l.onError(e.status)}),e.onreadystatechange=this.onStateChange.bind(this,h),e.onprogress=this.onProgress.bind(this,h),g.onHeadersReceived=l.onHeadersReceived,g.onDone=l.onDone,g.onError=l.onError,g.onProgress=l.onProgress,e.send(null),h}onProgress(l,e){const h=this.pendingRequests[l];h&&h.onProgress?.(e)}onStateChange(l,e){const h=this.pendingRequests[l];if(!h)return;const g=h.xhr;if(g.readyState>=2&&h.onHeadersReceived&&(h.onHeadersReceived(),delete h.onHeadersReceived),g.readyState!==4||!(l in this.pendingRequests))return;if(delete this.pendingRequests[l],g.status===0&&this.isHttp){h.onError?.(g.status);return}const o=g.status||w;if(!(o===w&&h.expectedStatus===T)&&o!==h.expectedStatus){h.onError?.(g.status);return}const R=N(g);if(o===T){const P=g.getResponseHeader("Content-Range"),p=/bytes (\d+)-(\d+)\/(\d+)/.exec(P);h.onDone({begin:parseInt(p[1],10),chunk:R})}else R?h.onDone({begin:0,chunk:R}):h.onError?.(g.status)}getRequestXhr(l){return this.pendingRequests[l].xhr}isPendingRequest(l){return l in this.pendingRequests}abortRequest(l){const e=this.pendingRequests[l].xhr;delete this.pendingRequests[l],e.abort()}}class i{constructor(l){this._source=l,this._manager=new F(l.url,{httpHeaders:l.httpHeaders,withCredentials:l.withCredentials}),this._rangeChunkSize=l.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(l){const e=this._rangeRequestReaders.indexOf(l);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new t(this._manager,this._source),this._fullRequestReader}getRangeReader(l,e){const h=new s(this._manager,l,e);return h.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(h),h}cancelAllRequests(l){this._fullRequestReader?.cancel(l);for(const e of this._rangeRequestReaders.slice(0))e.cancel(l)}}n.PDFNetworkStream=i;class t{constructor(l,e){this._manager=l;const h={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._fullRequestId=l.requestFull(h),this._headersReceivedCapability=new r.PromiseCapability,this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const l=this._fullRequestId,e=this._manager.getRequestXhr(l),h=S=>e.getResponseHeader(S),{allowRangeRequests:g,suggestedLength:o}=(0,u.validateRangeRequestCapabilities)({getResponseHeader:h,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});g&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=(0,u.extractFilenameFromHeader)(h),this._isRangeSupported&&this._manager.abortRequest(l),this._headersReceivedCapability.resolve()}_onDone(l){if(l&&(this._requests.length>0?this._requests.shift().resolve({value:l.chunk,done:!1}):this._cachedChunks.push(l.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(l){this._storedError=(0,u.createResponseStatusError)(l,this._url),this._headersReceivedCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(l){this.onProgress?.({loaded:l.loaded,total:l.lengthComputable?l.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const l=new r.PromiseCapability;return this._requests.push(l),l.promise}cancel(l){this._done=!0,this._headersReceivedCapability.reject(l);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class s{constructor(l,e,h){this._manager=l;const g={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=l.url,this._requestId=l.requestRange(e,h,g),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(l){const e=l.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const h of this._requests)h.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(l){this._storedError=(0,u.createResponseStatusError)(l,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(l){this.isStreamingSupported||this.onProgress?.({loaded:l.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const l=new r.PromiseCapability;return this._requests.push(l),l.promise}cancel(l){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNodeStream=void 0;var r=_(1),u=_(20);const w=/^file:\/\/\/[a-zA-Z]:\//;function T(h){const g=require$$5,o=g.parse(h);return o.protocol==="file:"||o.host?o:/^[a-z]:[/\\]/i.test(h)?g.parse(`file:///${h}`):(o.host||(o.protocol="file:"),o)}class N{constructor(g){this.source=g,this.url=T(g.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&g.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,r.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new l(this):new s(this),this._fullRequestReader}getRangeReader(g,o){if(o<=this._progressiveDataLength)return null;const S=this.isFsUrl?new e(this,g,o):new c(this,g,o);return this._rangeRequestReaders.push(S),S}cancelAllRequests(g){this._fullRequestReader?.cancel(g);for(const o of this._rangeRequestReaders.slice(0))o.cancel(g)}}n.PDFNodeStream=N;class F{constructor(g){this._url=g.url,this._done=!1,this._storedError=null,this.onProgress=null;const o=g.source;this._contentLength=o.length,this._loaded=0,this._filename=null,this._disableRange=o.disableRange||!1,this._rangeChunkSize=o.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!o.disableStream,this._isRangeSupported=!o.disableRange,this._readableStream=null,this._readCapability=new r.PromiseCapability,this._headersCapability=new r.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const g=this._readableStream.read();return g===null?(this._readCapability=new r.PromiseCapability,this.read()):(this._loaded+=g.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(g).buffer,done:!1})}cancel(g){if(!this._readableStream){this._error(g);return}this._readableStream.destroy(g)}_error(g){this._storedError=g,this._readCapability.resolve()}_setReadableStream(g){this._readableStream=g,g.on("readable",()=>{this._readCapability.resolve()}),g.on("end",()=>{g.destroy(),this._done=!0,this._readCapability.resolve()}),g.on("error",o=>{this._error(o)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new r.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class i{constructor(g){this._url=g.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new r.PromiseCapability;const o=g.source;this._isStreamingSupported=!o.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const g=this._readableStream.read();return g===null?(this._readCapability=new r.PromiseCapability,this.read()):(this._loaded+=g.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(g).buffer,done:!1})}cancel(g){if(!this._readableStream){this._error(g);return}this._readableStream.destroy(g)}_error(g){this._storedError=g,this._readCapability.resolve()}_setReadableStream(g){this._readableStream=g,g.on("readable",()=>{this._readCapability.resolve()}),g.on("end",()=>{g.destroy(),this._done=!0,this._readCapability.resolve()}),g.on("error",o=>{this._error(o)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function t(h,g){return{protocol:h.protocol,auth:h.auth,host:h.hostname,port:h.port,path:h.path,method:"GET",headers:g}}class s extends F{constructor(g){super(g);const o=S=>{if(S.statusCode===404){const E=new r.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=E,this._headersCapability.reject(E);return}this._headersCapability.resolve(),this._setReadableStream(S);const R=E=>this._readableStream.headers[E.toLowerCase()],{allowRangeRequests:P,suggestedLength:p}=(0,u.validateRangeRequestCapabilities)({getResponseHeader:R,isHttp:g.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=P,this._contentLength=p||this._contentLength,this._filename=(0,u.extractFilenameFromHeader)(R)};if(this._request=null,this._url.protocol==="http:"){const S=require$$5;this._request=S.request(t(this._url,g.httpHeaders),o)}else{const S=require$$5;this._request=S.request(t(this._url,g.httpHeaders),o)}this._request.on("error",S=>{this._storedError=S,this._headersCapability.reject(S)}),this._request.end()}}class c extends i{constructor(g,o,S){super(g),this._httpHeaders={};for(const P in g.httpHeaders){const p=g.httpHeaders[P];p!==void 0&&(this._httpHeaders[P]=p)}this._httpHeaders.Range=`bytes=${o}-${S-1}`;const R=P=>{if(P.statusCode===404){const p=new r.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=p;return}this._setReadableStream(P)};if(this._request=null,this._url.protocol==="http:"){const P=require$$5;this._request=P.request(t(this._url,this._httpHeaders),R)}else{const P=require$$5;this._request=P.request(t(this._url,this._httpHeaders),R)}this._request.on("error",P=>{this._storedError=P}),this._request.end()}}class l extends F{constructor(g){super(g);let o=decodeURIComponent(this._url.path);w.test(this._url.href)&&(o=o.replace(/^\//,""));const S=require$$5;S.lstat(o,(R,P)=>{if(R){R.code==="ENOENT"&&(R=new r.MissingPDFException(`Missing PDF "${o}".`)),this._storedError=R,this._headersCapability.reject(R);return}this._contentLength=P.size,this._setReadableStream(S.createReadStream(o)),this._headersCapability.resolve()})}}class e extends i{constructor(g,o,S){super(g);let R=decodeURIComponent(this._url.path);w.test(this._url.href)&&(R=R.replace(/^\//,""));const P=require$$5;this._setReadableStream(P.createReadStream(R,{start:o,end:S-1}))}}},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SVGGraphics=void 0;var r=_(6),u=_(1);const w={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},T="http://www.w3.org/XML/1998/namespace",N="http://www.w3.org/1999/xlink",F=["butt","round","square"],i=["miter","round","bevel"],t=function(P,p="",E=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!E)return URL.createObjectURL(new Blob([P],{type:p}));const j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let U=`data:${p};base64,`;for(let I=0,G=P.length;I<G;I+=3){const H=P[I]&255,nt=P[I+1]&255,Q=P[I+2]&255,Z=H>>2,it=(H&3)<<4|nt>>4,K=I+1<G?(nt&15)<<2|Q>>6:64,L=I+2<G?Q&63:64;U+=j[Z]+j[it]+j[K]+j[L]}return U},s=function(){const P=new Uint8Array([137,80,78,71,13,10,26,10]),p=12,E=new Int32Array(256);for(let Q=0;Q<256;Q++){let Z=Q;for(let it=0;it<8;it++)Z=Z&1?3988292384^Z>>1&2147483647:Z>>1&2147483647;E[Q]=Z}function j(Q,Z,it){let K=-1;for(let L=Z;L<it;L++){const b=(K^Q[L])&255,d=E[b];K=K>>>8^d}return K^-1}function U(Q,Z,it,K){let L=K;const b=Z.length;it[L]=b>>24&255,it[L+1]=b>>16&255,it[L+2]=b>>8&255,it[L+3]=b&255,L+=4,it[L]=Q.charCodeAt(0)&255,it[L+1]=Q.charCodeAt(1)&255,it[L+2]=Q.charCodeAt(2)&255,it[L+3]=Q.charCodeAt(3)&255,L+=4,it.set(Z,L),L+=Z.length;const d=j(it,K+4,L);it[L]=d>>24&255,it[L+1]=d>>16&255,it[L+2]=d>>8&255,it[L+3]=d&255}function I(Q,Z,it){let K=1,L=0;for(let b=Z;b<it;++b)K=(K+(Q[b]&255))%65521,L=(L+K)%65521;return L<<16|K}function G(Q){if(!u.isNodeJS)return H(Q);try{const Z=parseInt(process.versions.node)>=8?Q:Buffer.from(Q),it=require$$5.deflateSync(Z,{level:9});return it instanceof Uint8Array?it:new Uint8Array(it)}catch(Z){(0,u.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Z)}return H(Q)}function H(Q){let Z=Q.length;const it=65535,K=Math.ceil(Z/it),L=new Uint8Array(2+Z+K*5+4);let b=0;L[b++]=120,L[b++]=156;let d=0;for(;Z>it;)L[b++]=0,L[b++]=255,L[b++]=255,L[b++]=0,L[b++]=0,L.set(Q.subarray(d,d+it),b),b+=it,d+=it,Z-=it;L[b++]=1,L[b++]=Z&255,L[b++]=Z>>8&255,L[b++]=~Z&65535&255,L[b++]=(~Z&65535)>>8&255,L.set(Q.subarray(d),b),b+=Q.length-d;const f=I(Q,0,Q.length);return L[b++]=f>>24&255,L[b++]=f>>16&255,L[b++]=f>>8&255,L[b++]=f&255,L}function nt(Q,Z,it,K){const L=Q.width,b=Q.height;let d,f,y;const M=Q.data;switch(Z){case u.ImageKind.GRAYSCALE_1BPP:f=0,d=1,y=L+7>>3;break;case u.ImageKind.RGB_24BPP:f=2,d=8,y=L*3;break;case u.ImageKind.RGBA_32BPP:f=6,d=8,y=L*4;break;default:throw new Error("invalid format")}const D=new Uint8Array((1+y)*b);let B=0,C=0;for(let O=0;O<b;++O)D[B++]=0,D.set(M.subarray(C,C+y),B),C+=y,B+=y;if(Z===u.ImageKind.GRAYSCALE_1BPP&&K){B=0;for(let O=0;O<b;O++){B++;for(let W=0;W<y;W++)D[B++]^=255}}const a=new Uint8Array([L>>24&255,L>>16&255,L>>8&255,L&255,b>>24&255,b>>16&255,b>>8&255,b&255,d,f,0,0,0]),m=G(D),v=P.length+p*3+a.length+m.length,x=new Uint8Array(v);let k=0;return x.set(P,k),k+=P.length,U("IHDR",a,x,k),k+=p+a.length,U("IDATA",m,x,k),k+=p+m.length,U("IEND",new Uint8Array(0),x,k),t(x,"image/png",it)}return function(Z,it,K){const L=Z.kind===void 0?u.ImageKind.GRAYSCALE_1BPP:Z.kind;return nt(Z,L,it,K)}}();class c{constructor(){this.fontSizeScale=1,this.fontWeight=w.fontWeight,this.fontSize=0,this.textMatrix=u.IDENTITY_MATRIX,this.fontMatrix=u.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=u.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=w.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(p,E){this.x=p,this.y=E}}function l(P){let p=[];const E=[];for(const j of P){if(j.fn==="save"){p.push({fnId:92,fn:"group",items:[]}),E.push(p),p=p.at(-1).items;continue}j.fn==="restore"?p=E.pop():p.push(j)}return p}function e(P){if(Number.isInteger(P))return P.toString();const p=P.toFixed(10);let E=p.length-1;if(p[E]!=="0")return p;do E--;while(p[E]==="0");return p.substring(0,p[E]==="."?E:E+1)}function h(P){if(P[4]===0&&P[5]===0){if(P[1]===0&&P[2]===0)return P[0]===1&&P[3]===1?"":`scale(${e(P[0])} ${e(P[3])})`;if(P[0]===P[3]&&P[1]===-P[2]){const p=Math.acos(P[0])*180/Math.PI;return`rotate(${e(p)})`}}else if(P[0]===1&&P[1]===0&&P[2]===0&&P[3]===1)return`translate(${e(P[4])} ${e(P[5])})`;return`matrix(${e(P[0])} ${e(P[1])} ${e(P[2])} ${e(P[3])} ${e(P[4])} ${e(P[5])})`}let g=0,o=0,S=0;class R{constructor(p,E,j=!1){(0,r.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new r.DOMSVGFactory,this.current=new c,this.transformMatrix=u.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=p,this.objs=E,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!j,this._operatorIdMapping=[];for(const U in u.OPS)this._operatorIdMapping[u.OPS[U]]=U}getObject(p,E=null){return typeof p=="string"?p.startsWith("g_")?this.commonObjs.get(p):this.objs.get(p):E}save(){this.transformStack.push(this.transformMatrix);const p=this.current;this.extraStack.push(p),this.current=p.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(p){this.save(),this.executeOpTree(p),this.restore()}loadDependencies(p){const E=p.fnArray,j=p.argsArray;for(let U=0,I=E.length;U<I;U++)if(E[U]===u.OPS.dependency)for(const G of j[U]){const H=G.startsWith("g_")?this.commonObjs:this.objs,nt=new Promise(Q=>{H.get(G,Q)});this.current.dependencies.push(nt)}return Promise.all(this.current.dependencies)}transform(p,E,j,U,I,G){const H=[p,E,j,U,I,G];this.transformMatrix=u.Util.transform(this.transformMatrix,H),this.tgrp=null}getSVG(p,E){this.viewport=E;const j=this._initialize(E);return this.loadDependencies(p).then(()=>(this.transformMatrix=u.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(p)),j))}convertOpList(p){const E=this._operatorIdMapping,j=p.argsArray,U=p.fnArray,I=[];for(let G=0,H=U.length;G<H;G++){const nt=U[G];I.push({fnId:nt,fn:E[nt],args:j[G]})}return l(I)}executeOpTree(p){for(const E of p){const j=E.fn,U=E.fnId,I=E.args;switch(U|0){case u.OPS.beginText:this.beginText();break;case u.OPS.dependency:break;case u.OPS.setLeading:this.setLeading(I);break;case u.OPS.setLeadingMoveText:this.setLeadingMoveText(I[0],I[1]);break;case u.OPS.setFont:this.setFont(I);break;case u.OPS.showText:this.showText(I[0]);break;case u.OPS.showSpacedText:this.showText(I[0]);break;case u.OPS.endText:this.endText();break;case u.OPS.moveText:this.moveText(I[0],I[1]);break;case u.OPS.setCharSpacing:this.setCharSpacing(I[0]);break;case u.OPS.setWordSpacing:this.setWordSpacing(I[0]);break;case u.OPS.setHScale:this.setHScale(I[0]);break;case u.OPS.setTextMatrix:this.setTextMatrix(I[0],I[1],I[2],I[3],I[4],I[5]);break;case u.OPS.setTextRise:this.setTextRise(I[0]);break;case u.OPS.setTextRenderingMode:this.setTextRenderingMode(I[0]);break;case u.OPS.setLineWidth:this.setLineWidth(I[0]);break;case u.OPS.setLineJoin:this.setLineJoin(I[0]);break;case u.OPS.setLineCap:this.setLineCap(I[0]);break;case u.OPS.setMiterLimit:this.setMiterLimit(I[0]);break;case u.OPS.setFillRGBColor:this.setFillRGBColor(I[0],I[1],I[2]);break;case u.OPS.setStrokeRGBColor:this.setStrokeRGBColor(I[0],I[1],I[2]);break;case u.OPS.setStrokeColorN:this.setStrokeColorN(I);break;case u.OPS.setFillColorN:this.setFillColorN(I);break;case u.OPS.shadingFill:this.shadingFill(I[0]);break;case u.OPS.setDash:this.setDash(I[0],I[1]);break;case u.OPS.setRenderingIntent:this.setRenderingIntent(I[0]);break;case u.OPS.setFlatness:this.setFlatness(I[0]);break;case u.OPS.setGState:this.setGState(I[0]);break;case u.OPS.fill:this.fill();break;case u.OPS.eoFill:this.eoFill();break;case u.OPS.stroke:this.stroke();break;case u.OPS.fillStroke:this.fillStroke();break;case u.OPS.eoFillStroke:this.eoFillStroke();break;case u.OPS.clip:this.clip("nonzero");break;case u.OPS.eoClip:this.clip("evenodd");break;case u.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case u.OPS.paintImageXObject:this.paintImageXObject(I[0]);break;case u.OPS.paintInlineImageXObject:this.paintInlineImageXObject(I[0]);break;case u.OPS.paintImageMaskXObject:this.paintImageMaskXObject(I[0]);break;case u.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(I[0],I[1]);break;case u.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case u.OPS.closePath:this.closePath();break;case u.OPS.closeStroke:this.closeStroke();break;case u.OPS.closeFillStroke:this.closeFillStroke();break;case u.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case u.OPS.nextLine:this.nextLine();break;case u.OPS.transform:this.transform(I[0],I[1],I[2],I[3],I[4],I[5]);break;case u.OPS.constructPath:this.constructPath(I[0],I[1]);break;case u.OPS.endPath:this.endPath();break;case 92:this.group(E.items);break;default:(0,u.warn)(`Unimplemented operator ${j}`);break}}}setWordSpacing(p){this.current.wordSpacing=p}setCharSpacing(p){this.current.charSpacing=p}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(p,E,j,U,I,G){const H=this.current;H.textMatrix=H.lineMatrix=[p,E,j,U,I,G],H.textMatrixScale=Math.hypot(p,E),H.x=H.lineX=0,H.y=H.lineY=0,H.xcoords=[],H.ycoords=[],H.tspan=this.svgFactory.createElement("svg:tspan"),H.tspan.setAttributeNS(null,"font-family",H.fontFamily),H.tspan.setAttributeNS(null,"font-size",`${e(H.fontSize)}px`),H.tspan.setAttributeNS(null,"y",e(-H.y)),H.txtElement=this.svgFactory.createElement("svg:text"),H.txtElement.append(H.tspan)}beginText(){const p=this.current;p.x=p.lineX=0,p.y=p.lineY=0,p.textMatrix=u.IDENTITY_MATRIX,p.lineMatrix=u.IDENTITY_MATRIX,p.textMatrixScale=1,p.tspan=this.svgFactory.createElement("svg:tspan"),p.txtElement=this.svgFactory.createElement("svg:text"),p.txtgrp=this.svgFactory.createElement("svg:g"),p.xcoords=[],p.ycoords=[]}moveText(p,E){const j=this.current;j.x=j.lineX+=p,j.y=j.lineY+=E,j.xcoords=[],j.ycoords=[],j.tspan=this.svgFactory.createElement("svg:tspan"),j.tspan.setAttributeNS(null,"font-family",j.fontFamily),j.tspan.setAttributeNS(null,"font-size",`${e(j.fontSize)}px`),j.tspan.setAttributeNS(null,"y",e(-j.y))}showText(p){const E=this.current,j=E.font,U=E.fontSize;if(U===0)return;const I=E.fontSizeScale,G=E.charSpacing,H=E.wordSpacing,nt=E.fontDirection,Q=E.textHScale*nt,Z=j.vertical,it=Z?1:-1,K=j.defaultVMetrics,L=U*E.fontMatrix[0];let b=0;for(const y of p){if(y===null){b+=nt*H;continue}else if(typeof y=="number"){b+=it*y*U/1e3;continue}const M=(y.isSpace?H:0)+G,D=y.fontChar;let B,C,a=y.width;if(Z){let v;const x=y.vmetric||K;v=y.vmetric?x[1]:a*.5,v=-v*L;const k=x[2]*L;a=x?-x[0]:a,B=v/I,C=(b+k)/I}else B=b/I,C=0;(y.isInFont||j.missingFile)&&(E.xcoords.push(E.x+B),Z&&E.ycoords.push(-E.y+C),E.tspan.textContent+=D);const m=Z?a*L-M*nt:a*L+M*nt;b+=m}E.tspan.setAttributeNS(null,"x",E.xcoords.map(e).join(" ")),Z?E.tspan.setAttributeNS(null,"y",E.ycoords.map(e).join(" ")):E.tspan.setAttributeNS(null,"y",e(-E.y)),Z?E.y-=b:E.x+=b*Q,E.tspan.setAttributeNS(null,"font-family",E.fontFamily),E.tspan.setAttributeNS(null,"font-size",`${e(E.fontSize)}px`),E.fontStyle!==w.fontStyle&&E.tspan.setAttributeNS(null,"font-style",E.fontStyle),E.fontWeight!==w.fontWeight&&E.tspan.setAttributeNS(null,"font-weight",E.fontWeight);const d=E.textRenderingMode&u.TextRenderingMode.FILL_STROKE_MASK;if(d===u.TextRenderingMode.FILL||d===u.TextRenderingMode.FILL_STROKE?(E.fillColor!==w.fillColor&&E.tspan.setAttributeNS(null,"fill",E.fillColor),E.fillAlpha<1&&E.tspan.setAttributeNS(null,"fill-opacity",E.fillAlpha)):E.textRenderingMode===u.TextRenderingMode.ADD_TO_PATH?E.tspan.setAttributeNS(null,"fill","transparent"):E.tspan.setAttributeNS(null,"fill","none"),d===u.TextRenderingMode.STROKE||d===u.TextRenderingMode.FILL_STROKE){const y=1/(E.textMatrixScale||1);this._setStrokeAttributes(E.tspan,y)}let f=E.textMatrix;E.textRise!==0&&(f=f.slice(),f[5]+=E.textRise),E.txtElement.setAttributeNS(null,"transform",`${h(f)} scale(${e(Q)}, -1)`),E.txtElement.setAttributeNS(T,"xml:space","preserve"),E.txtElement.append(E.tspan),E.txtgrp.append(E.txtElement),this._ensureTransformGroup().append(E.txtElement)}setLeadingMoveText(p,E){this.setLeading(-E),this.moveText(p,E)}addFontStyle(p){if(!p.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const E=t(p.data,p.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${p.loadedName}"; src: url(${E}); }
`}setFont(p){const E=this.current,j=this.commonObjs.get(p[0]);let U=p[1];E.font=j,this.embedFonts&&!j.missingFile&&!this.embeddedFonts[j.loadedName]&&(this.addFontStyle(j),this.embeddedFonts[j.loadedName]=j),E.fontMatrix=j.fontMatrix||u.FONT_IDENTITY_MATRIX;let I="normal";j.black?I="900":j.bold&&(I="bold");const G=j.italic?"italic":"normal";U<0?(U=-U,E.fontDirection=-1):E.fontDirection=1,E.fontSize=U,E.fontFamily=j.loadedName,E.fontWeight=I,E.fontStyle=G,E.tspan=this.svgFactory.createElement("svg:tspan"),E.tspan.setAttributeNS(null,"y",e(-E.y)),E.xcoords=[],E.ycoords=[]}endText(){const p=this.current;p.textRenderingMode&u.TextRenderingMode.ADD_TO_PATH_FLAG&&p.txtElement?.hasChildNodes()&&(p.element=p.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(p){p>0&&(this.current.lineWidth=p)}setLineCap(p){this.current.lineCap=F[p]}setLineJoin(p){this.current.lineJoin=i[p]}setMiterLimit(p){this.current.miterLimit=p}setStrokeAlpha(p){this.current.strokeAlpha=p}setStrokeRGBColor(p,E,j){this.current.strokeColor=u.Util.makeHexColor(p,E,j)}setFillAlpha(p){this.current.fillAlpha=p}setFillRGBColor(p,E,j){this.current.fillColor=u.Util.makeHexColor(p,E,j),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(p){this.current.strokeColor=this._makeColorN_Pattern(p)}setFillColorN(p){this.current.fillColor=this._makeColorN_Pattern(p)}shadingFill(p){const{width:E,height:j}=this.viewport,U=u.Util.inverseTransform(this.transformMatrix),[I,G,H,nt]=u.Util.getAxialAlignedBoundingBox([0,0,E,j],U),Q=this.svgFactory.createElement("svg:rect");Q.setAttributeNS(null,"x",I),Q.setAttributeNS(null,"y",G),Q.setAttributeNS(null,"width",H-I),Q.setAttributeNS(null,"height",nt-G),Q.setAttributeNS(null,"fill",this._makeShadingPattern(p)),this.current.fillAlpha<1&&Q.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Q)}_makeColorN_Pattern(p){return p[0]==="TilingPattern"?this._makeTilingPattern(p):this._makeShadingPattern(p)}_makeTilingPattern(p){const E=p[1],j=p[2],U=p[3]||u.IDENTITY_MATRIX,[I,G,H,nt]=p[4],Q=p[5],Z=p[6],it=p[7],K=`shading${S++}`,[L,b,d,f]=u.Util.normalizeRect([...u.Util.applyTransform([I,G],U),...u.Util.applyTransform([H,nt],U)]),[y,M]=u.Util.singularValueDecompose2dScale(U),D=Q*y,B=Z*M,C=this.svgFactory.createElement("svg:pattern");C.setAttributeNS(null,"id",K),C.setAttributeNS(null,"patternUnits","userSpaceOnUse"),C.setAttributeNS(null,"width",D),C.setAttributeNS(null,"height",B),C.setAttributeNS(null,"x",`${L}`),C.setAttributeNS(null,"y",`${b}`);const a=this.svg,m=this.transformMatrix,v=this.current.fillColor,x=this.current.strokeColor,k=this.svgFactory.create(d-L,f-b);if(this.svg=k,this.transformMatrix=U,it===2){const O=u.Util.makeHexColor(...E);this.current.fillColor=O,this.current.strokeColor=O}return this.executeOpTree(this.convertOpList(j)),this.svg=a,this.transformMatrix=m,this.current.fillColor=v,this.current.strokeColor=x,C.append(k.childNodes[0]),this.defs.append(C),`url(#${K})`}_makeShadingPattern(p){switch(typeof p=="string"&&(p=this.objs.get(p)),p[0]){case"RadialAxial":const E=`shading${S++}`,j=p[3];let U;switch(p[1]){case"axial":const I=p[4],G=p[5];U=this.svgFactory.createElement("svg:linearGradient"),U.setAttributeNS(null,"id",E),U.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),U.setAttributeNS(null,"x1",I[0]),U.setAttributeNS(null,"y1",I[1]),U.setAttributeNS(null,"x2",G[0]),U.setAttributeNS(null,"y2",G[1]);break;case"radial":const H=p[4],nt=p[5],Q=p[6],Z=p[7];U=this.svgFactory.createElement("svg:radialGradient"),U.setAttributeNS(null,"id",E),U.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),U.setAttributeNS(null,"cx",nt[0]),U.setAttributeNS(null,"cy",nt[1]),U.setAttributeNS(null,"r",Z),U.setAttributeNS(null,"fx",H[0]),U.setAttributeNS(null,"fy",H[1]),U.setAttributeNS(null,"fr",Q);break;default:throw new Error(`Unknown RadialAxial type: ${p[1]}`)}for(const I of j){const G=this.svgFactory.createElement("svg:stop");G.setAttributeNS(null,"offset",I[0]),G.setAttributeNS(null,"stop-color",I[1]),U.append(G)}return this.defs.append(U),`url(#${E})`;case"Mesh":return(0,u.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${p[0]}`)}}setDash(p,E){this.current.dashArray=p,this.current.dashPhase=E}constructPath(p,E){const j=this.current;let U=j.x,I=j.y,G=[],H=0;for(const nt of p)switch(nt|0){case u.OPS.rectangle:U=E[H++],I=E[H++];const Q=E[H++],Z=E[H++],it=U+Q,K=I+Z;G.push("M",e(U),e(I),"L",e(it),e(I),"L",e(it),e(K),"L",e(U),e(K),"Z");break;case u.OPS.moveTo:U=E[H++],I=E[H++],G.push("M",e(U),e(I));break;case u.OPS.lineTo:U=E[H++],I=E[H++],G.push("L",e(U),e(I));break;case u.OPS.curveTo:U=E[H+4],I=E[H+5],G.push("C",e(E[H]),e(E[H+1]),e(E[H+2]),e(E[H+3]),e(U),e(I)),H+=6;break;case u.OPS.curveTo2:G.push("C",e(U),e(I),e(E[H]),e(E[H+1]),e(E[H+2]),e(E[H+3])),U=E[H+2],I=E[H+3],H+=4;break;case u.OPS.curveTo3:U=E[H+2],I=E[H+3],G.push("C",e(E[H]),e(E[H+1]),e(U),e(I),e(U),e(I)),H+=4;break;case u.OPS.closePath:G.push("Z");break}G=G.join(" "),j.path&&p.length>0&&p[0]!==u.OPS.rectangle&&p[0]!==u.OPS.moveTo?G=j.path.getAttributeNS(null,"d")+G:(j.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(j.path)),j.path.setAttributeNS(null,"d",G),j.path.setAttributeNS(null,"fill","none"),j.element=j.path,j.setCurrentPoint(U,I)}endPath(){const p=this.current;if(p.path=null,!this.pendingClip)return;if(!p.element){this.pendingClip=null;return}const E=`clippath${g++}`,j=this.svgFactory.createElement("svg:clipPath");j.setAttributeNS(null,"id",E),j.setAttributeNS(null,"transform",h(this.transformMatrix));const U=p.element.cloneNode(!0);if(this.pendingClip==="evenodd"?U.setAttributeNS(null,"clip-rule","evenodd"):U.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,j.append(U),this.defs.append(j),p.activeClipUrl){p.clipGroup=null;for(const I of this.extraStack)I.clipGroup=null;j.setAttributeNS(null,"clip-path",p.activeClipUrl)}p.activeClipUrl=`url(#${E})`,this.tgrp=null}clip(p){this.pendingClip=p}closePath(){const p=this.current;if(p.path){const E=`${p.path.getAttributeNS(null,"d")}Z`;p.path.setAttributeNS(null,"d",E)}}setLeading(p){this.current.leading=-p}setTextRise(p){this.current.textRise=p}setTextRenderingMode(p){this.current.textRenderingMode=p}setHScale(p){this.current.textHScale=p/100}setRenderingIntent(p){}setFlatness(p){}setGState(p){for(const[E,j]of p)switch(E){case"LW":this.setLineWidth(j);break;case"LC":this.setLineCap(j);break;case"LJ":this.setLineJoin(j);break;case"ML":this.setMiterLimit(j);break;case"D":this.setDash(j[0],j[1]);break;case"RI":this.setRenderingIntent(j);break;case"FL":this.setFlatness(j);break;case"Font":this.setFont(j);break;case"CA":this.setStrokeAlpha(j);break;case"ca":this.setFillAlpha(j);break;default:(0,u.warn)(`Unimplemented graphic state operator ${E}`);break}}fill(){const p=this.current;p.element&&(p.element.setAttributeNS(null,"fill",p.fillColor),p.element.setAttributeNS(null,"fill-opacity",p.fillAlpha),this.endPath())}stroke(){const p=this.current;p.element&&(this._setStrokeAttributes(p.element),p.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(p,E=1){const j=this.current;let U=j.dashArray;E!==1&&U.length>0&&(U=U.map(function(I){return E*I})),p.setAttributeNS(null,"stroke",j.strokeColor),p.setAttributeNS(null,"stroke-opacity",j.strokeAlpha),p.setAttributeNS(null,"stroke-miterlimit",e(j.miterLimit)),p.setAttributeNS(null,"stroke-linecap",j.lineCap),p.setAttributeNS(null,"stroke-linejoin",j.lineJoin),p.setAttributeNS(null,"stroke-width",e(E*j.lineWidth)+"px"),p.setAttributeNS(null,"stroke-dasharray",U.map(e).join(" ")),p.setAttributeNS(null,"stroke-dashoffset",e(E*j.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const p=this.svgFactory.createElement("svg:rect");p.setAttributeNS(null,"x","0"),p.setAttributeNS(null,"y","0"),p.setAttributeNS(null,"width","1px"),p.setAttributeNS(null,"height","1px"),p.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(p)}paintImageXObject(p){const E=this.getObject(p);if(!E){(0,u.warn)(`Dependent image with object ID ${p} is not ready yet`);return}this.paintInlineImageXObject(E)}paintInlineImageXObject(p,E){const j=p.width,U=p.height,I=s(p,this.forceDataSchema,!!E),G=this.svgFactory.createElement("svg:rect");G.setAttributeNS(null,"x","0"),G.setAttributeNS(null,"y","0"),G.setAttributeNS(null,"width",e(j)),G.setAttributeNS(null,"height",e(U)),this.current.element=G,this.clip("nonzero");const H=this.svgFactory.createElement("svg:image");H.setAttributeNS(N,"xlink:href",I),H.setAttributeNS(null,"x","0"),H.setAttributeNS(null,"y",e(-U)),H.setAttributeNS(null,"width",e(j)+"px"),H.setAttributeNS(null,"height",e(U)+"px"),H.setAttributeNS(null,"transform",`scale(${e(1/j)} ${e(-1/U)})`),E?E.append(H):this._ensureTransformGroup().append(H)}paintImageMaskXObject(p){const E=this.getObject(p.data,p);if(E.bitmap){(0,u.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const j=this.current,U=E.width,I=E.height,G=j.fillColor;j.maskId=`mask${o++}`;const H=this.svgFactory.createElement("svg:mask");H.setAttributeNS(null,"id",j.maskId);const nt=this.svgFactory.createElement("svg:rect");nt.setAttributeNS(null,"x","0"),nt.setAttributeNS(null,"y","0"),nt.setAttributeNS(null,"width",e(U)),nt.setAttributeNS(null,"height",e(I)),nt.setAttributeNS(null,"fill",G),nt.setAttributeNS(null,"mask",`url(#${j.maskId})`),this.defs.append(H),this._ensureTransformGroup().append(nt),this.paintInlineImageXObject(E,H)}paintFormXObjectBegin(p,E){if(Array.isArray(p)&&p.length===6&&this.transform(p[0],p[1],p[2],p[3],p[4],p[5]),E){const j=E[2]-E[0],U=E[3]-E[1],I=this.svgFactory.createElement("svg:rect");I.setAttributeNS(null,"x",E[0]),I.setAttributeNS(null,"y",E[1]),I.setAttributeNS(null,"width",e(j)),I.setAttributeNS(null,"height",e(U)),this.current.element=I,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(p){const E=this.svgFactory.create(p.width,p.height),j=this.svgFactory.createElement("svg:defs");E.append(j),this.defs=j;const U=this.svgFactory.createElement("svg:g");return U.setAttributeNS(null,"transform",h(p.transform)),E.append(U),this.svg=U,E}_ensureClipGroup(){if(!this.current.clipGroup){const p=this.svgFactory.createElement("svg:g");p.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(p),this.current.clipGroup=p}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",h(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}n.SVGGraphics=R},(A,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaText=void 0;class _{static textContent(u){const w=[],T={items:w,styles:Object.create(null)};function N(F){if(!F)return;let i=null;const t=F.name;if(t==="#text")i=F.value;else if(_.shouldBuildText(t))F?.attributes?.textContent?i=F.attributes.textContent:F.value&&(i=F.value);else return;if(i!==null&&w.push({str:i}),!!F.children)for(const s of F.children)N(s)}return N(u),T}static shouldBuildText(u){return!(u==="textarea"||u==="input"||u==="option"||u==="select")}}n.XfaText=_},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.TextLayerRenderTask=void 0,n.renderTextLayer=h,n.updateTextLayer=g;var r=_(1),u=_(6);const w=1e5,T=30,N=.8,F=new Map;function i(o,S){let R;if(S&&r.FeatureTest.isOffscreenCanvasSupported)R=new OffscreenCanvas(o,o).getContext("2d",{alpha:!1});else{const P=document.createElement("canvas");P.width=P.height=o,R=P.getContext("2d",{alpha:!1})}return R}function t(o,S){const R=F.get(o);if(R)return R;const P=i(T,S);P.font=`${T}px ${o}`;const p=P.measureText("");let E=p.fontBoundingBoxAscent,j=Math.abs(p.fontBoundingBoxDescent);if(E){const I=E/(E+j);return F.set(o,I),P.canvas.width=P.canvas.height=0,I}P.strokeStyle="red",P.clearRect(0,0,T,T),P.strokeText("g",0,0);let U=P.getImageData(0,0,T,T).data;j=0;for(let I=U.length-1-3;I>=0;I-=4)if(U[I]>0){j=Math.ceil(I/4/T);break}P.clearRect(0,0,T,T),P.strokeText("A",0,T),U=P.getImageData(0,0,T,T).data,E=0;for(let I=0,G=U.length;I<G;I+=4)if(U[I]>0){E=T-Math.floor(I/4/T);break}if(P.canvas.width=P.canvas.height=0,E){const I=E/(E+j);return F.set(o,I),I}return F.set(o,N),N}function s(o,S,R){const P=document.createElement("span"),p={angle:0,canvasWidth:0,hasText:S.str!=="",hasEOL:S.hasEOL,fontSize:0};o._textDivs.push(P);const E=r.Util.transform(o._transform,S.transform);let j=Math.atan2(E[1],E[0]);const U=R[S.fontName];U.vertical&&(j+=Math.PI/2);const I=Math.hypot(E[2],E[3]),G=I*t(U.fontFamily,o._isOffscreenCanvasSupported);let H,nt;j===0?(H=E[4],nt=E[5]-G):(H=E[4]+G*Math.sin(j),nt=E[5]-G*Math.cos(j));const Q="calc(var(--scale-factor)*",Z=P.style;o._container===o._rootContainer?(Z.left=`${(100*H/o._pageWidth).toFixed(2)}%`,Z.top=`${(100*nt/o._pageHeight).toFixed(2)}%`):(Z.left=`${Q}${H.toFixed(2)}px)`,Z.top=`${Q}${nt.toFixed(2)}px)`),Z.fontSize=`${Q}${I.toFixed(2)}px)`,Z.fontFamily=U.fontFamily,p.fontSize=I,P.setAttribute("role","presentation"),P.textContent=S.str,P.dir=S.dir,o._fontInspectorEnabled&&(P.dataset.fontName=S.fontName),j!==0&&(p.angle=j*(180/Math.PI));let it=!1;if(S.str.length>1)it=!0;else if(S.str!==" "&&S.transform[0]!==S.transform[3]){const K=Math.abs(S.transform[0]),L=Math.abs(S.transform[3]);K!==L&&Math.max(K,L)/Math.min(K,L)>1.5&&(it=!0)}it&&(p.canvasWidth=U.vertical?S.height:S.width),o._textDivProperties.set(P,p),o._isReadableStream&&o._layoutText(P)}function c(o){const{div:S,scale:R,properties:P,ctx:p,prevFontSize:E,prevFontFamily:j}=o,{style:U}=S;let I="";if(P.canvasWidth!==0&&P.hasText){const{fontFamily:G}=U,{canvasWidth:H,fontSize:nt}=P;(E!==nt||j!==G)&&(p.font=`${nt*R}px ${G}`,o.prevFontSize=nt,o.prevFontFamily=G);const{width:Q}=p.measureText(S.textContent);Q>0&&(I=`scaleX(${H*R/Q})`)}P.angle!==0&&(I=`rotate(${P.angle}deg) ${I}`),I.length>0&&(U.transform=I)}function l(o){if(o._canceled)return;const S=o._textDivs,R=o._capability;if(S.length>w){R.resolve();return}if(!o._isReadableStream)for(const p of S)o._layoutText(p);R.resolve()}class e{constructor({textContentSource:S,container:R,viewport:P,textDivs:p,textDivProperties:E,textContentItemsStr:j,isOffscreenCanvasSupported:U}){this._textContentSource=S,this._isReadableStream=S instanceof ReadableStream,this._container=this._rootContainer=R,this._textDivs=p||[],this._textContentItemsStr=j||[],this._isOffscreenCanvasSupported=U,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=E||new WeakMap,this._canceled=!1,this._capability=new r.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:P.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:i(0,U)};const{pageWidth:I,pageHeight:G,pageX:H,pageY:nt}=P.rawDims;this._transform=[1,0,0,-1,-H,nt+G],this._pageWidth=I,this._pageHeight=G,(0,u.setLayerDimensions)(R,P),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new r.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new r.AbortException("TextLayer task cancelled."))}_processItems(S,R){for(const P of S){if(P.str===void 0){if(P.type==="beginMarkedContentProps"||P.type==="beginMarkedContent"){const p=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),P.id!==null&&this._container.setAttribute("id",`${P.id}`),p.append(this._container)}else P.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(P.str),s(this,P,R)}}_layoutText(S){const R=this._layoutTextParams.properties=this._textDivProperties.get(S);if(this._layoutTextParams.div=S,c(this._layoutTextParams),R.hasText&&this._container.append(S),R.hasEOL){const P=document.createElement("br");P.setAttribute("role","presentation"),this._container.append(P)}}_render(){const S=new r.PromiseCapability;let R=Object.create(null);if(this._isReadableStream){const P=()=>{this._reader.read().then(({value:p,done:E})=>{if(E){S.resolve();return}Object.assign(R,p.styles),this._processItems(p.items,R),P()},S.reject)};this._reader=this._textContentSource.getReader(),P()}else if(this._textContentSource){const{items:P,styles:p}=this._textContentSource;this._processItems(P,p),S.resolve()}else throw new Error('No "textContentSource" parameter specified.');S.promise.then(()=>{R=null,l(this)},this._capability.reject)}}n.TextLayerRenderTask=e;function h(o){!o.textContentSource&&(o.textContent||o.textContentStream)&&((0,u.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),o.textContentSource=o.textContent||o.textContentStream);const{container:S,viewport:R}=o,P=getComputedStyle(S),p=P.getPropertyValue("visibility"),E=parseFloat(P.getPropertyValue("--scale-factor"));p==="visible"&&(!E||Math.abs(E-R.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const j=new e(o);return j._render(),j}function g({container:o,viewport:S,textDivs:R,textDivProperties:P,isOffscreenCanvasSupported:p,mustRotate:E=!0,mustRescale:j=!0}){if(E&&(0,u.setLayerDimensions)(o,{rotation:S.rotation}),j){const U=i(0,p),G={prevFontSize:null,prevFontFamily:null,div:null,scale:S.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:U};for(const H of R)G.properties=P.get(H),G.div=H,c(G)}}},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationEditorLayer=void 0;var r=_(1),u=_(4),w=_(28),T=_(33),N=_(6),F=_(34);class i{#t;#e=!1;#n=null;#s=this.pointerup.bind(this);#o=this.pointerdown.bind(this);#a=new Map;#r=!1;#l=!1;#c=!1;#i;static _initialized=!1;constructor({uiManager:s,pageIndex:c,div:l,accessibilityManager:e,annotationLayer:h,viewport:g,l10n:o}){const S=[w.FreeTextEditor,T.InkEditor,F.StampEditor];if(!i._initialized){i._initialized=!0;for(const R of S)R.initialize(o)}s.registerEditorTypes(S),this.#i=s,this.pageIndex=c,this.div=l,this.#t=e,this.#n=h,this.viewport=g,this.#i.addLayer(this)}get isEmpty(){return this.#a.size===0}updateToolbar(s){this.#i.updateToolbar(s)}updateMode(s=this.#i.getMode()){this.#p(),s===r.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),s!==r.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",s===r.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",s===r.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",s===r.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(s){if(!s&&this.#i.getMode()!==r.AnnotationEditorType.INK)return;if(!s){for(const l of this.#a.values())if(l.isEmpty()){l.setInBackground();return}}this.#d({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(s){this.#i.setEditingState(s)}addCommands(s){this.#i.addCommands(s)}enable(){this.div.style.pointerEvents="auto";const s=new Set;for(const l of this.#a.values())l.enableEditing(),l.annotationElementId&&s.add(l.annotationElementId);if(!this.#n)return;const c=this.#n.getEditableAnnotations();for(const l of c){if(l.hide(),this.#i.isDeletedAnnotationElement(l.data.id)||s.has(l.data.id))continue;const e=this.deserialize(l);e&&(this.addOrRebuild(e),e.enableEditing())}}disable(){this.#c=!0,this.div.style.pointerEvents="none";const s=new Set;for(const c of this.#a.values()){if(c.disableEditing(),!c.annotationElementId||c.serialize()!==null){s.add(c.annotationElementId);continue}this.getEditableAnnotation(c.annotationElementId)?.show(),c.remove()}if(this.#n){const c=this.#n.getEditableAnnotations();for(const l of c){const{id:e}=l.data;s.has(e)||this.#i.isDeletedAnnotationElement(e)||l.show()}}this.#p(),this.isEmpty&&(this.div.hidden=!0),this.#c=!1}getEditableAnnotation(s){return this.#n?.getEditableAnnotation(s)||null}setActiveEditor(s){this.#i.getActive()!==s&&this.#i.setActiveEditor(s)}enableClick(){this.div.addEventListener("pointerdown",this.#o),this.div.addEventListener("pointerup",this.#s)}disableClick(){this.div.removeEventListener("pointerdown",this.#o),this.div.removeEventListener("pointerup",this.#s)}attach(s){this.#a.set(s.id,s);const{annotationElementId:c}=s;c&&this.#i.isDeletedAnnotationElement(c)&&this.#i.removeDeletedAnnotationElement(s)}detach(s){this.#a.delete(s.id),this.#t?.removePointerInTextLayer(s.contentDiv),!this.#c&&s.annotationElementId&&this.#i.addDeletedAnnotationElement(s)}remove(s){this.detach(s),this.#i.removeEditor(s),s.div.contains(document.activeElement)&&setTimeout(()=>{this.#i.focusMainContainer()},0),s.div.remove(),s.isAttachedToDOM=!1,this.#l||this.addInkEditorIfNeeded(!1)}changeParent(s){s.parent!==this&&(s.annotationElementId&&(this.#i.addDeletedAnnotationElement(s.annotationElementId),u.AnnotationEditor.deleteAnnotationElement(s),s.annotationElementId=null),this.attach(s),s.parent?.detach(s),s.setParent(this),s.div&&s.isAttachedToDOM&&(s.div.remove(),this.div.append(s.div)))}add(s){if(this.changeParent(s),this.#i.addEditor(s),this.attach(s),!s.isAttachedToDOM){const c=s.render();this.div.append(c),s.isAttachedToDOM=!0}s.fixAndSetPosition(),s.onceAdded(),this.#i.addToAnnotationStorage(s)}moveEditorInDOM(s){if(!s.isAttachedToDOM)return;const{activeElement:c}=document;s.div.contains(c)&&(s._focusEventsAllowed=!1,setTimeout(()=>{s.div.contains(document.activeElement)?s._focusEventsAllowed=!0:(s.div.addEventListener("focusin",()=>{s._focusEventsAllowed=!0},{once:!0}),c.focus())},0)),s._structTreeParentId=this.#t?.moveElementInDOM(this.div,s.div,s.contentDiv,!0)}addOrRebuild(s){s.needsToBeRebuilt()?s.rebuild():this.add(s)}addUndoableEditor(s){const c=()=>s._uiManager.rebuild(s),l=()=>{s.remove()};this.addCommands({cmd:c,undo:l,mustExec:!1})}getNextId(){return this.#i.getId()}#f(s){switch(this.#i.getMode()){case r.AnnotationEditorType.FREETEXT:return new w.FreeTextEditor(s);case r.AnnotationEditorType.INK:return new T.InkEditor(s);case r.AnnotationEditorType.STAMP:return new F.StampEditor(s)}return null}pasteEditor(s,c){this.#i.updateToolbar(s),this.#i.updateMode(s);const{offsetX:l,offsetY:e}=this.#u(),h=this.getNextId(),g=this.#f({parent:this,id:h,x:l,y:e,uiManager:this.#i,isCentered:!0,...c});g&&this.add(g)}deserialize(s){switch(s.annotationType??s.annotationEditorType){case r.AnnotationEditorType.FREETEXT:return w.FreeTextEditor.deserialize(s,this,this.#i);case r.AnnotationEditorType.INK:return T.InkEditor.deserialize(s,this,this.#i);case r.AnnotationEditorType.STAMP:return F.StampEditor.deserialize(s,this,this.#i)}return null}#d(s,c){const l=this.getNextId(),e=this.#f({parent:this,id:l,x:s.offsetX,y:s.offsetY,uiManager:this.#i,isCentered:c});return e&&this.add(e),e}#u(){const{x:s,y:c,width:l,height:e}=this.div.getBoundingClientRect(),h=Math.max(0,s),g=Math.max(0,c),o=Math.min(window.innerWidth,s+l),S=Math.min(window.innerHeight,c+e),R=(h+o)/2-s,P=(g+S)/2-c,[p,E]=this.viewport.rotation%180===0?[R,P]:[P,R];return{offsetX:p,offsetY:E}}addNewEditor(){this.#d(this.#u(),!0)}setSelected(s){this.#i.setSelected(s)}toggleSelected(s){this.#i.toggleSelected(s)}isSelected(s){return this.#i.isSelected(s)}unselect(s){this.#i.unselect(s)}pointerup(s){const{isMac:c}=r.FeatureTest.platform;if(!(s.button!==0||s.ctrlKey&&c)&&s.target===this.div&&this.#r){if(this.#r=!1,!this.#e){this.#e=!0;return}if(this.#i.getMode()===r.AnnotationEditorType.STAMP){this.#i.unselectAll();return}this.#d(s,!1)}}pointerdown(s){if(this.#r){this.#r=!1;return}const{isMac:c}=r.FeatureTest.platform;if(s.button!==0||s.ctrlKey&&c||s.target!==this.div)return;this.#r=!0;const l=this.#i.getActive();this.#e=!l||l.isEmpty()}findNewParent(s,c,l){const e=this.#i.findParent(c,l);return e===null||e===this?!1:(e.changeParent(s),!0)}destroy(){this.#i.getActive()?.parent===this&&(this.#i.commitOrRemove(),this.#i.setActiveEditor(null));for(const s of this.#a.values())this.#t?.removePointerInTextLayer(s.contentDiv),s.setParent(null),s.isAttachedToDOM=!1,s.div.remove();this.div=null,this.#a.clear(),this.#i.removeLayer(this)}#p(){this.#l=!0;for(const s of this.#a.values())s.isEmpty()&&s.remove();this.#l=!1}render({viewport:s}){this.viewport=s,(0,N.setLayerDimensions)(this.div,s);for(const c of this.#i.getEditors(this.pageIndex))this.add(c);this.updateMode()}update({viewport:s}){this.#i.commitOrRemove(),this.viewport=s,(0,N.setLayerDimensions)(this.div,{rotation:s.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:s,pageHeight:c}=this.viewport.rawDims;return[s,c]}}n.AnnotationEditorLayer=i},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FreeTextEditor=void 0;var r=_(1),u=_(5),w=_(4),T=_(29);class N extends w.AnnotationEditor{#t=this.editorDivBlur.bind(this);#e=this.editorDivFocus.bind(this);#n=this.editorDivInput.bind(this);#s=this.editorDivKeydown.bind(this);#o;#a="";#r=`${this.id}-editor`;#l;#c=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const i=N.prototype,t=l=>l.isEmpty(),s=u.AnnotationEditorUIManager.TRANSLATE_SMALL,c=u.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,r.shadow)(this,"_keyboardManager",new u.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],i.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],i.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],i._translateEmpty,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],i._translateEmpty,{args:[-c,0],checker:t}],[["ArrowRight","mac+ArrowRight"],i._translateEmpty,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],i._translateEmpty,{args:[c,0],checker:t}],[["ArrowUp","mac+ArrowUp"],i._translateEmpty,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],i._translateEmpty,{args:[0,-c],checker:t}],[["ArrowDown","mac+ArrowDown"],i._translateEmpty,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],i._translateEmpty,{args:[0,c],checker:t}]]))}static _type="freetext";constructor(i){super({...i,name:"freeTextEditor"}),this.#o=i.color||N._defaultColor||w.AnnotationEditor._defaultLineColor,this.#l=i.fontSize||N._defaultFontSize}static initialize(i){w.AnnotationEditor.initialize(i,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const t=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(t.getPropertyValue("--freetext-padding"))}static updateDefaultParams(i,t){switch(i){case r.AnnotationEditorParamsType.FREETEXT_SIZE:N._defaultFontSize=t;break;case r.AnnotationEditorParamsType.FREETEXT_COLOR:N._defaultColor=t;break}}updateParams(i,t){switch(i){case r.AnnotationEditorParamsType.FREETEXT_SIZE:this.#i(t);break;case r.AnnotationEditorParamsType.FREETEXT_COLOR:this.#f(t);break}}static get defaultPropertiesToUpdate(){return[[r.AnnotationEditorParamsType.FREETEXT_SIZE,N._defaultFontSize],[r.AnnotationEditorParamsType.FREETEXT_COLOR,N._defaultColor||w.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[r.AnnotationEditorParamsType.FREETEXT_SIZE,this.#l],[r.AnnotationEditorParamsType.FREETEXT_COLOR,this.#o]]}#i(i){const t=c=>{this.editorDiv.style.fontSize=`calc(${c}px * var(--scale-factor))`,this.translate(0,-(c-this.#l)*this.parentScale),this.#l=c,this.#u()},s=this.#l;this.addCommands({cmd:()=>{t(i)},undo:()=>{t(s)},mustExec:!0,type:r.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#f(i){const t=this.#o;this.addCommands({cmd:()=>{this.#o=this.editorDiv.style.color=i},undo:()=>{this.#o=this.editorDiv.style.color=t},mustExec:!0,type:r.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(i,t){this._uiManager.translateSelectedEditors(i,t,!0)}getInitialTranslation(){const i=this.parentScale;return[-N._internalPadding*i,-(N._internalPadding+this.#l)*i]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(r.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#s),this.editorDiv.addEventListener("focus",this.#e),this.editorDiv.addEventListener("blur",this.#t),this.editorDiv.addEventListener("input",this.#n))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#r),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",this.#s),this.editorDiv.removeEventListener("focus",this.#e),this.editorDiv.removeEventListener("blur",this.#t),this.editorDiv.removeEventListener("input",this.#n),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(i){this._focusEventsAllowed&&(super.focusin(i),i.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){if(this.width){this.#m();return}this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}#d(){const i=this.editorDiv.getElementsByTagName("div");if(i.length===0)return this.editorDiv.innerText;const t=[];for(const s of i)t.push(s.innerText.replace(/\r\n?|\n/,""));return t.join(`
`)}#u(){const[i,t]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:c,div:l}=this,e=l.style.display;l.style.display="hidden",c.div.append(this.div),s=l.getBoundingClientRect(),l.remove(),l.style.display=e}this.rotation%180===this.parentRotation%180?(this.width=s.width/i,this.height=s.height/t):(this.width=s.height/i,this.height=s.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const i=this.#a,t=this.#a=this.#d().trimEnd();if(i===t)return;const s=c=>{if(this.#a=c,!c){this.remove();return}this.#p(),this._uiManager.rebuild(this),this.#u()};this.addCommands({cmd:()=>{s(t)},undo:()=>{s(i)},mustExec:!1}),this.#u()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(i){this.enterInEditMode()}keydown(i){i.target===this.div&&i.key==="Enter"&&(this.enterInEditMode(),i.preventDefault())}editorDivKeydown(i){N._keyboardManager.exec(this,i)}editorDivFocus(i){this.isEditing=!0}editorDivBlur(i){this.isEditing=!1}editorDivInput(i){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let i,t;this.width&&(i=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#r),this.enableEditing(),w.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(c=>this.editorDiv?.setAttribute("aria-label",c)),w.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(c=>this.editorDiv?.setAttribute("default-content",c)),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#l}px * var(--scale-factor))`,s.color=this.#o,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,u.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[c,l]=this.parentDimensions;if(this.annotationElementId){const{position:e}=this.#c;let[h,g]=this.getInitialTranslation();[h,g]=this.pageTranslationToScreen(h,g);const[o,S]=this.pageDimensions,[R,P]=this.pageTranslation;let p,E;switch(this.rotation){case 0:p=i+(e[0]-R)/o,E=t+this.height-(e[1]-P)/S;break;case 90:p=i+(e[0]-R)/o,E=t-(e[1]-P)/S,[h,g]=[g,-h];break;case 180:p=i-this.width+(e[0]-R)/o,E=t-(e[1]-P)/S,[h,g]=[-h,-g];break;case 270:p=i+(e[0]-R-this.height*S)/o,E=t+(e[1]-P-this.width*o)/S,[h,g]=[-g,h];break}this.setAt(p*c,E*l,h,g)}else this.setAt(i*c,t*l,this.width*c,this.height*l);this.#p(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}#p(){if(this.editorDiv.replaceChildren(),!!this.#a)for(const i of this.#a.split(`
`)){const t=document.createElement("div");t.append(i?document.createTextNode(i):document.createElement("br")),this.editorDiv.append(t)}}get contentDiv(){return this.editorDiv}static deserialize(i,t,s){let c=null;if(i instanceof T.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:e,fontColor:h},rect:g,rotation:o,id:S},textContent:R,textPosition:P,parent:{page:{pageNumber:p}}}=i;if(!R||R.length===0)return null;c=i={annotationType:r.AnnotationEditorType.FREETEXT,color:Array.from(h),fontSize:e,value:R.join(`
`),position:P,pageIndex:p-1,rect:g,rotation:o,id:S,deleted:!1}}const l=super.deserialize(i,t,s);return l.#l=i.fontSize,l.#o=r.Util.makeHexColor(...i.color),l.#a=i.value,l.annotationElementId=i.id||null,l.#c=c,l}serialize(i=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const t=N._internalPadding*this.parentScale,s=this.getRect(t,t),c=w.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#o),l={annotationType:r.AnnotationEditorType.FREETEXT,color:c,fontSize:this.#l,value:this.#a,pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return i?l:this.annotationElementId&&!this.#b(l)?null:(l.id=this.annotationElementId,l)}#b(i){const{value:t,fontSize:s,color:c,rect:l,pageIndex:e}=this.#c;return i.value!==t||i.fontSize!==s||i.rect.some((h,g)=>Math.abs(h-l[g])>=1)||i.color.some((h,g)=>h!==c[g])||i.pageIndex!==e}#m(i=!1){if(!this.annotationElementId)return;if(this.#u(),!i&&(this.width===0||this.height===0)){setTimeout(()=>this.#m(!0),0);return}const t=N._internalPadding*this.parentScale;this.#c.rect=this.getRect(t,t)}}n.FreeTextEditor=N},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.StampAnnotationElement=n.InkAnnotationElement=n.FreeTextAnnotationElement=n.AnnotationLayer=void 0;var r=_(1),u=_(6),w=_(3),T=_(30),N=_(31),F=_(32);const i=1e3,t=9,s=new WeakSet;function c(C){return{width:C[2]-C[0],height:C[3]-C[1]}}class l{static create(a){switch(a.data.annotationType){case r.AnnotationType.LINK:return new h(a);case r.AnnotationType.TEXT:return new g(a);case r.AnnotationType.WIDGET:switch(a.data.fieldType){case"Tx":return new S(a);case"Btn":return a.data.radioButton?new p(a):a.data.checkBox?new P(a):new E(a);case"Ch":return new j(a);case"Sig":return new R(a)}return new o(a);case r.AnnotationType.POPUP:return new U(a);case r.AnnotationType.FREETEXT:return new G(a);case r.AnnotationType.LINE:return new H(a);case r.AnnotationType.SQUARE:return new nt(a);case r.AnnotationType.CIRCLE:return new Q(a);case r.AnnotationType.POLYLINE:return new Z(a);case r.AnnotationType.CARET:return new K(a);case r.AnnotationType.INK:return new L(a);case r.AnnotationType.POLYGON:return new it(a);case r.AnnotationType.HIGHLIGHT:return new b(a);case r.AnnotationType.UNDERLINE:return new d(a);case r.AnnotationType.SQUIGGLY:return new f(a);case r.AnnotationType.STRIKEOUT:return new y(a);case r.AnnotationType.STAMP:return new M(a);case r.AnnotationType.FILEATTACHMENT:return new D(a);default:return new e(a)}}}class e{#t=!1;constructor(a,{isRenderable:m=!1,ignoreBorder:v=!1,createQuadrilaterals:x=!1}={}){this.isRenderable=m,this.data=a.data,this.layer=a.layer,this.linkService=a.linkService,this.downloadManager=a.downloadManager,this.imageResourcesPath=a.imageResourcesPath,this.renderForms=a.renderForms,this.svgFactory=a.svgFactory,this.annotationStorage=a.annotationStorage,this.enableScripting=a.enableScripting,this.hasJSActions=a.hasJSActions,this._fieldObjects=a.fieldObjects,this.parent=a.parent,m&&(this.container=this._createContainer(v)),x&&this._createQuadrilaterals()}static _hasPopupData({titleObj:a,contentsObj:m,richText:v}){return!!(a?.str||m?.str||v?.str)}get hasPopupData(){return e._hasPopupData(this.data)}_createContainer(a){const{data:m,parent:{page:v,viewport:x}}=this,k=document.createElement("section");k.setAttribute("data-annotation-id",m.id),this instanceof o||(k.tabIndex=i),k.style.zIndex=this.parent.zIndex++,this.data.popupRef&&k.setAttribute("aria-haspopup","dialog"),m.noRotate&&k.classList.add("norotate");const{pageWidth:O,pageHeight:W,pageX:z,pageY:st}=x.rawDims;if(!m.rect||this instanceof U){const{rotation:tt}=m;return!m.hasOwnCanvas&&tt!==0&&this.setRotation(tt,k),k}const{width:q,height:X}=c(m.rect),Y=r.Util.normalizeRect([m.rect[0],v.view[3]-m.rect[1]+v.view[1],m.rect[2],v.view[3]-m.rect[3]+v.view[1]]);if(!a&&m.borderStyle.width>0){k.style.borderWidth=`${m.borderStyle.width}px`;const tt=m.borderStyle.horizontalCornerRadius,rt=m.borderStyle.verticalCornerRadius;if(tt>0||rt>0){const lt=`calc(${tt}px * var(--scale-factor)) / calc(${rt}px * var(--scale-factor))`;k.style.borderRadius=lt}else if(this instanceof p){const lt=`calc(${q}px * var(--scale-factor)) / calc(${X}px * var(--scale-factor))`;k.style.borderRadius=lt}switch(m.borderStyle.style){case r.AnnotationBorderStyleType.SOLID:k.style.borderStyle="solid";break;case r.AnnotationBorderStyleType.DASHED:k.style.borderStyle="dashed";break;case r.AnnotationBorderStyleType.BEVELED:(0,r.warn)("Unimplemented border style: beveled");break;case r.AnnotationBorderStyleType.INSET:(0,r.warn)("Unimplemented border style: inset");break;case r.AnnotationBorderStyleType.UNDERLINE:k.style.borderBottomStyle="solid";break}const ot=m.borderColor||null;ot?(this.#t=!0,k.style.borderColor=r.Util.makeHexColor(ot[0]|0,ot[1]|0,ot[2]|0)):k.style.borderWidth=0}k.style.left=`${100*(Y[0]-z)/O}%`,k.style.top=`${100*(Y[1]-st)/W}%`;const{rotation:J}=m;return m.hasOwnCanvas||J===0?(k.style.width=`${100*q/O}%`,k.style.height=`${100*X/W}%`):this.setRotation(J,k),k}setRotation(a,m=this.container){if(!this.data.rect)return;const{pageWidth:v,pageHeight:x}=this.parent.viewport.rawDims,{width:k,height:O}=c(this.data.rect);let W,z;a%180===0?(W=100*k/v,z=100*O/x):(W=100*O/v,z=100*k/x),m.style.width=`${W}%`,m.style.height=`${z}%`,m.setAttribute("data-main-rotation",(360-a)%360)}get _commonActions(){const a=(m,v,x)=>{const k=x.detail[m],O=k[0],W=k.slice(1);x.target.style[v]=T.ColorConverters[`${O}_HTML`](W),this.annotationStorage.setValue(this.data.id,{[v]:T.ColorConverters[`${O}_rgb`](W)})};return(0,r.shadow)(this,"_commonActions",{display:m=>{const{display:v}=m.detail,x=v%2===1;this.container.style.visibility=x?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:x,noPrint:v===1||v===2})},print:m=>{this.annotationStorage.setValue(this.data.id,{noPrint:!m.detail.print})},hidden:m=>{const{hidden:v}=m.detail;this.container.style.visibility=v?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:v,noView:v})},focus:m=>{setTimeout(()=>m.target.focus({preventScroll:!1}),0)},userName:m=>{m.target.title=m.detail.userName},readonly:m=>{m.target.disabled=m.detail.readonly},required:m=>{this._setRequired(m.target,m.detail.required)},bgColor:m=>{a("bgColor","backgroundColor",m)},fillColor:m=>{a("fillColor","backgroundColor",m)},fgColor:m=>{a("fgColor","color",m)},textColor:m=>{a("textColor","color",m)},borderColor:m=>{a("borderColor","borderColor",m)},strokeColor:m=>{a("strokeColor","borderColor",m)},rotation:m=>{const v=m.detail.rotation;this.setRotation(v),this.annotationStorage.setValue(this.data.id,{rotation:v})}})}_dispatchEventFromSandbox(a,m){const v=this._commonActions;for(const x of Object.keys(m.detail))(a[x]||v[x])?.(m)}_setDefaultPropertiesFromJS(a){if(!this.enableScripting)return;const m=this.annotationStorage.getRawValue(this.data.id);if(!m)return;const v=this._commonActions;for(const[x,k]of Object.entries(m)){const O=v[x];if(O){const W={detail:{[x]:k},target:a};O(W),delete m[x]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:a}=this.data;if(!a)return;const[m,v,x,k]=this.data.rect;if(a.length===1){const[,{x:rt,y:ot},{x:lt,y:ct}]=a[0];if(x===rt&&k===ot&&m===lt&&v===ct)return}const{style:O}=this.container;let W;if(this.#t){const{borderColor:rt,borderWidth:ot}=O;O.borderWidth=0,W=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${rt}" stroke-width="${ot}">`],this.container.classList.add("hasBorder")}const z=x-m,st=k-v,{svgFactory:q}=this,X=q.createElement("svg");X.classList.add("quadrilateralsContainer"),X.setAttribute("width",0),X.setAttribute("height",0);const Y=q.createElement("defs");X.append(Y);const J=q.createElement("clipPath"),tt=`clippath_${this.data.id}`;J.setAttribute("id",tt),J.setAttribute("clipPathUnits","objectBoundingBox"),Y.append(J);for(const[,{x:rt,y:ot},{x:lt,y:ct}]of a){const ht=q.createElement("rect"),dt=(lt-m)/z,_t=(k-ot)/st,pt=(rt-lt)/z,Et=(ot-ct)/st;ht.setAttribute("x",dt),ht.setAttribute("y",_t),ht.setAttribute("width",pt),ht.setAttribute("height",Et),J.append(ht),W?.push(`<rect vector-effect="non-scaling-stroke" x="${dt}" y="${_t}" width="${pt}" height="${Et}"/>`)}this.#t&&(W.push("</g></svg>')"),O.backgroundImage=W.join("")),this.container.append(X),this.container.style.clipPath=`url(#${tt})`}_createPopup(){const{container:a,data:m}=this;a.setAttribute("aria-haspopup","dialog");const v=new U({data:{color:m.color,titleObj:m.titleObj,modificationDate:m.modificationDate,contentsObj:m.contentsObj,richText:m.richText,parentRect:m.rect,borderStyle:0,id:`popup_${m.id}`,rotation:m.rotation},parent:this.parent,elements:[this]});this.parent.div.append(v.render())}render(){(0,r.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(a,m=null){const v=[];if(this._fieldObjects){const x=this._fieldObjects[a];if(x)for(const{page:k,id:O,exportValues:W}of x){if(k===-1||O===m)continue;const z=typeof W=="string"?W:null,st=document.querySelector(`[data-element-id="${O}"]`);if(st&&!s.has(st)){(0,r.warn)(`_getElementsByName - element not allowed: ${O}`);continue}v.push({id:O,exportValue:z,domElement:st})}return v}for(const x of document.getElementsByName(a)){const{exportValue:k}=x,O=x.getAttribute("data-element-id");O!==m&&s.has(x)&&v.push({id:O,exportValue:k,domElement:x})}return v}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const a=this.getElementsToTriggerPopup();if(Array.isArray(a))for(const m of a)m.classList.add("highlightArea");else a.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:a,data:{id:m}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:a,editId:m})})}}class h extends e{constructor(a,m=null){super(a,{isRenderable:!0,ignoreBorder:!!m?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=a.data.isTooltipOnly}render(){const{data:a,linkService:m}=this,v=document.createElement("a");v.setAttribute("data-element-id",a.id);let x=!1;return a.url?(m.addLinkAttributes(v,a.url,a.newWindow),x=!0):a.action?(this._bindNamedAction(v,a.action),x=!0):a.attachment?(this._bindAttachment(v,a.attachment),x=!0):a.setOCGState?(this.#e(v,a.setOCGState),x=!0):a.dest?(this._bindLink(v,a.dest),x=!0):(a.actions&&(a.actions.Action||a.actions["Mouse Up"]||a.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(v,a),x=!0),a.resetForm?(this._bindResetFormAction(v,a.resetForm),x=!0):this.isTooltipOnly&&!x&&(this._bindLink(v,""),x=!0)),this.container.classList.add("linkAnnotation"),x&&this.container.append(v),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(a,m){a.href=this.linkService.getDestinationHash(m),a.onclick=()=>(m&&this.linkService.goToDestination(m),!1),(m||m==="")&&this.#t()}_bindNamedAction(a,m){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.linkService.executeNamedAction(m),!1),this.#t()}_bindAttachment(a,m){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,m.content,m.filename),!1),this.#t()}#e(a,m){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.linkService.executeSetOCGState(m),!1),this.#t()}_bindJSAction(a,m){a.href=this.linkService.getAnchorUrl("");const v=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const x of Object.keys(m.actions)){const k=v.get(x);k&&(a[k]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:m.id,name:x}}),!1))}a.onclick||(a.onclick=()=>!1),this.#t()}_bindResetFormAction(a,m){const v=a.onclick;if(v||(a.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){(0,r.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),v||(a.onclick=()=>!1);return}a.onclick=()=>{v?.();const{fields:x,refs:k,include:O}=m,W=[];if(x.length!==0||k.length!==0){const q=new Set(k);for(const X of x){const Y=this._fieldObjects[X]||[];for(const{id:J}of Y)q.add(J)}for(const X of Object.values(this._fieldObjects))for(const Y of X)q.has(Y.id)===O&&W.push(Y)}else for(const q of Object.values(this._fieldObjects))W.push(...q);const z=this.annotationStorage,st=[];for(const q of W){const{id:X}=q;switch(st.push(X),q.type){case"text":{const J=q.defaultValue||"";z.setValue(X,{value:J});break}case"checkbox":case"radiobutton":{const J=q.defaultValue===q.exportValues;z.setValue(X,{value:J});break}case"combobox":case"listbox":{const J=q.defaultValue||"";z.setValue(X,{value:J});break}default:continue}const Y=document.querySelector(`[data-element-id="${X}"]`);if(Y){if(!s.has(Y)){(0,r.warn)(`_bindResetFormAction - element not allowed: ${X}`);continue}}else continue;Y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:st,name:"ResetForm"}}),!1}}}class g extends e{constructor(a){super(a,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const a=document.createElement("img");return a.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",a.alt="[{{type}} Annotation]",a.dataset.l10nId="text_annotation_type",a.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(a),this.container}}class o extends e{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(a){this.data.hasOwnCanvas&&(a.previousSibling?.nodeName==="CANVAS"&&(a.previousSibling.hidden=!0),a.hidden=!1)}_getKeyModifier(a){const{isWin:m,isMac:v}=r.FeatureTest.platform;return m&&a.ctrlKey||v&&a.metaKey}_setEventListener(a,m,v,x,k){v.includes("mouse")?a.addEventListener(v,O=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:x,value:k(O),shift:O.shiftKey,modifier:this._getKeyModifier(O)}})}):a.addEventListener(v,O=>{if(v==="blur"){if(!m.focused||!O.relatedTarget)return;m.focused=!1}else if(v==="focus"){if(m.focused)return;m.focused=!0}k&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:x,value:k(O)}})})}_setEventListeners(a,m,v,x){for(const[k,O]of v)(O==="Action"||this.data.actions?.[O])&&((O==="Focus"||O==="Blur")&&(m||={focused:!1}),this._setEventListener(a,m,k,O,x),O==="Focus"&&!this.data.actions?.Blur?this._setEventListener(a,m,"blur","Blur",null):O==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(a,m,"focus","Focus",null))}_setBackgroundColor(a){const m=this.data.backgroundColor||null;a.style.backgroundColor=m===null?"transparent":r.Util.makeHexColor(m[0],m[1],m[2])}_setTextStyle(a){const m=["left","center","right"],{fontColor:v}=this.data.defaultAppearanceData,x=this.data.defaultAppearanceData.fontSize||t,k=a.style;let O;const W=2,z=st=>Math.round(10*st)/10;if(this.data.multiLine){const st=Math.abs(this.data.rect[3]-this.data.rect[1]-W),q=Math.round(st/(r.LINE_FACTOR*x))||1,X=st/q;O=Math.min(x,z(X/r.LINE_FACTOR))}else{const st=Math.abs(this.data.rect[3]-this.data.rect[1]-W);O=Math.min(x,z(st/r.LINE_FACTOR))}k.fontSize=`calc(${O}px * var(--scale-factor))`,k.color=r.Util.makeHexColor(v[0],v[1],v[2]),this.data.textAlignment!==null&&(k.textAlign=m[this.data.textAlignment])}_setRequired(a,m){m?a.setAttribute("required",!0):a.removeAttribute("required"),a.setAttribute("aria-required",m)}}class S extends o{constructor(a){const m=a.renderForms||!a.data.hasAppearance&&!!a.data.fieldValue;super(a,{isRenderable:m})}setPropertyOnSiblings(a,m,v,x){const k=this.annotationStorage;for(const O of this._getElementsByName(a.name,a.id))O.domElement&&(O.domElement[m]=v),k.setValue(O.id,{[x]:v})}render(){const a=this.annotationStorage,m=this.data.id;this.container.classList.add("textWidgetAnnotation");let v=null;if(this.renderForms){const x=a.getValue(m,{value:this.data.fieldValue});let k=x.value||"";const O=a.getValue(m,{charLimit:this.data.maxLen}).charLimit;O&&k.length>O&&(k=k.slice(0,O));let W=x.formattedValue||this.data.textContent?.join(`
`)||null;W&&this.data.comb&&(W=W.replaceAll(/\s+/g,""));const z={userValue:k,formattedValue:W,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(v=document.createElement("textarea"),v.textContent=W??k,this.data.doNotScroll&&(v.style.overflowY="hidden")):(v=document.createElement("input"),v.type="text",v.setAttribute("value",W??k),this.data.doNotScroll&&(v.style.overflowX="hidden")),this.data.hasOwnCanvas&&(v.hidden=!0),s.add(v),v.setAttribute("data-element-id",m),v.disabled=this.data.readOnly,v.name=this.data.fieldName,v.tabIndex=i,this._setRequired(v,this.data.required),O&&(v.maxLength=O),v.addEventListener("input",q=>{a.setValue(m,{value:q.target.value}),this.setPropertyOnSiblings(v,"value",q.target.value,"value"),z.formattedValue=null}),v.addEventListener("resetform",q=>{const X=this.data.defaultFieldValue??"";v.value=z.userValue=X,z.formattedValue=null});let st=q=>{const{formattedValue:X}=z;X!=null&&(q.target.value=X),q.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){v.addEventListener("focus",X=>{if(z.focused)return;const{target:Y}=X;z.userValue&&(Y.value=z.userValue),z.lastCommittedValue=Y.value,z.commitKey=1,z.focused=!0}),v.addEventListener("updatefromsandbox",X=>{this.showElementAndHideCanvas(X.target);const Y={value(J){z.userValue=J.detail.value??"",a.setValue(m,{value:z.userValue.toString()}),J.target.value=z.userValue},formattedValue(J){const{formattedValue:tt}=J.detail;z.formattedValue=tt,tt!=null&&J.target!==document.activeElement&&(J.target.value=tt),a.setValue(m,{formattedValue:tt})},selRange(J){J.target.setSelectionRange(...J.detail.selRange)},charLimit:J=>{const{charLimit:tt}=J.detail,{target:rt}=J;if(tt===0){rt.removeAttribute("maxLength");return}rt.setAttribute("maxLength",tt);let ot=z.userValue;!ot||ot.length<=tt||(ot=ot.slice(0,tt),rt.value=z.userValue=ot,a.setValue(m,{value:ot}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:m,name:"Keystroke",value:ot,willCommit:!0,commitKey:1,selStart:rt.selectionStart,selEnd:rt.selectionEnd}}))}};this._dispatchEventFromSandbox(Y,X)}),v.addEventListener("keydown",X=>{z.commitKey=1;let Y=-1;if(X.key==="Escape"?Y=0:X.key==="Enter"&&!this.data.multiLine?Y=2:X.key==="Tab"&&(z.commitKey=3),Y===-1)return;const{value:J}=X.target;z.lastCommittedValue!==J&&(z.lastCommittedValue=J,z.userValue=J,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:m,name:"Keystroke",value:J,willCommit:!0,commitKey:Y,selStart:X.target.selectionStart,selEnd:X.target.selectionEnd}}))});const q=st;st=null,v.addEventListener("blur",X=>{if(!z.focused||!X.relatedTarget)return;z.focused=!1;const{value:Y}=X.target;z.userValue=Y,z.lastCommittedValue!==Y&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:m,name:"Keystroke",value:Y,willCommit:!0,commitKey:z.commitKey,selStart:X.target.selectionStart,selEnd:X.target.selectionEnd}}),q(X)}),this.data.actions?.Keystroke&&v.addEventListener("beforeinput",X=>{z.lastCommittedValue=null;const{data:Y,target:J}=X,{value:tt,selectionStart:rt,selectionEnd:ot}=J;let lt=rt,ct=ot;switch(X.inputType){case"deleteWordBackward":{const ht=tt.substring(0,rt).match(/\w*[^\w]*$/);ht&&(lt-=ht[0].length);break}case"deleteWordForward":{const ht=tt.substring(rt).match(/^[^\w]*\w*/);ht&&(ct+=ht[0].length);break}case"deleteContentBackward":rt===ot&&(lt-=1);break;case"deleteContentForward":rt===ot&&(ct+=1);break}X.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:m,name:"Keystroke",value:tt,change:Y||"",willCommit:!1,selStart:lt,selEnd:ct}})}),this._setEventListeners(v,z,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],X=>X.target.value)}if(st&&v.addEventListener("blur",st),this.data.comb){const X=(this.data.rect[2]-this.data.rect[0])/O;v.classList.add("comb"),v.style.letterSpacing=`calc(${X}px * var(--scale-factor) - 1ch)`}}else v=document.createElement("div"),v.textContent=this.data.fieldValue,v.style.verticalAlign="middle",v.style.display="table-cell";return this._setTextStyle(v),this._setBackgroundColor(v),this._setDefaultPropertiesFromJS(v),this.container.append(v),this.container}}class R extends o{constructor(a){super(a,{isRenderable:!!a.data.hasOwnCanvas})}}class P extends o{constructor(a){super(a,{isRenderable:a.renderForms})}render(){const a=this.annotationStorage,m=this.data,v=m.id;let x=a.getValue(v,{value:m.exportValue===m.fieldValue}).value;typeof x=="string"&&(x=x!=="Off",a.setValue(v,{value:x})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const k=document.createElement("input");return s.add(k),k.setAttribute("data-element-id",v),k.disabled=m.readOnly,this._setRequired(k,this.data.required),k.type="checkbox",k.name=m.fieldName,x&&k.setAttribute("checked",!0),k.setAttribute("exportValue",m.exportValue),k.tabIndex=i,k.addEventListener("change",O=>{const{name:W,checked:z}=O.target;for(const st of this._getElementsByName(W,v)){const q=z&&st.exportValue===m.exportValue;st.domElement&&(st.domElement.checked=q),a.setValue(st.id,{value:q})}a.setValue(v,{value:z})}),k.addEventListener("resetform",O=>{const W=m.defaultFieldValue||"Off";O.target.checked=W===m.exportValue}),this.enableScripting&&this.hasJSActions&&(k.addEventListener("updatefromsandbox",O=>{const W={value(z){z.target.checked=z.detail.value!=="Off",a.setValue(v,{value:z.target.checked})}};this._dispatchEventFromSandbox(W,O)}),this._setEventListeners(k,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],O=>O.target.checked)),this._setBackgroundColor(k),this._setDefaultPropertiesFromJS(k),this.container.append(k),this.container}}class p extends o{constructor(a){super(a,{isRenderable:a.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const a=this.annotationStorage,m=this.data,v=m.id;let x=a.getValue(v,{value:m.fieldValue===m.buttonValue}).value;typeof x=="string"&&(x=x!==m.buttonValue,a.setValue(v,{value:x}));const k=document.createElement("input");if(s.add(k),k.setAttribute("data-element-id",v),k.disabled=m.readOnly,this._setRequired(k,this.data.required),k.type="radio",k.name=m.fieldName,x&&k.setAttribute("checked",!0),k.tabIndex=i,k.addEventListener("change",O=>{const{name:W,checked:z}=O.target;for(const st of this._getElementsByName(W,v))a.setValue(st.id,{value:!1});a.setValue(v,{value:z})}),k.addEventListener("resetform",O=>{const W=m.defaultFieldValue;O.target.checked=W!=null&&W===m.buttonValue}),this.enableScripting&&this.hasJSActions){const O=m.buttonValue;k.addEventListener("updatefromsandbox",W=>{const z={value:st=>{const q=O===st.detail.value;for(const X of this._getElementsByName(st.target.name)){const Y=q&&X.id===v;X.domElement&&(X.domElement.checked=Y),a.setValue(X.id,{value:Y})}}};this._dispatchEventFromSandbox(z,W)}),this._setEventListeners(k,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],W=>W.target.checked)}return this._setBackgroundColor(k),this._setDefaultPropertiesFromJS(k),this.container.append(k),this.container}}class E extends h{constructor(a){super(a,{ignoreBorder:a.data.hasAppearance})}render(){const a=super.render();a.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(a.title=this.data.alternativeText);const m=a.lastChild;return this.enableScripting&&this.hasJSActions&&m&&(this._setDefaultPropertiesFromJS(m),m.addEventListener("updatefromsandbox",v=>{this._dispatchEventFromSandbox({},v)})),a}}class j extends o{constructor(a){super(a,{isRenderable:a.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const a=this.annotationStorage,m=this.data.id,v=a.getValue(m,{value:this.data.fieldValue}),x=document.createElement("select");s.add(x),x.setAttribute("data-element-id",m),x.disabled=this.data.readOnly,this._setRequired(x,this.data.required),x.name=this.data.fieldName,x.tabIndex=i;let k=this.data.combo&&this.data.options.length>0;this.data.combo||(x.size=this.data.options.length,this.data.multiSelect&&(x.multiple=!0)),x.addEventListener("resetform",q=>{const X=this.data.defaultFieldValue;for(const Y of x.options)Y.selected=Y.value===X});for(const q of this.data.options){const X=document.createElement("option");X.textContent=q.displayValue,X.value=q.exportValue,v.value.includes(q.exportValue)&&(X.setAttribute("selected",!0),k=!1),x.append(X)}let O=null;if(k){const q=document.createElement("option");q.value=" ",q.setAttribute("hidden",!0),q.setAttribute("selected",!0),x.prepend(q),O=()=>{q.remove(),x.removeEventListener("input",O),O=null},x.addEventListener("input",O)}const W=q=>{const X=q?"value":"textContent",{options:Y,multiple:J}=x;return J?Array.prototype.filter.call(Y,tt=>tt.selected).map(tt=>tt[X]):Y.selectedIndex===-1?null:Y[Y.selectedIndex][X]};let z=W(!1);const st=q=>{const X=q.target.options;return Array.prototype.map.call(X,Y=>({displayValue:Y.textContent,exportValue:Y.value}))};return this.enableScripting&&this.hasJSActions?(x.addEventListener("updatefromsandbox",q=>{const X={value(Y){O?.();const J=Y.detail.value,tt=new Set(Array.isArray(J)?J:[J]);for(const rt of x.options)rt.selected=tt.has(rt.value);a.setValue(m,{value:W(!0)}),z=W(!1)},multipleSelection(Y){x.multiple=!0},remove(Y){const J=x.options,tt=Y.detail.remove;J[tt].selected=!1,x.remove(tt),J.length>0&&Array.prototype.findIndex.call(J,ot=>ot.selected)===-1&&(J[0].selected=!0),a.setValue(m,{value:W(!0),items:st(Y)}),z=W(!1)},clear(Y){for(;x.length!==0;)x.remove(0);a.setValue(m,{value:null,items:[]}),z=W(!1)},insert(Y){const{index:J,displayValue:tt,exportValue:rt}=Y.detail.insert,ot=x.children[J],lt=document.createElement("option");lt.textContent=tt,lt.value=rt,ot?ot.before(lt):x.append(lt),a.setValue(m,{value:W(!0),items:st(Y)}),z=W(!1)},items(Y){const{items:J}=Y.detail;for(;x.length!==0;)x.remove(0);for(const tt of J){const{displayValue:rt,exportValue:ot}=tt,lt=document.createElement("option");lt.textContent=rt,lt.value=ot,x.append(lt)}x.options.length>0&&(x.options[0].selected=!0),a.setValue(m,{value:W(!0),items:st(Y)}),z=W(!1)},indices(Y){const J=new Set(Y.detail.indices);for(const tt of Y.target.options)tt.selected=J.has(tt.index);a.setValue(m,{value:W(!0)}),z=W(!1)},editable(Y){Y.target.disabled=!Y.detail.editable}};this._dispatchEventFromSandbox(X,q)}),x.addEventListener("input",q=>{const X=W(!0);a.setValue(m,{value:X}),q.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:m,name:"Keystroke",value:z,changeEx:X,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(x,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],q=>q.target.value)):x.addEventListener("input",function(q){a.setValue(m,{value:W(!0)})}),this.data.combo&&this._setTextStyle(x),this._setBackgroundColor(x),this._setDefaultPropertiesFromJS(x),this.container.append(x),this.container}}class U extends e{constructor(a){const{data:m,elements:v}=a;super(a,{isRenderable:e._hasPopupData(m)}),this.elements=v}render(){this.container.classList.add("popupAnnotation");const a=new I({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),m=[];for(const v of this.elements)v.popup=a,m.push(v.data.id),v.addHighlightArea();return this.container.setAttribute("aria-controls",m.map(v=>`${r.AnnotationPrefix}${v}`).join(",")),this.container}}class I{#t=null;#e=this.#h.bind(this);#n=this.#E.bind(this);#s=this.#S.bind(this);#o=this.#_.bind(this);#a=null;#r=null;#l=null;#c=null;#i=null;#f=null;#d=!1;#u=null;#p=null;#b=null;#m=null;#g=!1;constructor({container:a,color:m,elements:v,titleObj:x,modificationDate:k,contentsObj:O,richText:W,parent:z,rect:st,parentRect:q,open:X}){this.#r=a,this.#m=x,this.#l=O,this.#b=W,this.#i=z,this.#a=m,this.#p=st,this.#f=q,this.#c=v;const Y=u.PDFDateString.toDateObject(k);Y&&(this.#t=z.l10n.get("annotation_date_string",{date:Y.toLocaleDateString(),time:Y.toLocaleTimeString()})),this.trigger=v.flatMap(J=>J.getElementsToTriggerPopup());for(const J of this.trigger)J.addEventListener("click",this.#o),J.addEventListener("mouseenter",this.#s),J.addEventListener("mouseleave",this.#n),J.classList.add("popupTriggerArea");for(const J of v)J.container?.addEventListener("keydown",this.#e);this.#r.hidden=!0,X&&this.#_()}render(){if(this.#u)return;const{page:{view:a},viewport:{rawDims:{pageWidth:m,pageHeight:v,pageX:x,pageY:k}}}=this.#i,O=this.#u=document.createElement("div");if(O.className="popup",this.#a){const ht=O.style.outlineColor=r.Util.makeHexColor(...this.#a);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?O.style.backgroundColor=`color-mix(in srgb, ${ht} 30%, white)`:O.style.backgroundColor=r.Util.makeHexColor(...this.#a.map(_t=>Math.floor(.7*(255-_t)+_t)))}const W=document.createElement("span");W.className="header";const z=document.createElement("h1");if(W.append(z),{dir:z.dir,str:z.textContent}=this.#m,O.append(W),this.#t){const ht=document.createElement("span");ht.classList.add("popupDate"),this.#t.then(dt=>{ht.textContent=dt}),W.append(ht)}const st=this.#l,q=this.#b;if(q?.str&&(!st?.str||st.str===q.str))F.XfaLayer.render({xfaHtml:q.html,intent:"richText",div:O}),O.lastChild.classList.add("richText","popupContent");else{const ht=this._formatContents(st);O.append(ht)}let X=!!this.#f,Y=X?this.#f:this.#p;for(const ht of this.#c)if(!Y||r.Util.intersect(ht.data.rect,Y)!==null){Y=ht.data.rect,X=!0;break}const J=r.Util.normalizeRect([Y[0],a[3]-Y[1]+a[1],Y[2],a[3]-Y[3]+a[1]]),rt=X?Y[2]-Y[0]+5:0,ot=J[0]+rt,lt=J[1],{style:ct}=this.#r;ct.left=`${100*(ot-x)/m}%`,ct.top=`${100*(lt-k)/v}%`,this.#r.append(O)}_formatContents({str:a,dir:m}){const v=document.createElement("p");v.classList.add("popupContent"),v.dir=m;const x=a.split(/(?:\r\n?|\n)/);for(let k=0,O=x.length;k<O;++k){const W=x[k];v.append(document.createTextNode(W)),k<O-1&&v.append(document.createElement("br"))}return v}#h(a){a.altKey||a.shiftKey||a.ctrlKey||a.metaKey||(a.key==="Enter"||a.key==="Escape"&&this.#d)&&this.#_()}#_(){this.#d=!this.#d,this.#d?(this.#S(),this.#r.addEventListener("click",this.#o),this.#r.addEventListener("keydown",this.#e)):(this.#E(),this.#r.removeEventListener("click",this.#o),this.#r.removeEventListener("keydown",this.#e))}#S(){this.#u||this.render(),this.isVisible?this.#d&&this.#r.classList.add("focused"):(this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#E(){this.#r.classList.remove("focused"),!(this.#d||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#g=this.isVisible,this.#g&&(this.#r.hidden=!0)}maybeShow(){this.#g&&(this.#g=!1,this.#r.hidden=!1)}get isVisible(){return this.#r.hidden===!1}}class G extends e{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0}),this.textContent=a.data.textContent,this.textPosition=a.data.textPosition,this.annotationEditorType=r.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const a=document.createElement("div");a.classList.add("annotationTextContent"),a.setAttribute("role","comment");for(const m of this.textContent){const v=document.createElement("span");v.textContent=m,a.append(v)}this.container.append(a)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}n.FreeTextAnnotationElement=G;class H extends e{#t=null;constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const a=this.data,{width:m,height:v}=c(a.rect),x=this.svgFactory.create(m,v,!0),k=this.#t=this.svgFactory.createElement("svg:line");return k.setAttribute("x1",a.rect[2]-a.lineCoordinates[0]),k.setAttribute("y1",a.rect[3]-a.lineCoordinates[1]),k.setAttribute("x2",a.rect[2]-a.lineCoordinates[2]),k.setAttribute("y2",a.rect[3]-a.lineCoordinates[3]),k.setAttribute("stroke-width",a.borderStyle.width||1),k.setAttribute("stroke","transparent"),k.setAttribute("fill","transparent"),x.append(k),this.container.append(x),!a.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class nt extends e{#t=null;constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const a=this.data,{width:m,height:v}=c(a.rect),x=this.svgFactory.create(m,v,!0),k=a.borderStyle.width,O=this.#t=this.svgFactory.createElement("svg:rect");return O.setAttribute("x",k/2),O.setAttribute("y",k/2),O.setAttribute("width",m-k),O.setAttribute("height",v-k),O.setAttribute("stroke-width",k||1),O.setAttribute("stroke","transparent"),O.setAttribute("fill","transparent"),x.append(O),this.container.append(x),!a.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Q extends e{#t=null;constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const a=this.data,{width:m,height:v}=c(a.rect),x=this.svgFactory.create(m,v,!0),k=a.borderStyle.width,O=this.#t=this.svgFactory.createElement("svg:ellipse");return O.setAttribute("cx",m/2),O.setAttribute("cy",v/2),O.setAttribute("rx",m/2-k/2),O.setAttribute("ry",v/2-k/2),O.setAttribute("stroke-width",k||1),O.setAttribute("stroke","transparent"),O.setAttribute("fill","transparent"),x.append(O),this.container.append(x),!a.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Z extends e{#t=null;constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const a=this.data,{width:m,height:v}=c(a.rect),x=this.svgFactory.create(m,v,!0);let k=[];for(const W of a.vertices){const z=W.x-a.rect[0],st=a.rect[3]-W.y;k.push(z+","+st)}k=k.join(" ");const O=this.#t=this.svgFactory.createElement(this.svgElementName);return O.setAttribute("points",k),O.setAttribute("stroke-width",a.borderStyle.width||1),O.setAttribute("stroke","transparent"),O.setAttribute("fill","transparent"),x.append(O),this.container.append(x),!a.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class it extends Z{constructor(a){super(a),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class K extends e{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class L extends e{#t=[];constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=r.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const a=this.data,{width:m,height:v}=c(a.rect),x=this.svgFactory.create(m,v,!0);for(const k of a.inkLists){let O=[];for(const z of k){const st=z.x-a.rect[0],q=a.rect[3]-z.y;O.push(`${st},${q}`)}O=O.join(" ");const W=this.svgFactory.createElement(this.svgElementName);this.#t.push(W),W.setAttribute("points",O),W.setAttribute("stroke-width",a.borderStyle.width||1),W.setAttribute("stroke","transparent"),W.setAttribute("fill","transparent"),!a.popupRef&&this.hasPopupData&&this._createPopup(),x.append(W)}return this.container.append(x),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}n.InkAnnotationElement=L;class b extends e{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class d extends e{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class f extends e{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class y extends e{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class M extends e{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}n.StampAnnotationElement=M;class D extends e{#t=null;constructor(a){super(a,{isRenderable:!0});const{filename:m,content:v}=this.data.file;this.filename=(0,u.getFilenameFromUrl)(m,!0),this.content=v,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:m,content:v})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:a,data:m}=this;let v;m.hasAppearance||m.fillAlpha===0?v=document.createElement("div"):(v=document.createElement("img"),v.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(m.name)?"paperclip":"pushpin"}.svg`,m.fillAlpha&&m.fillAlpha<1&&(v.style=`filter: opacity(${Math.round(m.fillAlpha*100)}%);`)),v.addEventListener("dblclick",this.#e.bind(this)),this.#t=v;const{isMac:x}=r.FeatureTest.platform;return a.addEventListener("keydown",k=>{k.key==="Enter"&&(x?k.metaKey:k.ctrlKey)&&this.#e()}),!m.popupRef&&this.hasPopupData?this._createPopup():v.classList.add("popupTriggerArea"),a.append(v),a}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class B{#t=null;#e=null;#n=new Map;constructor({div:a,accessibilityManager:m,annotationCanvasMap:v,l10n:x,page:k,viewport:O}){this.div=a,this.#t=m,this.#e=v,this.l10n=x,this.page=k,this.viewport=O,this.zIndex=0,this.l10n||=N.NullL10n}#s(a,m){const v=a.firstChild||a;v.id=`${r.AnnotationPrefix}${m}`,this.div.append(a),this.#t?.moveElementInDOM(this.div,a,v,!1)}async render(a){const{annotations:m}=a,v=this.div;(0,u.setLayerDimensions)(v,this.viewport);const x=new Map,k={data:null,layer:v,linkService:a.linkService,downloadManager:a.downloadManager,imageResourcesPath:a.imageResourcesPath||"",renderForms:a.renderForms!==!1,svgFactory:new u.DOMSVGFactory,annotationStorage:a.annotationStorage||new w.AnnotationStorage,enableScripting:a.enableScripting===!0,hasJSActions:a.hasJSActions,fieldObjects:a.fieldObjects,parent:this,elements:null};for(const O of m){if(O.noHTML)continue;const W=O.annotationType===r.AnnotationType.POPUP;if(W){const q=x.get(O.id);if(!q)continue;k.elements=q}else{const{width:q,height:X}=c(O.rect);if(q<=0||X<=0)continue}k.data=O;const z=l.create(k);if(!z.isRenderable)continue;if(!W&&O.popupRef){const q=x.get(O.popupRef);q?q.push(z):x.set(O.popupRef,[z])}z.annotationEditorType>0&&this.#n.set(z.data.id,z);const st=z.render();O.hidden&&(st.style.visibility="hidden"),this.#s(st,O.id)}this.#o(),await this.l10n.translate(v)}update({viewport:a}){const m=this.div;this.viewport=a,(0,u.setLayerDimensions)(m,{rotation:a.rotation}),this.#o(),m.hidden=!1}#o(){if(!this.#e)return;const a=this.div;for(const[m,v]of this.#e){const x=a.querySelector(`[data-annotation-id="${m}"]`);if(!x)continue;const{firstChild:k}=x;k?k.nodeName==="CANVAS"?k.replaceWith(v):k.before(v):x.append(v)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(a){return this.#n.get(a)}}n.AnnotationLayer=B},(A,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorConverters=void 0;function _(w){return Math.floor(Math.max(0,Math.min(1,w))*255).toString(16).padStart(2,"0")}function r(w){return Math.max(0,Math.min(255,255*w))}class u{static CMYK_G([T,N,F,i]){return["G",1-Math.min(1,.3*T+.59*F+.11*N+i)]}static G_CMYK([T]){return["CMYK",0,0,0,1-T]}static G_RGB([T]){return["RGB",T,T,T]}static G_rgb([T]){return T=r(T),[T,T,T]}static G_HTML([T]){const N=_(T);return`#${N}${N}${N}`}static RGB_G([T,N,F]){return["G",.3*T+.59*N+.11*F]}static RGB_rgb(T){return T.map(r)}static RGB_HTML(T){return`#${T.map(_).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([T,N,F,i]){return["RGB",1-Math.min(1,T+i),1-Math.min(1,F+i),1-Math.min(1,N+i)]}static CMYK_rgb([T,N,F,i]){return[r(1-Math.min(1,T+i)),r(1-Math.min(1,F+i)),r(1-Math.min(1,N+i))]}static CMYK_HTML(T){const N=this.CMYK_RGB(T).slice(1);return this.RGB_HTML(N)}static RGB_CMYK([T,N,F]){const i=1-T,t=1-N,s=1-F,c=Math.min(i,t,s);return["CMYK",i,t,s,c]}}n.ColorConverters=u},(A,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.NullL10n=void 0,n.getL10nFallback=r;const _={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};_.print_progress_percent="{{progress}}%";function r(T,N){switch(T){case"find_match_count":T=`find_match_count[${N.total===1?"one":"other"}]`;break;case"find_match_count_limit":T=`find_match_count_limit[${N.limit===1?"one":"other"}]`;break}return _[T]||""}function u(T,N){return N?T.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(F,i)=>i in N?N[i]:"{{"+i+"}}"):T}const w={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(T,N=null,F=r(T,N)){return u(F,N)},async translate(T){}};n.NullL10n=w},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaLayer=void 0;var r=_(25);class u{static setupStorage(T,N,F,i,t){const s=i.getValue(N,{value:null});switch(F.name){case"textarea":if(s.value!==null&&(T.textContent=s.value),t==="print")break;T.addEventListener("input",c=>{i.setValue(N,{value:c.target.value})});break;case"input":if(F.attributes.type==="radio"||F.attributes.type==="checkbox"){if(s.value===F.attributes.xfaOn?T.setAttribute("checked",!0):s.value===F.attributes.xfaOff&&T.removeAttribute("checked"),t==="print")break;T.addEventListener("change",c=>{i.setValue(N,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(s.value!==null&&T.setAttribute("value",s.value),t==="print")break;T.addEventListener("input",c=>{i.setValue(N,{value:c.target.value})})}break;case"select":if(s.value!==null){T.setAttribute("value",s.value);for(const c of F.children)c.attributes.value===s.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}T.addEventListener("input",c=>{const l=c.target.options,e=l.selectedIndex===-1?"":l[l.selectedIndex].value;i.setValue(N,{value:e})});break}}static setAttributes({html:T,element:N,storage:F=null,intent:i,linkService:t}){const{attributes:s}=N,c=T instanceof HTMLAnchorElement;s.type==="radio"&&(s.name=`${s.name}-${i}`);for(const[l,e]of Object.entries(s))if(e!=null)switch(l){case"class":e.length&&T.setAttribute(l,e.join(" "));break;case"dataId":break;case"id":T.setAttribute("data-element-id",e);break;case"style":Object.assign(T.style,e);break;case"textContent":T.textContent=e;break;default:(!c||l!=="href"&&l!=="newWindow")&&T.setAttribute(l,e)}c&&t.addLinkAttributes(T,s.href,s.newWindow),F&&s.dataId&&this.setupStorage(T,s.dataId,N,F)}static render(T){const N=T.annotationStorage,F=T.linkService,i=T.xfaHtml,t=T.intent||"display",s=document.createElement(i.name);i.attributes&&this.setAttributes({html:s,element:i,intent:t,linkService:F});const c=[[i,-1,s]],l=T.div;if(l.append(s),T.viewport){const h=`matrix(${T.viewport.transform.join(",")})`;l.style.transform=h}t!=="richText"&&l.setAttribute("class","xfaLayer xfaFont");const e=[];for(;c.length>0;){const[h,g,o]=c.at(-1);if(g+1===h.children.length){c.pop();continue}const S=h.children[++c.at(-1)[1]];if(S===null)continue;const{name:R}=S;if(R==="#text"){const p=document.createTextNode(S.value);e.push(p),o.append(p);continue}const P=S?.attributes?.xmlns?document.createElementNS(S.attributes.xmlns,R):document.createElement(R);if(o.append(P),S.attributes&&this.setAttributes({html:P,element:S,storage:N,intent:t,linkService:F}),S.children&&S.children.length>0)c.push([S,-1,P]);else if(S.value){const p=document.createTextNode(S.value);r.XfaText.shouldBuildText(R)&&e.push(p),P.append(p)}}for(const h of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))h.setAttribute("readOnly",!0);return{textDivs:e}}static update(T){const N=`matrix(${T.viewport.transform.join(",")})`;T.div.style.transform=N,T.div.hidden=!1}}n.XfaLayer=u},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.InkEditor=void 0;var r=_(1),u=_(4),w=_(29),T=_(6),N=_(5);class F extends u.AnnotationEditor{#t=0;#e=0;#n=this.canvasPointermove.bind(this);#s=this.canvasPointerleave.bind(this);#o=this.canvasPointerup.bind(this);#a=this.canvasPointerdown.bind(this);#r=new Path2D;#l=!1;#c=!1;#i=!1;#f=null;#d=0;#u=0;#p=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";constructor(t){super({...t,name:"inkEditor"}),this.color=t.color||null,this.thickness=t.thickness||null,this.opacity=t.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(t){u.AnnotationEditor.initialize(t,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(t,s){switch(t){case r.AnnotationEditorParamsType.INK_THICKNESS:F._defaultThickness=s;break;case r.AnnotationEditorParamsType.INK_COLOR:F._defaultColor=s;break;case r.AnnotationEditorParamsType.INK_OPACITY:F._defaultOpacity=s/100;break}}updateParams(t,s){switch(t){case r.AnnotationEditorParamsType.INK_THICKNESS:this.#b(s);break;case r.AnnotationEditorParamsType.INK_COLOR:this.#m(s);break;case r.AnnotationEditorParamsType.INK_OPACITY:this.#g(s);break}}static get defaultPropertiesToUpdate(){return[[r.AnnotationEditorParamsType.INK_THICKNESS,F._defaultThickness],[r.AnnotationEditorParamsType.INK_COLOR,F._defaultColor||u.AnnotationEditor._defaultLineColor],[r.AnnotationEditorParamsType.INK_OPACITY,Math.round(F._defaultOpacity*100)]]}get propertiesToUpdate(){return[[r.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||F._defaultThickness],[r.AnnotationEditorParamsType.INK_COLOR,this.color||F._defaultColor||u.AnnotationEditor._defaultLineColor],[r.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??F._defaultOpacity))]]}#b(t){const s=this.thickness;this.addCommands({cmd:()=>{this.thickness=t,this.#P()},undo:()=>{this.thickness=s,this.#P()},mustExec:!0,type:r.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#m(t){const s=this.color;this.addCommands({cmd:()=>{this.color=t,this.#y()},undo:()=>{this.color=s,this.#y()},mustExec:!0,type:r.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#g(t){t/=100;const s=this.opacity;this.addCommands({cmd:()=>{this.opacity=t,this.#y()},undo:()=>{this.opacity=s,this.#y()},mustExec:!0,type:r.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#R(),this.#k()),this.isAttachedToDOM||(this.parent.add(this),this.#A()),this.#P()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#f.disconnect(),this.#f=null,super.remove())}setParent(t){!this.parent&&t?this._uiManager.removeShouldRescale(this):this.parent&&t===null&&this._uiManager.addShouldRescale(this),super.setParent(t)}onScaleChanging(){const[t,s]=this.parentDimensions,c=this.width*t,l=this.height*s;this.setDimensions(c,l)}enableEditMode(){this.#l||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",this.#a))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#a))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#h(){const{parentRotation:t,parentDimensions:[s,c]}=this;switch(t){case 90:return[0,c,c,s];case 180:return[s,c,s,c];case 270:return[s,0,c,s];default:return[0,0,s,c]}}#_(){const{ctx:t,color:s,opacity:c,thickness:l,parentScale:e,scaleFactor:h}=this;t.lineWidth=l*e/h,t.lineCap="round",t.lineJoin="round",t.miterLimit=10,t.strokeStyle=`${s}${(0,N.opacityToHex)(c)}`}#S(t,s){this.canvas.addEventListener("contextmenu",T.noContextMenu),this.canvas.addEventListener("pointerleave",this.#s),this.canvas.addEventListener("pointermove",this.#n),this.canvas.addEventListener("pointerup",this.#o),this.canvas.removeEventListener("pointerdown",this.#a),this.isEditing=!0,this.#i||(this.#i=!0,this.#A(),this.thickness||=F._defaultThickness,this.color||=F._defaultColor||u.AnnotationEditor._defaultLineColor,this.opacity??=F._defaultOpacity),this.currentPath.push([t,s]),this.#c=!1,this.#_(),this.#p=()=>{this.#L(),this.#p&&window.requestAnimationFrame(this.#p)},window.requestAnimationFrame(this.#p)}#E(t,s){const[c,l]=this.currentPath.at(-1);if(this.currentPath.length>1&&t===c&&s===l)return;const e=this.currentPath;let h=this.#r;if(e.push([t,s]),this.#c=!0,e.length<=2){h.moveTo(...e[0]),h.lineTo(t,s);return}e.length===3&&(this.#r=h=new Path2D,h.moveTo(...e[0])),this.#O(h,...e.at(-3),...e.at(-2),t,s)}#w(){if(this.currentPath.length===0)return;const t=this.currentPath.at(-1);this.#r.lineTo(...t)}#x(t,s){this.#p=null,t=Math.min(Math.max(t,0),this.canvas.width),s=Math.min(Math.max(s,0),this.canvas.height),this.#E(t,s),this.#w();let c;if(this.currentPath.length!==1)c=this.#I();else{const o=[t,s];c=[[o,o.slice(),o.slice(),o]]}const l=this.#r,e=this.currentPath;this.currentPath=[],this.#r=new Path2D;const h=()=>{this.allRawPaths.push(e),this.paths.push(c),this.bezierPath2D.push(l),this.rebuild()},g=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#R(),this.#k()),this.#P())};this.addCommands({cmd:h,undo:g,mustExec:!0})}#L(){if(!this.#c)return;this.#c=!1;const t=Math.ceil(this.thickness*this.parentScale),s=this.currentPath.slice(-3),c=s.map(h=>h[0]),l=s.map(h=>h[1]);Math.min(...c)-t,Math.max(...c)+t,Math.min(...l)-t,Math.max(...l)+t;const{ctx:e}=this;e.save(),e.clearRect(0,0,this.canvas.width,this.canvas.height);for(const h of this.bezierPath2D)e.stroke(h);e.stroke(this.#r),e.restore()}#O(t,s,c,l,e,h,g){const o=(s+l)/2,S=(c+e)/2,R=(l+h)/2,P=(e+g)/2;t.bezierCurveTo(o+2*(l-o)/3,S+2*(e-S)/3,R+2*(l-R)/3,P+2*(e-P)/3,R,P)}#I(){const t=this.currentPath;if(t.length<=2)return[[t[0],t[0],t.at(-1),t.at(-1)]];const s=[];let c,[l,e]=t[0];for(c=1;c<t.length-2;c++){const[p,E]=t[c],[j,U]=t[c+1],I=(p+j)/2,G=(E+U)/2,H=[l+2*(p-l)/3,e+2*(E-e)/3],nt=[I+2*(p-I)/3,G+2*(E-G)/3];s.push([[l,e],H,nt,[I,G]]),[l,e]=[I,G]}const[h,g]=t[c],[o,S]=t[c+1],R=[l+2*(h-l)/3,e+2*(g-e)/3],P=[o+2*(h-o)/3,S+2*(g-S)/3];return s.push([[l,e],R,P,[o,S]]),s}#y(){if(this.isEmpty()){this.#T();return}this.#_();const{canvas:t,ctx:s}=this;s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,t.width,t.height),this.#T();for(const c of this.bezierPath2D)s.stroke(c)}commit(){this.#l||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#l=!0,this.div.classList.add("disabled"),this.#P(!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),this.enableEditMode())}canvasPointerdown(t){t.button!==0||!this.isInEditMode()||this.#l||(this.setInForeground(),t.preventDefault(),t.type!=="mouse"&&this.div.focus(),this.#S(t.offsetX,t.offsetY))}canvasPointermove(t){t.preventDefault(),this.#E(t.offsetX,t.offsetY)}canvasPointerup(t){t.preventDefault(),this.#D(t)}canvasPointerleave(t){this.#D(t)}#D(t){this.canvas.removeEventListener("pointerleave",this.#s),this.canvas.removeEventListener("pointermove",this.#n),this.canvas.removeEventListener("pointerup",this.#o),this.canvas.addEventListener("pointerdown",this.#a),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",T.noContextMenu)},10),this.#x(t.offsetX,t.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#R(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",u.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(t=>this.canvas?.setAttribute("aria-label",t)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#k(){this.#f=new ResizeObserver(t=>{const s=t[0].contentRect;s.width&&s.height&&this.setDimensions(s.width,s.height)}),this.#f.observe(this.div)}get isResizable(){return!this.isEmpty()&&this.#l}render(){if(this.div)return this.div;let t,s;this.width&&(t=this.x,s=this.y),super.render(),u.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(g=>this.div?.setAttribute("aria-label",g));const[c,l,e,h]=this.#h();if(this.setAt(c,l,0,0),this.setDims(e,h),this.#R(),this.width){const[g,o]=this.parentDimensions;this.setAspectRatio(this.width*g,this.height*o),this.setAt(t*g,s*o,this.width*g,this.height*o),this.#i=!0,this.#A(),this.setDims(this.width*g,this.height*o),this.#y(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#k(),this.div}#A(){if(!this.#i)return;const[t,s]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*t),this.canvas.height=Math.ceil(this.height*s),this.#T()}setDimensions(t,s){const c=Math.round(t),l=Math.round(s);if(this.#d===c&&this.#u===l)return;this.#d=c,this.#u=l,this.canvas.style.visibility="hidden";const[e,h]=this.parentDimensions;this.width=t/e,this.height=s/h,this.fixAndSetPosition(),this.#l&&this.#C(t,s),this.#A(),this.#y(),this.canvas.style.visibility="visible",this.fixDims()}#C(t,s){const c=this.#M(),l=(t-c)/this.#e,e=(s-c)/this.#t;this.scaleFactor=Math.min(l,e)}#T(){const t=this.#M()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+t,this.translationY*this.scaleFactor+t)}static#N(t){const s=new Path2D;for(let c=0,l=t.length;c<l;c++){const[e,h,g,o]=t[c];c===0&&s.moveTo(...e),s.bezierCurveTo(h[0],h[1],g[0],g[1],o[0],o[1])}return s}static#B(t,s,c){const[l,e,h,g]=s;switch(c){case 0:for(let o=0,S=t.length;o<S;o+=2)t[o]+=l,t[o+1]=g-t[o+1];break;case 90:for(let o=0,S=t.length;o<S;o+=2){const R=t[o];t[o]=t[o+1]+l,t[o+1]=R+e}break;case 180:for(let o=0,S=t.length;o<S;o+=2)t[o]=h-t[o],t[o+1]+=e;break;case 270:for(let o=0,S=t.length;o<S;o+=2){const R=t[o];t[o]=h-t[o+1],t[o+1]=g-R}break;default:throw new Error("Invalid rotation")}return t}static#j(t,s,c){const[l,e,h,g]=s;switch(c){case 0:for(let o=0,S=t.length;o<S;o+=2)t[o]-=l,t[o+1]=g-t[o+1];break;case 90:for(let o=0,S=t.length;o<S;o+=2){const R=t[o];t[o]=t[o+1]-e,t[o+1]=R-l}break;case 180:for(let o=0,S=t.length;o<S;o+=2)t[o]=h-t[o],t[o+1]-=e;break;case 270:for(let o=0,S=t.length;o<S;o+=2){const R=t[o];t[o]=g-t[o+1],t[o+1]=h-R}break;default:throw new Error("Invalid rotation")}return t}#U(t,s,c,l){const e=[],h=this.thickness/2,g=t*s+h,o=t*c+h;for(const S of this.paths){const R=[],P=[];for(let p=0,E=S.length;p<E;p++){const[j,U,I,G]=S[p],H=t*j[0]+g,nt=t*j[1]+o,Q=t*U[0]+g,Z=t*U[1]+o,it=t*I[0]+g,K=t*I[1]+o,L=t*G[0]+g,b=t*G[1]+o;p===0&&(R.push(H,nt),P.push(H,nt)),R.push(Q,Z,it,K,L,b),P.push(Q,Z),p===E-1&&P.push(L,b)}e.push({bezier:F.#B(R,l,this.rotation),points:F.#B(P,l,this.rotation)})}return e}#F(){let t=1/0,s=-1/0,c=1/0,l=-1/0;for(const e of this.paths)for(const[h,g,o,S]of e){const R=r.Util.bezierBoundingBox(...h,...g,...o,...S);t=Math.min(t,R[0]),c=Math.min(c,R[1]),s=Math.max(s,R[2]),l=Math.max(l,R[3])}return[t,c,s,l]}#M(){return this.#l?Math.ceil(this.thickness*this.parentScale):0}#P(t=!1){if(this.isEmpty())return;if(!this.#l){this.#y();return}const s=this.#F(),c=this.#M();this.#e=Math.max(u.AnnotationEditor.MIN_SIZE,s[2]-s[0]),this.#t=Math.max(u.AnnotationEditor.MIN_SIZE,s[3]-s[1]);const l=Math.ceil(c+this.#e*this.scaleFactor),e=Math.ceil(c+this.#t*this.scaleFactor),[h,g]=this.parentDimensions;this.width=l/h,this.height=e/g,this.setAspectRatio(l,e);const o=this.translationX,S=this.translationY;this.translationX=-s[0],this.translationY=-s[1],this.#A(),this.#y(),this.#d=l,this.#u=e,this.setDims(l,e);const R=t?c/this.scaleFactor/2:0;this.translate(o-this.translationX-R,S-this.translationY-R)}static deserialize(t,s,c){if(t instanceof w.InkAnnotationElement)return null;const l=super.deserialize(t,s,c);l.thickness=t.thickness,l.color=r.Util.makeHexColor(...t.color),l.opacity=t.opacity;const[e,h]=l.pageDimensions,g=l.width*e,o=l.height*h,S=l.parentScale,R=t.thickness/2;l.#l=!0,l.#d=Math.round(g),l.#u=Math.round(o);const{paths:P,rect:p,rotation:E}=t;for(let{bezier:U}of P){U=F.#j(U,p,E);const I=[];l.paths.push(I);let G=S*(U[0]-R),H=S*(U[1]-R);for(let Q=2,Z=U.length;Q<Z;Q+=6){const it=S*(U[Q]-R),K=S*(U[Q+1]-R),L=S*(U[Q+2]-R),b=S*(U[Q+3]-R),d=S*(U[Q+4]-R),f=S*(U[Q+5]-R);I.push([[G,H],[it,K],[L,b],[d,f]]),G=d,H=f}const nt=this.#N(I);l.bezierPath2D.push(nt)}const j=l.#F();return l.#e=Math.max(u.AnnotationEditor.MIN_SIZE,j[2]-j[0]),l.#t=Math.max(u.AnnotationEditor.MIN_SIZE,j[3]-j[1]),l.#C(g,o),l}serialize(){if(this.isEmpty())return null;const t=this.getRect(0,0),s=u.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:r.AnnotationEditorType.INK,color:s,thickness:this.thickness,opacity:this.opacity,paths:this.#U(this.scaleFactor/this.parentScale,this.translationX,this.translationY,t),pageIndex:this.pageIndex,rect:t,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}n.InkEditor=F},(A,n,_)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.StampEditor=void 0;var r=_(1),u=_(4),w=_(6),T=_(29);class N extends u.AnnotationEditor{#t=null;#e=null;#n=null;#s=null;#o=null;#a=null;#r=null;#l=null;#c=!1;#i=!1;static _type="stamp";constructor(i){super({...i,name:"stampEditor"}),this.#s=i.bitmapUrl,this.#o=i.bitmapFile}static initialize(i){u.AnnotationEditor.initialize(i)}static get supportedTypes(){const i=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,r.shadow)(this,"supportedTypes",i.map(t=>`image/${t}`))}static get supportedTypesStr(){return(0,r.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(i){return this.supportedTypes.includes(i)}static paste(i,t){t.pasteEditor(r.AnnotationEditorType.STAMP,{bitmapFile:i.getAsFile()})}#f(i,t=!1){if(!i){this.remove();return}this.#t=i.bitmap,t||(this.#e=i.id,this.#c=i.isSvg),this.#p()}#d(){this.#n=null,this._uiManager.enableWaiting(!1),this.#a&&this.div.focus()}#u(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(t=>this.#f(t,!0)).finally(()=>this.#d());return}if(this.#s){const t=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(t).then(s=>this.#f(s)).finally(()=>this.#d());return}if(this.#o){const t=this.#o;this.#o=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(t).then(s=>this.#f(s)).finally(()=>this.#d());return}const i=document.createElement("input");i.type="file",i.accept=N.supportedTypesStr,this.#n=new Promise(t=>{i.addEventListener("change",async()=>{if(!i.files||i.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(i.files[0]);this.#f(s)}t()}),i.addEventListener("cancel",()=>{this.remove(),t()})}).finally(()=>this.#d()),i.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#r?.disconnect(),this.#r=null),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#u();return}super.rebuild(),this.div!==null&&(this.#e&&this.#u(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#s||this.#o)}get isResizable(){return!0}render(){if(this.div)return this.div;let i,t;if(this.width&&(i=this.x,t=this.y),super.render(),this.div.hidden=!0,this.#t?this.#p():this.#u(),this.width){const[s,c]=this.parentDimensions;this.setAt(i*s,t*c,this.width*s,this.height*c)}return this.div}#p(){const{div:i}=this;let{width:t,height:s}=this.#t;const[c,l]=this.pageDimensions,e=.75;if(this.width)t=this.width*c,s=this.height*l;else if(t>e*c||s>e*l){const S=Math.min(e*c/t,e*l/s);t*=S,s*=S}const[h,g]=this.parentDimensions;this.setDims(t*h/c,s*g/l),this._uiManager.enableWaiting(!1);const o=this.#a=document.createElement("canvas");i.append(o),i.hidden=!1,this.#g(t,s),this.#_(),this.#i||(this.parent.addUndoableEditor(this),this.#i=!0),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()}#b(i,t){const[s,c]=this.parentDimensions;this.width=i/s,this.height=t/c,this.setDims(i,t),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#l!==null&&clearTimeout(this.#l);const l=200;this.#l=setTimeout(()=>{this.#l=null,this.#g(i,t)},l)}#m(i,t){const{width:s,height:c}=this.#t;let l=s,e=c,h=this.#t;for(;l>2*i||e>2*t;){const g=l,o=e;l>2*i&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),e>2*t&&(e=e>=16384?Math.floor(e/2)-1:Math.ceil(e/2));const S=new OffscreenCanvas(l,e);S.getContext("2d").drawImage(h,0,0,g,o,0,0,l,e),h=S.transferToImageBitmap()}return h}#g(i,t){i=Math.ceil(i),t=Math.ceil(t);const s=this.#a;if(!s||s.width===i&&s.height===t)return;s.width=i,s.height=t;const c=this.#c?this.#t:this.#m(i,t),l=s.getContext("2d");l.filter=this._uiManager.hcmFilter,l.drawImage(c,0,0,c.width,c.height,0,0,i,t)}#h(i){if(i){if(this.#c){const c=this._uiManager.imageManager.getSvgUrl(this.#e);if(c)return c}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#t,t.getContext("2d").drawImage(this.#t,0,0),t.toDataURL()}if(this.#c){const[t,s]=this.pageDimensions,c=Math.round(this.width*t*w.PixelsPerInch.PDF_TO_CSS_UNITS),l=Math.round(this.height*s*w.PixelsPerInch.PDF_TO_CSS_UNITS),e=new OffscreenCanvas(c,l);return e.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,c,l),e.transferToImageBitmap()}return structuredClone(this.#t)}#_(){this.#r=new ResizeObserver(i=>{const t=i[0].contentRect;t.width&&t.height&&this.#b(t.width,t.height)}),this.#r.observe(this.div)}static deserialize(i,t,s){if(i instanceof T.StampAnnotationElement)return null;const c=super.deserialize(i,t,s),{rect:l,bitmapUrl:e,bitmapId:h,isSvg:g,accessibilityData:o}=i;h&&s.imageManager.isValidId(h)?c.#e=h:c.#s=e,c.#c=g;const[S,R]=c.pageDimensions;return c.width=(l[2]-l[0])/S,c.height=(l[3]-l[1])/R,o&&(c.altTextData=o),c}serialize(i=!1,t=null){if(this.isEmpty())return null;const s={annotationType:r.AnnotationEditorType.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(i)return s.bitmapUrl=this.#h(!0),s.accessibilityData=this.altTextData,s;const{decorative:c,altText:l}=this.altTextData;if(!c&&l&&(s.accessibilityData={type:"Figure",alt:l}),t===null)return s;t.stamps||=new Map;const e=this.#c?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!t.stamps.has(this.#e))t.stamps.set(this.#e,{area:e,serialized:s}),s.bitmap=this.#h(!1);else if(this.#c){const h=t.stamps.get(this.#e);e>h.area&&(h.area=e,h.serialized.bitmap.close(),h.serialized.bitmap=this.#h(!1))}return s}}n.StampEditor=N}],__webpack_module_cache__={};function __w_pdfjs_require__(A){var n=__webpack_module_cache__[A];if(n!==void 0)return n.exports;var _=__webpack_module_cache__[A]={exports:{}};return __webpack_modules__[A](_,_.exports,__w_pdfjs_require__),_.exports}var __webpack_exports__={};return(()=>{var A=__webpack_exports__;Object.defineProperty(A,"__esModule",{value:!0}),Object.defineProperty(A,"AbortException",{enumerable:!0,get:function(){return n.AbortException}}),Object.defineProperty(A,"AnnotationEditorLayer",{enumerable:!0,get:function(){return w.AnnotationEditorLayer}}),Object.defineProperty(A,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return n.AnnotationEditorParamsType}}),Object.defineProperty(A,"AnnotationEditorType",{enumerable:!0,get:function(){return n.AnnotationEditorType}}),Object.defineProperty(A,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return T.AnnotationEditorUIManager}}),Object.defineProperty(A,"AnnotationLayer",{enumerable:!0,get:function(){return N.AnnotationLayer}}),Object.defineProperty(A,"AnnotationMode",{enumerable:!0,get:function(){return n.AnnotationMode}}),Object.defineProperty(A,"CMapCompressionType",{enumerable:!0,get:function(){return n.CMapCompressionType}}),Object.defineProperty(A,"DOMSVGFactory",{enumerable:!0,get:function(){return r.DOMSVGFactory}}),Object.defineProperty(A,"FeatureTest",{enumerable:!0,get:function(){return n.FeatureTest}}),Object.defineProperty(A,"GlobalWorkerOptions",{enumerable:!0,get:function(){return F.GlobalWorkerOptions}}),Object.defineProperty(A,"ImageKind",{enumerable:!0,get:function(){return n.ImageKind}}),Object.defineProperty(A,"InvalidPDFException",{enumerable:!0,get:function(){return n.InvalidPDFException}}),Object.defineProperty(A,"MissingPDFException",{enumerable:!0,get:function(){return n.MissingPDFException}}),Object.defineProperty(A,"OPS",{enumerable:!0,get:function(){return n.OPS}}),Object.defineProperty(A,"PDFDataRangeTransport",{enumerable:!0,get:function(){return _.PDFDataRangeTransport}}),Object.defineProperty(A,"PDFDateString",{enumerable:!0,get:function(){return r.PDFDateString}}),Object.defineProperty(A,"PDFWorker",{enumerable:!0,get:function(){return _.PDFWorker}}),Object.defineProperty(A,"PasswordResponses",{enumerable:!0,get:function(){return n.PasswordResponses}}),Object.defineProperty(A,"PermissionFlag",{enumerable:!0,get:function(){return n.PermissionFlag}}),Object.defineProperty(A,"PixelsPerInch",{enumerable:!0,get:function(){return r.PixelsPerInch}}),Object.defineProperty(A,"PromiseCapability",{enumerable:!0,get:function(){return n.PromiseCapability}}),Object.defineProperty(A,"RenderingCancelledException",{enumerable:!0,get:function(){return r.RenderingCancelledException}}),Object.defineProperty(A,"SVGGraphics",{enumerable:!0,get:function(){return _.SVGGraphics}}),Object.defineProperty(A,"UnexpectedResponseException",{enumerable:!0,get:function(){return n.UnexpectedResponseException}}),Object.defineProperty(A,"Util",{enumerable:!0,get:function(){return n.Util}}),Object.defineProperty(A,"VerbosityLevel",{enumerable:!0,get:function(){return n.VerbosityLevel}}),Object.defineProperty(A,"XfaLayer",{enumerable:!0,get:function(){return i.XfaLayer}}),Object.defineProperty(A,"build",{enumerable:!0,get:function(){return _.build}}),Object.defineProperty(A,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return n.createValidAbsoluteUrl}}),Object.defineProperty(A,"getDocument",{enumerable:!0,get:function(){return _.getDocument}}),Object.defineProperty(A,"getFilenameFromUrl",{enumerable:!0,get:function(){return r.getFilenameFromUrl}}),Object.defineProperty(A,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return r.getPdfFilenameFromUrl}}),Object.defineProperty(A,"getXfaPageViewport",{enumerable:!0,get:function(){return r.getXfaPageViewport}}),Object.defineProperty(A,"isDataScheme",{enumerable:!0,get:function(){return r.isDataScheme}}),Object.defineProperty(A,"isPdfFile",{enumerable:!0,get:function(){return r.isPdfFile}}),Object.defineProperty(A,"loadScript",{enumerable:!0,get:function(){return r.loadScript}}),Object.defineProperty(A,"noContextMenu",{enumerable:!0,get:function(){return r.noContextMenu}}),Object.defineProperty(A,"normalizeUnicode",{enumerable:!0,get:function(){return n.normalizeUnicode}}),Object.defineProperty(A,"renderTextLayer",{enumerable:!0,get:function(){return u.renderTextLayer}}),Object.defineProperty(A,"setLayerDimensions",{enumerable:!0,get:function(){return r.setLayerDimensions}}),Object.defineProperty(A,"shadow",{enumerable:!0,get:function(){return n.shadow}}),Object.defineProperty(A,"updateTextLayer",{enumerable:!0,get:function(){return u.updateTextLayer}}),Object.defineProperty(A,"version",{enumerable:!0,get:function(){return _.version}});var n=__w_pdfjs_require__(1),_=__w_pdfjs_require__(2),r=__w_pdfjs_require__(6),u=__w_pdfjs_require__(26),w=__w_pdfjs_require__(27),T=__w_pdfjs_require__(5),N=__w_pdfjs_require__(29),F=__w_pdfjs_require__(14),i=__w_pdfjs_require__(32)})(),__webpack_exports__})())}(pdf$1)),pdf$1.exports}var pdfExports=requirePdf();const pdf=getDefaultExportFromCjs(pdfExports),pdfjsModule=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]),pdfjs="default"in pdfjsModule?pdf:pdfjsModule;var __spreadArray=function(A,n,_){if(_||arguments.length===2)for(var r=0,u=n.length,w;r<u;r++)(w||!(r in n))&&(w||(w=Array.prototype.slice.call(n,0,r)),w[r]=n[r]);return A.concat(w||Array.prototype.slice.call(n))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(A,n){var _={};return allEvents.forEach(function(r){var u=A[r];u&&(n?_[r]=function(w){return u(w,n(r))}:_[r]=u)}),_}function makeCancellablePromise(A){var n=!1,_=new Promise(function(r,u){A.then(function(w){return!n&&r(w)}).catch(function(w){return!n&&u(w)})});return{promise:_,cancel:function(){n=!0}}}var prefix="Invariant failed";function invariant(A,n){if(!A)throw new Error(prefix)}var warning_1,hasRequiredWarning;function requireWarning(){if(hasRequiredWarning)return warning_1;hasRequiredWarning=1;var A=function(){};return warning_1=A,warning_1}var warningExports=requireWarning();const warning=getDefaultExportFromCjs(warningExports);var has=Object.prototype.hasOwnProperty;function find(A,n,_){for(_ of A.keys())if(dequal(_,n))return _}function dequal(A,n){var _,r,u;if(A===n)return!0;if(A&&n&&(_=A.constructor)===n.constructor){if(_===Date)return A.getTime()===n.getTime();if(_===RegExp)return A.toString()===n.toString();if(_===Array){if((r=A.length)===n.length)for(;r--&&dequal(A[r],n[r]););return r===-1}if(_===Set){if(A.size!==n.size)return!1;for(r of A)if(u=r,u&&typeof u=="object"&&(u=find(n,u),!u)||!n.has(u))return!1;return!0}if(_===Map){if(A.size!==n.size)return!1;for(r of A)if(u=r[0],u&&typeof u=="object"&&(u=find(n,u),!u)||!dequal(r[1],n.get(u)))return!1;return!0}if(_===ArrayBuffer)A=new Uint8Array(A),n=new Uint8Array(n);else if(_===DataView){if((r=A.byteLength)===n.byteLength)for(;r--&&A.getInt8(r)===n.getInt8(r););return r===-1}if(ArrayBuffer.isView(A)){if((r=A.byteLength)===n.byteLength)for(;r--&&A[r]===n[r];);return r===-1}if(!_||typeof A=="object"){r=0;for(_ in A)if(has.call(A,_)&&++r&&!has.call(n,_)||!(_ in n)||!dequal(A[_],n[_]))return!1;return Object.keys(n).length===r}}return A!==A&&n!==n}const DocumentContext=reactExports.createContext(null);function Message({children:A,type:n}){return React.createElement("div",{className:`react-pdf__message react-pdf__message--${n}`},A)}const DEFAULT_LINK_REL="noopener noreferrer nofollow";class LinkService{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(n){this.pdfDocument=n}setViewer(n){this.pdfViewer=n}setExternalLinkRel(n){this.externalLinkRel=n}setExternalLinkTarget(n){this.externalLinkTarget=n}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return invariant(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(n){invariant(this.pdfViewer),this.pdfViewer.currentPageNumber=n}get rotation(){return 0}set rotation(n){}goToDestination(n){return new Promise(_=>{invariant(this.pdfDocument),invariant(n),typeof n=="string"?this.pdfDocument.getDestination(n).then(_):Array.isArray(n)?_(n):n.then(_)}).then(_=>{invariant(Array.isArray(_));const r=_[0];new Promise(u=>{invariant(this.pdfDocument),r instanceof Object?this.pdfDocument.getPageIndex(r).then(w=>{u(w)}).catch(()=>{invariant(!1)}):typeof r=="number"?u(r):invariant(!1)}).then(u=>{const w=u+1;invariant(this.pdfViewer),invariant(w>=1&&w<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:_,pageIndex:u,pageNumber:w})})})}navigateTo(n){this.goToDestination(n)}goToPage(n){const _=n-1;invariant(this.pdfViewer),invariant(n>=1&&n<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:_,pageNumber:n})}addLinkAttributes(n,_,r){n.href=_,n.rel=this.externalLinkRel||DEFAULT_LINK_REL,n.target=r?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(A){return typeof A<"u"}function isProvided(A){return isDefined(A)&&A!==null}function isString(A){return typeof A=="string"}function isArrayBuffer(A){return A instanceof ArrayBuffer}function isBlob(A){return invariant(isBrowser),A instanceof Blob}function isDataURI(A){return isString(A)&&/^data:/.test(A)}function dataURItoByteString(A){invariant(isDataURI(A));const[n="",_=""]=A.split(",");return n.split(";").indexOf("base64")!==-1?atob(_):unescape(_)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}const allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning(!isLocalFileSystem,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function displayWorkerWarning(){warning(!isLocalFileSystem,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function cancelRunningTask(A){A&&A.cancel&&A.cancel()}function makePageCallback(A,n){return Object.defineProperty(A,"width",{get(){return this.view[2]*n},configurable:!0}),Object.defineProperty(A,"height",{get(){return this.view[3]*n},configurable:!0}),Object.defineProperty(A,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(A,"originalHeight",{get(){return this.view[3]},configurable:!0}),A}function isCancelException(A){return A.name==="RenderingCancelledException"}function loadFromFile(A){return new Promise((n,_)=>{const r=new FileReader;r.onload=()=>{if(!r.result)return _(new Error("Error while reading a file."));n(r.result)},r.onerror=u=>{if(!u.target)return _(new Error("Error while reading a file."));const{error:w}=u.target;if(!w)return _(new Error("Error while reading a file."));switch(w.code){case w.NOT_FOUND_ERR:return _(new Error("Error while reading a file: File not found."));case w.SECURITY_ERR:return _(new Error("Error while reading a file: Security error."));case w.ABORT_ERR:return _(new Error("Error while reading a file: Aborted."));default:return _(new Error("Error while reading a file."))}},r.readAsArrayBuffer(A)})}function reducer(A,n){switch(n.type){case"RESOLVE":return{value:n.value,error:void 0};case"REJECT":return{value:!1,error:n.error};case"RESET":return{value:void 0,error:void 0};default:return A}}function useResolver(){return reactExports.useReducer(reducer,{value:void 0,error:void 0})}const{PDFDataRangeTransport:PDFDataRangeTransport$1}=pdfjs,eventProps=(()=>{const A={};return allEvents.forEach(n=>{A[n]=PropTypes.func}),A})(),isTypedArray=PropTypes.oneOfType([PropTypes.instanceOf(Int8Array),PropTypes.instanceOf(Uint8Array),PropTypes.instanceOf(Uint8ClampedArray),PropTypes.instanceOf(Int16Array),PropTypes.instanceOf(Uint16Array),PropTypes.instanceOf(Int32Array),PropTypes.instanceOf(Uint32Array),PropTypes.instanceOf(Float32Array),PropTypes.instanceOf(Float64Array)]),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.arrayOf(PropTypes.number.isRequired),isTypedArray]).isRequired}),PropTypes.shape({range:PropTypes.instanceOf(PDFDataRangeTransport$1).isRequired}),PropTypes.shape({url:PropTypes.string.isRequired})];typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));const isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes);PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired});const isPageIndex=function A(n,_,r){const{[_]:u,pageNumber:w,pdf:T}=n;if(!isDefined(T))return null;if(isDefined(u)){if(typeof u!="number")return new Error(`\`${_}\` of type \`${typeof u}\` supplied to \`${r}\`, expected \`number\`.`);if(u<0)return new Error(`Expected \`${_}\` to be greater or equal to 0.`);const{numPages:N}=T;if(u+1>N)return new Error(`Expected \`${_}\` to be less or equal to ${N-1}.`)}else if(!isDefined(w))return new Error(`\`${_}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${r}\`.`);return null},isPageNumber=function A(n,_,r){const{[_]:u,pageIndex:w,pdf:T}=n;if(!isDefined(T))return null;if(isDefined(u)){if(typeof u!="number")return new Error(`\`${_}\` of type \`${typeof u}\` supplied to \`${r}\`, expected \`number\`.`);if(u<1)return new Error(`Expected \`${_}\` to be greater or equal to 1.`);const{numPages:N}=T;if(u>N)return new Error(`Expected \`${_}\` to be less or equal to ${N}.`)}else if(!isDefined(w))return new Error(`\`${_}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${r}\`.`);return null},isPdf=PropTypes.oneOfType([PropTypes.any,PropTypes.oneOf([!1])]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.exact({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","custom","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]);var __awaiter=function(A,n,_,r){function u(w){return w instanceof _?w:new _(function(T){T(w)})}return new(_||(_=Promise))(function(w,T){function N(t){try{i(r.next(t))}catch(s){T(s)}}function F(t){try{i(r.throw(t))}catch(s){T(s)}}function i(t){t.done?w(t.value):u(t.value).then(N,F)}i((r=r.apply(A,n||[])).next())})},__rest$1=function(A,n){var _={};for(var r in A)Object.prototype.hasOwnProperty.call(A,r)&&n.indexOf(r)<0&&(_[r]=A[r]);if(A!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,r=Object.getOwnPropertySymbols(A);u<r.length;u++)n.indexOf(r[u])<0&&Object.prototype.propertyIsEnumerable.call(A,r[u])&&(_[r[u]]=A[r[u]]);return _};const{PDFDataRangeTransport}=pdfjs,defaultOnPassword=(A,n)=>{switch(n){case PasswordResponses.NEED_PASSWORD:{const _=prompt("Enter the password to open this PDF file.");A(_);break}case PasswordResponses.INCORRECT_PASSWORD:{const _=prompt("Invalid password. Please try again.");A(_);break}}};function isParameterObject(A){return typeof A=="object"&&A!==null&&("data"in A||"range"in A||"url"in A)}const Document=reactExports.forwardRef(function A(n,_){var{children:r,className:u,error:w="Failed to load PDF file.",externalLinkRel:T,externalLinkTarget:N,file:F,inputRef:i,imageResourcesPath:t,loading:s="Loading PDF…",noData:c="No PDF file specified.",onItemClick:l,onLoadError:e,onLoadProgress:h,onLoadSuccess:g,onPassword:o=defaultOnPassword,onSourceError:S,onSourceSuccess:R,options:P,renderMode:p,rotate:E}=n,j=__rest$1(n,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[U,I]=useResolver(),{value:G,error:H}=U,[nt,Q]=useResolver(),{value:Z,error:it}=nt,K=reactExports.useRef(new LinkService),L=reactExports.useRef([]),b=reactExports.useRef(),d=reactExports.useRef();reactExports.useEffect(()=>{F&&F!==b.current&&isParameterObject(F)&&(warning(!dequal(F,b.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),b.current=F)},[F]),reactExports.useEffect(()=>{P&&P!==d.current&&(warning(!dequal(P,d.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),d.current=P)},[P]);const f=reactExports.useRef({scrollPageIntoView:X=>{const{dest:Y,pageNumber:J,pageIndex:tt=J-1}=X;if(l){l({dest:Y,pageIndex:tt,pageNumber:J});return}const rt=L.current[tt];if(rt){rt.scrollIntoView();return}warning(!1,`An internal link leading to page ${J} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});reactExports.useImperativeHandle(_,()=>({linkService:K,pages:L,viewer:f}),[]);function y(){R&&R()}function M(){H&&(warning(!1,H.toString()),S&&S(H))}function D(){I({type:"RESET"})}reactExports.useEffect(D,[F,I]);const B=reactExports.useCallback(()=>__awaiter(this,void 0,void 0,function*(){if(!F)return null;if(typeof F=="string")return isDataURI(F)?{data:dataURItoByteString(F)}:(displayCORSWarning(),{url:F});if(F instanceof PDFDataRangeTransport)return{range:F};if(isArrayBuffer(F))return{data:F};if(isBrowser&&isBlob(F))return{data:yield loadFromFile(F)};if(invariant(typeof F=="object"),invariant(isParameterObject(F)),"url"in F&&typeof F.url=="string"){if(isDataURI(F.url)){const{url:X}=F,Y=__rest$1(F,["url"]),J=dataURItoByteString(X);return Object.assign({data:J},Y)}displayCORSWarning()}return F}),[F]);reactExports.useEffect(()=>{const X=makeCancellablePromise(B());return X.promise.then(Y=>{I({type:"RESOLVE",value:Y})}).catch(Y=>{I({type:"REJECT",error:Y})}),()=>{cancelRunningTask(X)}},[B,I]),reactExports.useEffect(()=>{if(!(typeof G>"u")){if(G===!1){M();return}y()}},[G]);function C(){Z&&(g&&g(Z),L.current=new Array(Z.numPages),K.current.setDocument(Z))}function a(){it&&(warning(!1,it.toString()),e&&e(it))}function m(){Q({type:"RESET"})}reactExports.useEffect(m,[Q,G]);function v(){if(!G)return;const X=Object.assign(Object.assign({},P),{isEvalSupported:!1}),Y=Object.assign(Object.assign({},G),X),J=pdfjs.getDocument(Y);h&&(J.onProgress=h),o&&(J.onPassword=o);const tt=J;return tt.promise.then(rt=>{Q({type:"RESOLVE",value:rt})}).catch(rt=>{tt.destroyed||Q({type:"REJECT",error:rt})}),()=>{tt.destroy()}}reactExports.useEffect(v,[P,Q,G]),reactExports.useEffect(()=>{if(!(typeof Z>"u")){if(Z===!1){a();return}C()}},[Z]);function x(){K.current.setViewer(f.current),K.current.setExternalLinkRel(T),K.current.setExternalLinkTarget(N)}reactExports.useEffect(x,[T,N]);function k(X,Y){L.current[X]=Y}function O(X){delete L.current[X]}const W=reactExports.useMemo(()=>({imageResourcesPath:t,linkService:K.current,onItemClick:l,pdf:Z,registerPage:k,renderMode:p,rotate:E,unregisterPage:O}),[t,l,Z,p,E]),z=reactExports.useMemo(()=>makeEventProps(j,()=>Z),[j,Z]);function st(){return React.createElement(DocumentContext.Provider,{value:W},r)}function q(){return F?Z==null?React.createElement(Message,{type:"loading"},typeof s=="function"?s():s):Z===!1?React.createElement(Message,{type:"error"},typeof w=="function"?w():w):st():React.createElement(Message,{type:"no-data"},typeof c=="function"?c():c)}return React.createElement("div",Object.assign({className:clsx("react-pdf__Document",u),ref:i,style:{"--scale-factor":"1"}},z),q())}),isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=Object.assign(Object.assign({},eventProps),{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.oneOf(["_self","_blank","_parent","_top"]),file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,options:PropTypes.shape({canvasFactory:PropTypes.any,canvasMaxAreaInBytes:PropTypes.number,cMapPacked:PropTypes.bool,CMapReaderFactory:PropTypes.any,cMapUrl:PropTypes.string,disableAutoFetch:PropTypes.bool,disableFontFace:PropTypes.bool,disableRange:PropTypes.bool,disableStream:PropTypes.bool,docBaseUrl:PropTypes.string,enableXfa:PropTypes.bool,filterFactory:PropTypes.any,fontExtraProperties:PropTypes.bool,httpHeaders:PropTypes.object,isEvalSupported:PropTypes.bool,isOffscreenCanvasSupported:PropTypes.bool,length:PropTypes.number,maxImageSize:PropTypes.number,ownerDocument:PropTypes.any,password:PropTypes.string,pdfBug:PropTypes.bool,rangeChunkSize:PropTypes.number,StandardFontDataFactory:PropTypes.any,standardFontDataUrl:PropTypes.string,stopAtErrors:PropTypes.bool,useSystemFonts:PropTypes.bool,useWorkerFetch:PropTypes.bool,verbosity:PropTypes.number,withCredentials:PropTypes.bool,worker:PropTypes.any}),rotate:PropTypes.number});function useDocumentContext(){return reactExports.useContext(DocumentContext)}function mergeRefs(){for(var A=[],n=0;n<arguments.length;n++)A[n]=arguments[n];var _=A.filter(Boolean);if(_.length<=1){var r=_[0];return r||null}return function(w){_.forEach(function(T){typeof T=="function"?T(w):T&&(T.current=w)})}}const PageContext=reactExports.createContext(null),PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;function isPdfRole(A){return A in PDF_ROLE_TO_HTML_ROLE}function isStructTreeNode(A){return"children"in A}function isStructTreeNodeWithOnlyContentChild(A){return isStructTreeNode(A)?A.children.length===1&&0 in A.children&&"id"in A.children[0]:!1}function getRoleAttributes(A){const n={};if(isStructTreeNode(A)){const{role:_}=A,r=_.match(HEADING_PATTERN);if(r)n.role="heading",n["aria-level"]=Number(r[1]);else if(isPdfRole(_)){const u=PDF_ROLE_TO_HTML_ROLE[_];u&&(n.role=u)}}return n}function getBaseAttributes(A){const n={};if(isStructTreeNode(A)){if(A.alt!==void 0&&(n["aria-label"]=A.alt),A.lang!==void 0&&(n.lang=A.lang),isStructTreeNodeWithOnlyContentChild(A)){const[_]=A.children;if(_){const r=getBaseAttributes(_);return Object.assign(Object.assign({},n),r)}}}else"id"in A&&(n["aria-owns"]=A.id);return n}function getAttributes(A){return A?Object.assign(Object.assign({},getRoleAttributes(A)),getBaseAttributes(A)):null}function StructTreeItem({className:A,node:n}){const _=reactExports.useMemo(()=>getAttributes(n),[n]),r=reactExports.useMemo(()=>!isStructTreeNode(n)||isStructTreeNodeWithOnlyContentChild(n)?null:n.children.map((u,w)=>React.createElement(StructTreeItem,{key:w,node:u})),[n]);return React.createElement("span",Object.assign({className:A},_),r)}function usePageContext(){return reactExports.useContext(PageContext)}function StructTree(){const A=usePageContext();invariant(A);const{onGetStructTreeError:n,onGetStructTreeSuccess:_}=A,[r,u]=useResolver(),{value:w,error:T}=r,{customTextRenderer:N,page:F}=A;function i(){w&&_&&_(w)}function t(){T&&(warning(!1,T.toString()),n&&n(T))}function s(){u({type:"RESET"})}reactExports.useEffect(s,[u,F]);function c(){if(N||!F)return;const l=makeCancellablePromise(F.getStructTree()),e=l;return l.promise.then(h=>{u({type:"RESOLVE",value:h})}).catch(h=>{u({type:"REJECT",error:h})}),()=>cancelRunningTask(e)}return reactExports.useEffect(c,[N,F,u]),reactExports.useEffect(()=>{if(w!==void 0){if(w===!1){t();return}i()}},[w]),w?React.createElement(StructTreeItem,{className:"react-pdf__Page__structTree structTree",node:w}):null}const ANNOTATION_MODE=pdfjs.AnnotationMode;function PageCanvas(A){const n=usePageContext();invariant(n);const _=Object.assign(Object.assign({},n),A),{_className:r,canvasBackground:u,devicePixelRatio:w=getDevicePixelRatio(),onRenderError:T,onRenderSuccess:N,page:F,renderForms:i,renderTextLayer:t,rotate:s,scale:c}=_,{canvasRef:l}=A;invariant(F);const e=reactExports.useRef(null);function h(){F&&N&&N(makePageCallback(F,c))}function g(p){isCancelException(p)||(warning(!1,p.toString()),T&&T(p))}const o=reactExports.useMemo(()=>F.getViewport({scale:c*w,rotation:s}),[w,F,s,c]),S=reactExports.useMemo(()=>F.getViewport({scale:c,rotation:s}),[F,s,c]);function R(){if(!F)return;F.cleanup();const{current:p}=e;if(!p)return;p.width=o.width,p.height=o.height,p.style.width=`${Math.floor(S.width)}px`,p.style.height=`${Math.floor(S.height)}px`,p.style.visibility="hidden";const E={annotationMode:i?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,canvasContext:p.getContext("2d",{alpha:!1}),viewport:o};u&&(E.background=u);const j=F.render(E),U=j;return j.promise.then(()=>{p.style.visibility="",h()}).catch(g),()=>cancelRunningTask(U)}reactExports.useEffect(R,[u,e,w,F,i,o,S]);const P=reactExports.useCallback(()=>{const{current:p}=e;p&&(p.width=0,p.height=0)},[e]);return reactExports.useEffect(()=>P,[P]),React.createElement("canvas",{className:`${r}__canvas`,dir:"ltr",ref:mergeRefs(l,e),style:{display:"block",userSelect:"none"}},t?React.createElement(StructTree,null):null)}function PageSVG(){const A=usePageContext();invariant(A);const{_className:n,onRenderSuccess:_,onRenderError:r,page:u,rotate:w,scale:T}=A;invariant(u);const[N,F]=useResolver(),{value:i,error:t}=N;function s(){u&&_&&_(makePageCallback(u,T))}function c(){t&&(isCancelException(t)||(warning(!1,t.toString()),r&&r(t)))}const l=reactExports.useMemo(()=>u.getViewport({scale:T,rotation:w}),[u,w,T]);function e(){F({type:"RESET"})}reactExports.useEffect(e,[u,F,l]);function h(){if(!u)return;const R=makeCancellablePromise(u.getOperatorList());return R.promise.then(P=>{new pdfjs.SVGGraphics(u.commonObjs,u.objs).getSVG(P,l).then(E=>{if(!(E instanceof SVGElement))throw new Error("getSVG returned unexpected result.");F({type:"RESOLVE",value:E})}).catch(E=>{F({type:"REJECT",error:E})})}).catch(P=>{F({type:"REJECT",error:P})}),()=>cancelRunningTask(R)}reactExports.useEffect(h,[u,F,l]),reactExports.useEffect(()=>{if(i!==void 0){if(i===!1){c();return}s()}},[i]);function g(R){if(!R||!i)return;R.firstElementChild||R.appendChild(i);const{width:P,height:p}=l;i.setAttribute("width",`${P}`),i.setAttribute("height",`${p}`)}const{width:o,height:S}=l;return React.createElement("div",{className:`${n}__svg`,ref:R=>g(R),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:o,height:S,userSelect:"none"}})}function isTextItem(A){return"str"in A}function TextLayer(){const A=usePageContext();invariant(A);const{customTextRenderer:n,onGetTextError:_,onGetTextSuccess:r,onRenderTextLayerError:u,onRenderTextLayerSuccess:w,page:T,pageIndex:N,pageNumber:F,rotate:i,scale:t}=A;invariant(T);const[s,c]=useResolver(),{value:l,error:e}=s,h=reactExports.useRef(null),g=reactExports.useRef();warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function o(){l&&r&&r(l)}function S(){e&&(warning(!1,e.toString()),_&&_(e))}function R(){c({type:"RESET"})}reactExports.useEffect(R,[T,c]);function P(){if(!T)return;const H=makeCancellablePromise(T.getTextContent()),nt=H;return H.promise.then(Q=>{c({type:"RESOLVE",value:Q})}).catch(Q=>{c({type:"REJECT",error:Q})}),()=>cancelRunningTask(nt)}reactExports.useEffect(P,[T,c]),reactExports.useEffect(()=>{if(l!==void 0){if(l===!1){S();return}o()}},[l]);const p=reactExports.useCallback(()=>{w&&w()},[w]),E=reactExports.useCallback(H=>{warning(!1,H.toString()),u&&u(H)},[u]);function j(){const H=g.current;H&&H.classList.add("active")}function U(){const H=g.current;H&&H.classList.remove("active")}const I=reactExports.useMemo(()=>T.getViewport({scale:t,rotation:i}),[T,i,t]);function G(){if(!T||!l)return;const{current:H}=h;if(!H)return;H.innerHTML="";const nt=T.streamTextContent({includeMarkedContent:!0}),Q={container:H,textContentSource:nt,viewport:I},Z=pdfjs.renderTextLayer(Q),it=Z;return Z.promise.then(()=>{const K=document.createElement("div");K.className="endOfContent",H.append(K),g.current=K;const L=H.querySelectorAll('[role="presentation"]');if(n){let b=0;l.items.forEach((d,f)=>{if(!isTextItem(d))return;const y=L[b];if(!y)return;const M=n(Object.assign({pageIndex:N,pageNumber:F,itemIndex:f},d));y.innerHTML=M,b+=d.str&&d.hasEOL?2:1})}p()}).catch(E),()=>cancelRunningTask(it)}return reactExports.useLayoutEffect(G,[n,E,p,T,N,F,l,I]),React.createElement("div",{className:clsx("react-pdf__Page__textContent","textLayer"),onMouseUp:U,onMouseDown:j,ref:h})}function AnnotationLayer(){const A=useDocumentContext(),n=usePageContext();invariant(n);const _=Object.assign(Object.assign({},A),n),{imageResourcesPath:r,linkService:u,onGetAnnotationsError:w,onGetAnnotationsSuccess:T,onRenderAnnotationLayerError:N,onRenderAnnotationLayerSuccess:F,page:i,pdf:t,renderForms:s,rotate:c,scale:l=1}=_;invariant(t),invariant(i),invariant(u);const[e,h]=useResolver(),{value:g,error:o}=e,S=reactExports.useRef(null);warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function R(){g&&T&&T(g)}function P(){o&&(warning(!1,o.toString()),w&&w(o))}function p(){h({type:"RESET"})}reactExports.useEffect(p,[h,i]);function E(){if(!i)return;const H=makeCancellablePromise(i.getAnnotations()),nt=H;return H.promise.then(Q=>{h({type:"RESOLVE",value:Q})}).catch(Q=>{h({type:"REJECT",error:Q})}),()=>{cancelRunningTask(nt)}}reactExports.useEffect(E,[h,i,s]),reactExports.useEffect(()=>{if(g!==void 0){if(g===!1){P();return}R()}},[g]);function j(){F&&F()}function U(H){warning(!1,`${H}`),N&&N(H)}const I=reactExports.useMemo(()=>i.getViewport({scale:l,rotation:c}),[i,c,l]);function G(){if(!t||!i||!u||!g)return;const{current:H}=S;if(!H)return;const nt=I.clone({dontFlip:!0}),Q={accessibilityManager:null,annotationCanvasMap:null,div:H,l10n:null,page:i,viewport:nt},Z={annotations:g,annotationStorage:t.annotationStorage,div:H,downloadManager:null,imageResourcesPath:r,linkService:u,page:i,renderForms:s,viewport:nt};H.innerHTML="";try{new pdfjs.AnnotationLayer(Q).render(Z),j()}catch(it){U(it)}return()=>{}}return reactExports.useEffect(G,[g,r,u,i,s,I]),React.createElement("div",{className:clsx("react-pdf__Page__annotations","annotationLayer"),ref:S})}var __rest=function(A,n){var _={};for(var r in A)Object.prototype.hasOwnProperty.call(A,r)&&n.indexOf(r)<0&&(_[r]=A[r]);if(A!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,r=Object.getOwnPropertySymbols(A);u<r.length;u++)n.indexOf(r[u])<0&&Object.prototype.propertyIsEnumerable.call(A,r[u])&&(_[r[u]]=A[r[u]]);return _};const defaultScale=1,Page=function A(n){const _=useDocumentContext(),r=Object.assign(Object.assign({},_),n),{_className:u="react-pdf__Page",_enableRegisterUnregisterPage:w=!0,canvasBackground:T,canvasRef:N,children:F,className:i,customRenderer:t,customTextRenderer:s,devicePixelRatio:c,error:l="Failed to load the page.",height:e,inputRef:h,loading:g="Loading page…",noData:o="No page specified.",onGetAnnotationsError:S,onGetAnnotationsSuccess:R,onGetStructTreeError:P,onGetStructTreeSuccess:p,onGetTextError:E,onGetTextSuccess:j,onLoadError:U,onLoadSuccess:I,onRenderAnnotationLayerError:G,onRenderAnnotationLayerSuccess:H,onRenderError:nt,onRenderSuccess:Q,onRenderTextLayerError:Z,onRenderTextLayerSuccess:it,pageIndex:K,pageNumber:L,pdf:b,registerPage:d,renderAnnotationLayer:f=!0,renderForms:y=!1,renderMode:M="canvas",renderTextLayer:D=!0,rotate:B,scale:C=defaultScale,unregisterPage:a,width:m}=r,v=__rest(r,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[x,k]=useResolver(),{value:O,error:W}=x,z=reactExports.useRef(null);invariant(b);const st=isProvided(L)?L-1:K??null,q=L??(isProvided(K)?K+1:null),X=B??(O?O.rotate:null),Y=reactExports.useMemo(()=>{if(!O)return null;let St=1;const kt=C??defaultScale;if(m||e){const et=O.getViewport({scale:1,rotation:X});m?St=m/et.width:e&&(St=e/et.height)}return kt*St},[e,O,X,C,m]);function J(){return()=>{isProvided(st)&&w&&a&&a(st)}}reactExports.useEffect(J,[w,b,st,a]);function tt(){if(I){if(!O||!Y)return;I(makePageCallback(O,Y))}if(w&&d){if(!isProvided(st)||!z.current)return;d(st,z.current)}}function rt(){W&&(warning(!1,W.toString()),U&&U(W))}function ot(){k({type:"RESET"})}reactExports.useEffect(ot,[k,b,st]);function lt(){if(!b||!q)return;const St=makeCancellablePromise(b.getPage(q)),kt=St;return St.promise.then(et=>{k({type:"RESOLVE",value:et})}).catch(et=>{k({type:"REJECT",error:et})}),()=>cancelRunningTask(kt)}reactExports.useEffect(lt,[k,b,st,q,d]),reactExports.useEffect(()=>{if(O!==void 0){if(O===!1){rt();return}tt()}},[O,Y]);const ct=reactExports.useMemo(()=>O&&isProvided(st)&&q&&isProvided(X)&&isProvided(Y)?{_className:u,canvasBackground:T,customTextRenderer:s,devicePixelRatio:c,onGetAnnotationsError:S,onGetAnnotationsSuccess:R,onGetStructTreeError:P,onGetStructTreeSuccess:p,onGetTextError:E,onGetTextSuccess:j,onRenderAnnotationLayerError:G,onRenderAnnotationLayerSuccess:H,onRenderError:nt,onRenderSuccess:Q,onRenderTextLayerError:Z,onRenderTextLayerSuccess:it,page:O,pageIndex:st,pageNumber:q,renderForms:y,renderTextLayer:D,rotate:X,scale:Y}:null,[u,T,s,c,S,R,P,p,E,j,G,H,nt,Q,Z,it,O,st,q,y,D,X,Y]),ht=reactExports.useMemo(()=>makeEventProps(v,()=>O&&(Y?makePageCallback(O,Y):void 0)),[v,O,Y]),dt=`${st}@${Y}/${X}`,_t=`${st}/${X}`;function pt(){switch(M){case"custom":return invariant(t),React.createElement(t,{key:`${dt}_custom`});case"none":return null;case"svg":return React.createElement(PageSVG,{key:`${_t}_svg`});case"canvas":default:return React.createElement(PageCanvas,{key:`${dt}_canvas`,canvasRef:N})}}function Et(){return D?React.createElement(TextLayer,{key:`${dt}_text`}):null}function gt(){return f?React.createElement(AnnotationLayer,{key:`${dt}_annotations`}):null}function vt(){return React.createElement(PageContext.Provider,{value:ct},pt(),Et(),gt(),F)}function Rt(){return q?b===null||O===void 0||O===null?React.createElement(Message,{type:"loading"},typeof g=="function"?g():g):b===!1||O===!1?React.createElement(Message,{type:"error"},typeof l=="function"?l():l):vt():React.createElement(Message,{type:"no-data"},typeof o=="function"?o():o)}return React.createElement("div",Object.assign({className:clsx(u,i),"data-page-number":q,ref:mergeRefs(h,z),style:{"--scale-factor":`${Y}`,backgroundColor:T||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},ht),Rt())},isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Page.propTypes=Object.assign(Object.assign({},eventProps),{canvasBackground:PropTypes.string,canvasRef:isRef,children:PropTypes.node,className:isClassName,customRenderer:PropTypes.func,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,width:PropTypes.number});displayWorkerWarning();pdfjs.GlobalWorkerOptions.workerSrc="pdf.worker.js";export{Document as D,Page as P,commonjsRequire as c,pdfjs as p,require$$5 as r};
