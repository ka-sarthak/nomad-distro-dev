import{r as l,j as e,q as g,ag as v,ah as S,ai as y,a$ as G,am as F,au as _,aj as D,B as T,bk as k,ae as A,X as I}from"./material-react-table-DBlzLFj3.js";import{a as R,e as p,aZ as V,u as N,af as O,a_ as P,T as i,I as E,a$ as M,b0 as W,k as x,b as B,P as K,S as U}from"./index-Db9INgJo.js";import"./@mapbox/rehype-prism-vXukC30A.js";import"./msw-BcASioFF.js";import"./react-pdf-C7aGFVic.js";import"./plotly.js-dist-min-EtOYGmgt.js";function $(){const s=R(),{user:a}=p(),[t,o]=l.useState(!1),[n,r]=l.useState(""),[h,c]=l.useState(""),b=()=>{r(""),c(""),o(!0)},d=()=>o(!1),j=u=>{r(u.target.value)},f=async()=>{if(!a)return;if(!s)throw new Error("API is not available");const u={group_name:n};try{const m=await s.post("groups",u,void 0);if(m){const w=m.group_id;d(),V(`/groups/${w}`)}}catch{c("An error occurred while creating the group.")}},C=u=>{u.preventDefault(),f()};return e.jsxs(e.Fragment,{children:[e.jsx(g,{variant:"contained",onClick:b,disabled:!a,children:"Create New Group"}),e.jsx(v,{open:t,onClose:d,maxWidth:"xs",fullWidth:!0,children:e.jsxs("form",{onSubmit:C,children:[e.jsx(S,{children:"Create New Group"}),e.jsxs(y,{children:[e.jsx(G,{children:"Enter the name of the new group:"}),e.jsx(F,{sx:{mt:1},label:"Group Name",size:"small",type:"string",value:n,onChange:j,fullWidth:!0,autoFocus:!0}),h&&e.jsx(_,{sx:{mt:1},severity:"error",onClose:()=>c(""),children:h})]}),e.jsxs(D,{children:[e.jsx(g,{onClick:d,children:"Cancel"}),e.jsx(g,{type:"submit",children:"Create"})]})]})})]})}function L(){return e.jsx(T,{children:e.jsx($,{})})}function q(s,a){return s?.owner?.user_id===a?"Owner":s?.members?.some(t=>t.user_id===a)?"Member":null}function z(){const{user:s}=p(),{navigate:a}=N(),t=O(P),o=l.useMemo(()=>Object.keys(t).filter(r=>r!=="m_response").map(r=>t[r]),[t]),n=l.useMemo(()=>[{accessorKey:"group_name",header:"Name",Cell:({cell:r})=>e.jsx(i,{value:r.getValue(),fullWidth:!0}),enableSorting:!0,grow:!0},{accessorKey:"owner.name",header:"Owner",Cell:({cell:r})=>e.jsx(i,{value:r.getValue()}),enableSorting:!1,grow:!0},{header:"Role",accessorFn:r=>q(r,s?.profile.sub),Cell:({cell:r})=>e.jsx(i,{value:r.getValue()}),enableSorting:!1,grow:!0},{id:"members",accessorFn:r=>r?.members?.length||"0",header:"Members",Cell:({cell:r})=>e.jsx(i,{value:r.getValue()}),enableSorting:!1,center:!0,grow:!0},{accessorKey:"group_id",header:"ID",Cell:({cell:r})=>e.jsx(E,{value:r.getValue(),abbreviated:!0}),enableSorting:!0,grow:!0}],[s?.profile.sub]);return e.jsx(M,{paginationType:"page",entityLabel:"group",getRowId:r=>r.group_id,onRowClick:r=>{a({path:r.group_id})},columns:n,data:o})}function X(){const{user:s}=p(),a=s?.profile.sub??"",[t,o]=W("user_id",a);return e.jsx(x,{children:e.jsx(k,{row:!0,children:e.jsx(A,{control:e.jsx(I,{disabled:!s,checked:!!s&&t===a,onChange:n=>{o(n.target.checked?a:"")}}),label:"Only my groups"})})})}function re(){const{pageVariant:s}=B(),[a,t]=l.useState("");return e.jsxs(K,{variant:s,title:"Groups",subtitle:"View and manage user groups here. Projects can also be shared with groups instead of single users.",children:[e.jsx(X,{}),e.jsx(x,{primaryActions:e.jsx(L,{}),search:e.jsx(U,{placeholder:"Search groups",value:a,onChange:o=>t(o.target.value),onClear:()=>t("")})}),e.jsx(z,{})]})}export{re as default};
