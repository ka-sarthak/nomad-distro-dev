import{h as I,j as n,R as b,q as z,a3 as j,o as p,ag as A,ah as k,ai as D,w as T,L,aj as B,bK as O,B as x,r as u,aV as H,aW as N,aX as F,O as W,aY as C}from"./material-react-table-DBlzLFj3.js";import{b1 as f,b2 as _,b3 as V,aW as E,b4 as G,b5 as q,b6 as v,b7 as R,p as U,aT as K,aS as X,b as Y,b8 as $,P as J,l as w,b9 as Q,k as Z,S as nn}from"./index-Db9INgJo.js";import{u as P}from"./useTools-Dx6cJ94L.js";import"./@mapbox/rehype-prism-vXukC30A.js";import"./msw-BcASioFF.js";import"./react-pdf-C7aGFVic.js";import"./plotly.js-dist-min-EtOYGmgt.js";const en=I(n.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M9 17H7v-7h2zm4 0h-2V7h2zm4 0h-2v-4h2z"}),"Assessment"),tn={stopped:"Launch",starting:"Launching...",running:"Stop",stopping:"Stopping...",error:"Not available"},sn=b.memo(function(s){return n.jsx(z,{color:"primary",variant:"contained",size:"small",...s})}),on=b.memo(function({toolName:s}){const{getTool:o,launchTool:l,stopTool:i,toolStates:r}=f(),d=o(s),a=r[s]?.state,h=()=>{a==="running"?i(s):a==="stopped"&&l(s)};return n.jsx(sn,{fullWidth:!0,name:d.name,onClick:h,disabled:a==="starting"||a==="stopping"||!a,children:a?tn[a]:"Not available"})});function M({tool:e}){const[s,o]=_(!1);return n.jsxs(n.Fragment,{children:[n.jsx(j,{title:"About this tool",children:n.jsx("span",{children:n.jsx(p,{size:"small","aria-label":"about",onClick:o,children:n.jsx(V,{})})})}),s&&n.jsxs(A,{open:!0,onClose:o,maxWidth:"md",fullWidth:!0,children:[n.jsxs(k,{children:["About ",e.title||e.name]}),n.jsxs(D,{children:[n.jsx(T,{sx:{mb:2},children:e.short_description}),n.jsx(E,{content:e.description}),e.maintainer&&n.jsxs(T,{variant:"body1",children:[n.jsx("b",{children:"Maintainer: "}),e.maintainer.map((l,i)=>n.jsxs(n.Fragment,{children:[i>0&&", ",n.jsx(L,{href:`mailto:${l.email}`,children:l.name},i)]}))]}),e.file_extensions&&e.file_extensions.length>0&&n.jsxs(T,{variant:"body1",children:[n.jsx("b",{children:"File extensions: "}),n.jsx("span",{children:e.file_extensions.join(", ")})]})]}),n.jsx(B,{children:n.jsx(z,{"aria-label":"close",onClick:o,children:"Close"})})]})]})}function an({onPin:e}){return n.jsx(j,{title:"Unpin app",children:n.jsx(p,{size:"small","aria-label":"pin",color:"primary",onClick:()=>e?.(),children:n.jsx(G,{})})})}const ln=b.memo(function({toolName:s,onPin:o}){const{getTool:l,openTool:i,toolStates:r}=f(),d=l(s);if(!d)return;const{title:a,icon:h,short_description:m,name:t}=d,c=r[s]?.state;return n.jsx(q,{height:145,title:a||t,description:m,avatar:n.jsx(O,{component:"img",image:v(h),alt:"Tool Icon",sx:{height:32,objectFit:"contain",padding:0}}),actions:[n.jsx(M,{tool:d},"description"),n.jsx(p,{color:"primary",size:"small",disabled:c!=="running",onClick:()=>i(s),children:n.jsx(R,{})},"open"),n.jsx(an,{onPin:o},"pin"),n.jsx(x,{sx:{flexGrow:1},children:n.jsx(on,{toolName:s})},"tool")]})}),rn=15,cn=U();function dn({tool:e}){const{launchTool:s,stopTool:o,toolStates:l,openTool:i}=f(),r=l[e.name]?.state,d=async()=>{await s(e.name)},a=async()=>{await o(e.name)},h=u.useCallback(async()=>{i(e.name)},[e,i]);return n.jsxs(n.Fragment,{children:[n.jsx(M,{tool:e}),n.jsx(p,{color:"primary",size:"small",disabled:r!=="running",onClick:h,children:n.jsx(R,{})}),n.jsxs(x,{sx:{display:"flex",alignItems:"center"},children:[r=="stopped"&&n.jsx(j,{title:"Launch Tool",children:n.jsx(p,{color:"primary",size:"small",onClick:d,children:n.jsx(K,{fontSize:"small"})})}),r=="running"&&n.jsx(j,{title:"Stop Tool",children:n.jsx(p,{color:"error",size:"small",onClick:a,children:n.jsx(X,{fontSize:"small"})})}),(r==="starting"||r==="stopping")&&n.jsx(p,{size:"small",children:n.jsx(W,{size:20})})]})]})}function hn({tools:e,pinnedToolIds:s,togglePinnedTool:o,globalFilter:l}){const i=u.useMemo(()=>H(),[]),r=u.useMemo(()=>[i.accessor(t=>t.title||t.name,{id:"title",header:"Tool Name",size:50,Cell:({row:t})=>{const c=t.original.icon,y=t.original.title||t.original.name;return n.jsxs(x,{sx:{display:"flex",alignItems:"center",gap:1},children:[c?n.jsx(x,{component:"img",src:v(c),alt:"Tool Icon",sx:{height:20,width:20,objectFit:"contain"}}):n.jsx(x,{sx:{height:20,width:20,display:"flex",justifyContent:"center",alignItems:"center"},children:n.jsx(en,{sx:{fontSize:20}})}),y]})}}),i.accessor("state",{header:"State",size:50}),i.accessor("short_description",{header:"Description"})],[i]),d=u.useMemo(()=>({columnPinning:{right:["mrt-row-actions"]},pagination:{pageIndex:0,pageSize:rn},density:"compact",sorting:[{id:"title",desc:!1}]}),[]),a=t=>{if(typeof t!="function")return;const c=s,S=t({top:c,bottom:[]}).top||[];[...S.filter(g=>!c.includes(g)),...c.filter(g=>!S.includes(g))].forEach(g=>o?.(g))},h=u.useMemo(()=>({rowPinning:{top:s.filter(t=>e.some(c=>c.name===t))},globalFilter:l}),[s,e,l]),m=N({...cn,columns:r,data:e,initialState:d,state:h,getRowId:t=>t.name,onRowPinningChange:a,enableRowActions:!0,enableRowPinning:!0,rowPinningDisplayMode:"top",displayColumnDefOptions:{"mrt-row-actions":{header:"",grow:0,size:110,minSize:void 0,maxSize:void 0}},renderRowActions:({row:t})=>n.jsx(dn,{tool:t.original}),muiTableBodyCellProps:({column:t})=>({onClick:["mrt-row-pin","mrt-row-actions"].includes(t.id)?c=>c.stopPropagation():void 0,sx:{cursor:["mrt-row-pin","mrt-row-actions"].includes(t.id)?"default":void 0}})});return n.jsx(F,{table:m})}function un({pinnedTools:e,togglePinnedTool:s}){return n.jsx(C,{container:!0,spacing:2,children:e.map(o=>n.jsx(C,{size:{xs:12,sm:6,md:4,lg:3},children:n.jsx(ln,{toolName:o.name,onPin:()=>s(o.name)})},o.name))})}const Sn=u.memo(function(){const{data:s}=P();f(s);const{pageVariant:o}=Y(),{data:l}=P(),[i,r]=u.useState(""),[d,a]=$("northTools"),h=u.useMemo(()=>l?Object.values(l).map(t=>({...t})):[],[l]),m=u.useMemo(()=>d.map(t=>h.find(c=>c.name===t)).filter(Boolean),[d,h]);return n.jsxs(J,{variant:o,title:"NOMAD Remote Tools Hub (NORTH)",subtitle:`
          NORTH allows you to run pre-configured applications directly on the server. With
          NORTH you can access, analyze, and create data directly in your uploads, using
          your favorite tools, no setup required.
        `,children:[n.jsx(w,{variant:"h2",sx:{mt:2},children:"Pinned Tools"}),m.length===0?n.jsx(Q,{height:195,title:"Pinned tools will appear here"}):n.jsx(un,{pinnedTools:m,togglePinnedTool:a}),n.jsx(Z,{sx:{mt:2},title:n.jsx(w,{variant:"h2",sx:{mt:0,mb:0},children:"Available Tools"}),search:n.jsx(nn,{placeholder:"Search tools",value:i,onChange:t=>r(t.target.value),onClear:()=>r("")})}),n.jsx(x,{sx:{mt:2},children:n.jsx(hn,{tools:h,pinnedToolIds:d,togglePinnedTool:a,globalFilter:i})})]})});export{Sn as default};
