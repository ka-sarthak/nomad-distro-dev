import{r as l,j as e,o as g,ak as v,al as y,am as S,b0 as G,aq as F,ay as D,an as T,B as _,bk as k,ai as A,a0 as I}from"./material-react-table-Clsq1WEk.js";import{a as R,au as p,av as V,u as N,ab as O,aw as P,T as i,I as E,ax as M,ay as W,d as x,b as B,P as K,S as U}from"./index-ByzPaSZm.js";import"./@mapbox/rehype-prism-vXukC30A.js";import"./msw-BcASioFF.js";import"./react-pdf-CnhbYwCo.js";import"./plotly.js-dist-min-EtOYGmgt.js";function L(){const a=R(),{user:s}=p(),[t,o]=l.useState(!1),[n,r]=l.useState(""),[h,c]=l.useState(""),b=()=>{r(""),c(""),o(!0)},d=()=>o(!1),j=u=>{r(u.target.value)},f=async()=>{if(!s)return;if(!a)throw new Error("API is not available");const u={group_name:n};try{const m=await a.post("groups",u,void 0);if(m){const w=m.group_id;d(),V(`/groups/${w}`)}}catch{c("An error occurred while creating the group.")}},C=u=>{u.preventDefault(),f()};return e.jsxs(e.Fragment,{children:[e.jsx(g,{variant:"contained",onClick:b,disabled:!s,children:"Create New Group"}),e.jsx(v,{open:t,onClose:d,maxWidth:"xs",fullWidth:!0,children:e.jsxs("form",{onSubmit:C,children:[e.jsx(y,{children:"Create New Group"}),e.jsxs(S,{children:[e.jsx(G,{children:"Enter the name of the new group:"}),e.jsx(F,{sx:{mt:1},label:"Group Name",size:"small",type:"string",value:n,onChange:j,fullWidth:!0,autoFocus:!0}),h&&e.jsx(D,{sx:{mt:1},severity:"error",onClose:()=>c(""),children:h})]}),e.jsxs(T,{children:[e.jsx(g,{onClick:d,children:"Cancel"}),e.jsx(g,{type:"submit",children:"Create"})]})]})})]})}function q(){return e.jsx(_,{children:e.jsx(L,{})})}function z(a,s){return a?.owner?.user_id===s?"Owner":a?.members?.some(t=>t.user_id===s)?"Member":null}function $(){const{user:a}=p(),{navigate:s}=N(),t=O(P),o=l.useMemo(()=>Object.keys(t).filter(r=>r!=="m_response").map(r=>t[r]),[t]),n=l.useMemo(()=>[{accessorKey:"group_name",header:"Name",Cell:({cell:r})=>e.jsx(i,{value:r.getValue(),fullWidth:!0}),enableSorting:!0,grow:!0},{accessorKey:"owner.name",header:"Owner",Cell:({cell:r})=>e.jsx(i,{value:r.getValue()}),enableSorting:!1,grow:!0},{header:"Role",accessorFn:r=>z(r,a?.profile.sub),Cell:({cell:r})=>e.jsx(i,{value:r.getValue()}),enableSorting:!1,grow:!0},{id:"members",accessorFn:r=>r?.members?.length||"0",header:"Members",Cell:({cell:r})=>e.jsx(i,{value:r.getValue()}),enableSorting:!1,center:!0,grow:!0},{accessorKey:"group_id",header:"ID",Cell:({cell:r})=>e.jsx(E,{value:r.getValue(),abbreviated:!0}),enableSorting:!0,grow:!0}],[a?.profile.sub]);return e.jsx(M,{paginationType:"page",entityLabel:"group",getRowId:r=>r.group_id,onRowClick:r=>{s({path:r.group_id})},columns:n,data:o})}function H(){const{user:a}=p(),s=a?.profile.sub??"",[t,o]=W("user_id",s);return e.jsx(x,{children:e.jsx(k,{row:!0,children:e.jsx(A,{control:e.jsx(I,{disabled:!a,checked:!!a&&t===s,onChange:n=>{o(n.target.checked?s:"")}}),label:"Only my groups"})})})}function re(){const{pageVariant:a}=B(),[s,t]=l.useState("");return e.jsxs(K,{variant:a,title:"Groups",subtitle:"View and manage user groups here. Projects can also be shared with groups instead of single users.",children:[e.jsx(H,{}),e.jsx(x,{primaryActions:e.jsx(q,{}),search:e.jsx(U,{placeholder:"Search groups",value:s,onChange:o=>t(o.target.value),onClear:()=>t("")})}),e.jsx($,{})]})}export{re as default};
