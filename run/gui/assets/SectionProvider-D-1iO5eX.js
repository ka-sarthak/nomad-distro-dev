import{h as rt,j as o,R as le,al as st,r as w,o as Y,B as te,w as we,af as Be,an as De,am as be,bL as at,b8 as ze,O as ot,L as lt}from"./material-react-table-DBlzLFj3.js";import{R as ut,N as de,bc as ct,u as We,bg as Le,ah as dt,ag as ft,i as I,aM as ht,aH as Me,L as $e,aI as Ie,bh as q,bi as mt,bj as pt,aN as G,bk as He,bl as gt,bm as oe,bn as vt,bo as bt,m as _t,T as H,bp as yt,bq as xt,V as Je,br as Qe,bs as Ct,bt as wt,bu as $t,f as qe,J as kt,bv as jt,bw as Et,bx as Ye,aJ as ie,D as St,I as Dt,C as zt,by as Tt,bz as K}from"./index-Db9INgJo.js";import{L as Lt}from"./List-C8YnYSw4.js";import{B as Mt,E as It}from"./Boolean-4Uc0VIHp.js";import{S as Ot}from"./Select-C8GMJQX4.js";import{g as Ze}from"./@mapbox/rehype-prism-vXukC30A.js";const Nt=rt(o.jsx("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"}),"OpenInNew");function Ut(e,n){const{property:t,label:a}=e;return a||At(t,n)}function At(e,n){const t=n?.m_annotations?.display?.label,a=n?.m_annotations?.eln;if(t){if(typeof t=="string")return t;throw new Error("Unsupported format for label annotation")}const i=a?.label||n?.more?.label||n?.label;if(i)return i;let r=(n?.name||e).replace(/_/g," ");return(n?.m_def==="nomad.metainfo.metainfo.Section"||n?.m_def==="nomad.metainfo.metainfo.SubSection")&&(r=r.replace(/([a-z])([A-Z])/g,"$1 $2")),Rt(r)}const Rt=e=>typeof e!="string"?"":e.charAt(0).toUpperCase()+e.slice(1),Ke=le.createContext({});function Pt(e){const{path:n}=le.useContext(Ke);return n?`${n}/${e}`:e}function Ft({label:e,property:n,editable:t,forceExpand:a}){const{url:i,fullMatch:r}=We(),{value:u,getDefinition:m,change:f,path:p}=n,x=w.useMemo(()=>m(),[m])?.repeats,l=w.useMemo(()=>{const v=r.findIndex(E=>Le(E.route,dt)),T=r.findIndex(E=>Le(E.route,ft));return v===-1?T:v},[r]),_=r.filter((v,T)=>T<=l).map(v=>v.path).join("/")+"/archive",g=w.useCallback((v,T)=>{v.stopPropagation(),v.nativeEvent.stopImmediatePropagation(),v.preventDefault(),x?(I(T!==void 0,"Update operation on repeating sub section without index"),f("remove",ht(u||[],T,1),T)):f("remove",void 0)},[x,f,u]),C=w.useCallback(v=>{v.stopPropagation(),v.nativeEvent.stopImmediatePropagation(),v.preventDefault();const T={m_def:m()?.sub_section};x?(I(u===void 0||Array.isArray(u)),f("upsert",[...u||[],T],(u||[]).length)):f("upsert",T)},[x,f,u,m]),[z,b]=w.useState(!1),y=w.useCallback(()=>{b(v=>!v)},[]);if(x){I(u===void 0||Array.isArray(u));const v=u||[];return o.jsx(de,{label:e,variant:"wide",expandable:!0,expanded:a||z,onToggle:y,onSelect:y,actions:t&&o.jsx(Y,{component:"span",size:"small",onClick:C,"aria-label":"add",title:"add",children:o.jsx(Me,{})}),sx:{margin:-1,"& .NavItem-button":{paddingX:1.5}},children:(a||z)&&o.jsx(te,{sx:{display:"flex",flexDirection:"column",gap:2,marginBottom:1},children:v.length===0?o.jsx(we,{sx:T=>({marginLeft:6,fontStyle:"italic",color:T.palette.action.disabled}),children:"empty"}):v.map((T,E)=>o.jsx(de,{variant:"wide",label:`${E}`,expandable:!1,expanded:!1,component:$e,to:i({path:`${_}/${p}/${E}`}),actions:t&&o.jsx(Y,{component:"span",size:"small",onClick:O=>g(O,E),"aria-label":"remove",title:"remove",children:o.jsx(Ie,{})}),sx:{margin:-1,"& .NavItem-button":{paddingLeft:6}}},E))})})}return o.jsx(de,{disabled:u===void 0,label:e,expandable:!1,expanded:!1,component:$e,to:i({path:`${_}/${p}`}),variant:"wide",sx:{margin:-1,"& .NavItem-button":{paddingX:1.5}},actions:t&&(u!==void 0?o.jsx(Y,{component:"span",size:"small",onClick:g,"aria-label":"remove",title:"remove",children:o.jsx(Ie,{})}):o.jsx(Y,{component:"span",size:"small",onClick:C,"aria-label":"add",title:"add",sx:{pointerEvents:"auto"},children:o.jsx(Me,{})}))})}function Dn({layout:e,forceExpand:n}){const t=e,{property:a,editable:i,disableUnavailable:r}=t,u=Ut(t),m=Pt(a),f=ut(m),{loading:p,value:j}=f;return p?o.jsx(st,{children:o.jsx(de,{label:"loading",variant:"treeNode",sx:{margin:-1}})}):ct(i,r,j)?o.jsx(Ft,{label:u,property:f,editable:i,forceExpand:n}):null}function Vt(e){const{editable:n,edit:t,onEditChange:a}=q(),i=w.useCallback(()=>{a?.(!t)},[t,a]);if(n)return o.jsx(mt,{...e,children:o.jsx(Y,{onClick:i,size:"small",children:t?o.jsx(pt,{}):o.jsx(Be,{})})})}let Q;typeof window<"u"?Q=window:typeof self<"u"?Q=self:Q=global;let ke=null,je=null;const Oe=20,_e=Q.clearTimeout,Ne=Q.setTimeout,ye=Q.cancelAnimationFrame||Q.mozCancelAnimationFrame||Q.webkitCancelAnimationFrame,Ue=Q.requestAnimationFrame||Q.mozRequestAnimationFrame||Q.webkitRequestAnimationFrame;ye==null||Ue==null?(ke=_e,je=function(n){return Ne(n,Oe)}):(ke=function([n,t]){ye(n),_e(t)},je=function(n){const t=Ue(function(){_e(a),n()}),a=Ne(function(){ye(t),n()},Oe);return[t,a]});function Bt(e){let n,t,a,i,r,u,m;const f=typeof document<"u"&&document.attachEvent;if(!f){u=function(b){const y=b.__resizeTriggers__,v=y.firstElementChild,T=y.lastElementChild,E=v.firstElementChild;T.scrollLeft=T.scrollWidth,T.scrollTop=T.scrollHeight,E.style.width=v.offsetWidth+1+"px",E.style.height=v.offsetHeight+1+"px",v.scrollLeft=v.scrollWidth,v.scrollTop=v.scrollHeight},r=function(b){return b.offsetWidth!==b.__resizeLast__.width||b.offsetHeight!==b.__resizeLast__.height},m=function(b){if(b.target.className&&typeof b.target.className.indexOf=="function"&&b.target.className.indexOf("contract-trigger")<0&&b.target.className.indexOf("expand-trigger")<0)return;const y=this;u(this),this.__resizeRAF__&&ke(this.__resizeRAF__),this.__resizeRAF__=je(function(){r(y)&&(y.__resizeLast__.width=y.offsetWidth,y.__resizeLast__.height=y.offsetHeight,y.__resizeListeners__.forEach(function(E){E.call(y,b)}))})};let l=!1,_="";a="animationstart";const g="Webkit Moz O ms".split(" ");let C="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),z="";{const b=document.createElement("fakeelement");if(b.style.animationName!==void 0&&(l=!0),l===!1){for(let y=0;y<g.length;y++)if(b.style[g[y]+"AnimationName"]!==void 0){z=g[y],_="-"+z.toLowerCase()+"-",a=C[y],l=!0;break}}}t="resizeanim",n="@"+_+"keyframes "+t+" { from { opacity: 0; } to { opacity: 0; } } ",i=_+"animation: 1ms "+t+"; "}const p=function(l){if(!l.getElementById("detectElementResize")){const _=(n||"")+".resize-triggers { "+(i||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',g=l.head||l.getElementsByTagName("head")[0],C=l.createElement("style");C.id="detectElementResize",C.type="text/css",e!=null&&C.setAttribute("nonce",e),C.styleSheet?C.styleSheet.cssText=_:C.appendChild(l.createTextNode(_)),g.appendChild(C)}};return{addResizeListener:function(l,_){if(f)l.attachEvent("onresize",_);else{if(!l.__resizeTriggers__){const g=l.ownerDocument,C=Q.getComputedStyle(l);C&&C.position==="static"&&(l.style.position="relative"),p(g),l.__resizeLast__={},l.__resizeListeners__=[],(l.__resizeTriggers__=g.createElement("div")).className="resize-triggers";const z=g.createElement("div");z.className="expand-trigger",z.appendChild(g.createElement("div"));const b=g.createElement("div");b.className="contract-trigger",l.__resizeTriggers__.appendChild(z),l.__resizeTriggers__.appendChild(b),l.appendChild(l.__resizeTriggers__),u(l),l.addEventListener("scroll",m,!0),a&&(l.__resizeTriggers__.__animationListener__=function(v){v.animationName===t&&u(l)},l.__resizeTriggers__.addEventListener(a,l.__resizeTriggers__.__animationListener__))}l.__resizeListeners__.push(_)}},removeResizeListener:function(l,_){if(f)l.detachEvent("onresize",_);else if(l.__resizeListeners__.splice(l.__resizeListeners__.indexOf(_),1),!l.__resizeListeners__.length){l.removeEventListener("scroll",m,!0),l.__resizeTriggers__.__animationListener__&&(l.__resizeTriggers__.removeEventListener(a,l.__resizeTriggers__.__animationListener__),l.__resizeTriggers__.__animationListener__=null);try{l.__resizeTriggers__=!l.removeChild(l.__resizeTriggers__)}catch{}}}}}class Wt extends w.Component{constructor(...n){super(...n),this.state={height:this.props.defaultHeight||0,scaledHeight:this.props.defaultHeight||0,scaledWidth:this.props.defaultWidth||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;const{disableHeight:t,disableWidth:a,onResize:i}=this.props;if(this._parentNode){const r=window.getComputedStyle(this._parentNode)||{},u=parseFloat(r.paddingLeft||"0"),m=parseFloat(r.paddingRight||"0"),f=parseFloat(r.paddingTop||"0"),p=parseFloat(r.paddingBottom||"0"),j=this._parentNode.getBoundingClientRect(),x=j.height-f-p,l=j.width-u-m,_=this._parentNode.offsetHeight-f-p,g=this._parentNode.offsetWidth-u-m;(!t&&(this.state.height!==_||this.state.scaledHeight!==x)||!a&&(this.state.width!==g||this.state.scaledWidth!==l))&&(this.setState({height:_,width:g,scaledHeight:x,scaledWidth:l}),typeof i=="function"&&i({height:_,scaledHeight:x,scaledWidth:l,width:g}))}},this._setRef=t=>{this._autoSizer=t}}componentDidMount(){const{nonce:n}=this.props,t=this._autoSizer?this._autoSizer.parentNode:null;if(t!=null&&t.ownerDocument&&t.ownerDocument.defaultView&&t instanceof t.ownerDocument.defaultView.HTMLElement){this._parentNode=t;const a=t.ownerDocument.defaultView.ResizeObserver;a!=null?(this._resizeObserver=new a(()=>{this._timeoutId=setTimeout(this._onResize,0)}),this._resizeObserver.observe(t)):(this._detectElementResize=Bt(n),this._detectElementResize.addResizeListener(t,this._onResize)),this._onResize()}}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),this._timeoutId!==null&&clearTimeout(this._timeoutId),this._resizeObserver&&this._resizeObserver.disconnect())}render(){const{children:n,defaultHeight:t,defaultWidth:a,disableHeight:i=!1,disableWidth:r=!1,doNotBailOutOnEmptyChildren:u=!1,nonce:m,onResize:f,style:p={},tagName:j="div",...x}=this.props,{height:l,scaledHeight:_,scaledWidth:g,width:C}=this.state,z={overflow:"visible"},b={};let y=!1;return i||(l===0&&(y=!0),z.height=0,b.height=l,b.scaledHeight=_),r||(C===0&&(y=!0),z.width=0,b.width=C,b.scaledWidth=g),u&&(y=!1),w.createElement(j,{ref:this._setRef,style:{...z,...p},...x},!y&&n(b))}}function Ht({unit:e,onChange:n,error:t,onError:a,additionalUnitOptions:i=[],autocompleteProps:r,textFieldProps:u,sx:m={}}){const f=w.useCallback(C=>C.formatUnits(),[]),[p,j]=G(e,{transform:f}),x=w.useCallback(C=>{if(!C){a?.(void 0);return}const{value:z,error:b}=He(C,e);if(b||z===void 0){a?.(b);return}a?.(void 0),n?.(z)},[e,n,a]),l=w.useCallback((C,z)=>{j(z),x(z)},[j,x]),_=w.useMemo(()=>gt(e.dimension()).map(C=>oe(C).formatUnits()),[e]),g=w.useMemo(()=>[...[e.formatUnits(),...i].filter(C=>!_.includes(C)),..._],[e,_,i]);return o.jsx(De,{sx:m,...r,freeSolo:!0,disableClearable:!0,includeInputInList:!0,openOnFocus:!0,options:g,value:p,onChange:l,componentsProps:{popper:{style:{width:"fit-content"},placement:"bottom-start"}},popupIcon:null,renderInput:C=>o.jsx(be,{...C,...u,error:!!t})})}function Ge({variant:e="edit",...n}){const{label:t,error:a,onError:i,displayUnitLocked:r,onDisplayUnitLockedChange:u,displayUnit:m,onDisplayUnitChange:f,onBlur:p,onFocus:j,unitSelectProps:x}=q(n),l=w.useMemo(()=>(I(!!m,"unit or displayUnit must be defined to use Unit"),oe(m)),[m]),_=w.useMemo(()=>({onBlur:p,onFocus:j,sx:{width:80}}),[p,j]),g=w.useCallback(b=>{f(b.formatUnits())},[f]),C=w.useCallback(b=>{b.stopPropagation(),u?.(!r)},[r,u]),z=r!==void 0&&o.jsx(Y,{size:"small",onClick:C,"aria-label":"lock",children:r?o.jsx(vt,{}):o.jsx(bt,{})});return o.jsxs(te,{sx:{display:"flex",alignItems:"center",flexDirection:"row",flexWrap:"nowrap"},children:[z,o.jsx(Ht,{textFieldProps:{size:"small",margin:"none",label:t&&"unit",hiddenLabel:!t,variant:e==="edit"?"filled":"standard",sx:e==="edit"?void 0:{marginBottom:"-10px","& .MuiInput-underline:before":{borderBottom:"none"}}},...x,unit:l,onChange:g,error:a,onError:i,autocompleteProps:_})]})}const Ae=15,xe=2;function Xe(e){if(e===void 0)return[];if(!Array.isArray(e))return[];const n=Xe(e[0]);return[e.length,...n]}function Jt({renderValue:e,transpose:n=!1,height:t,width:a,rowHeight:i=32,columnWidth:r=100,displayColumns:u=5,displayRows:m=5,children:f,...p}){p=q(p);const{value:j,label:x,fullWidth:l,displayUnit:_,unit:g,onDisplayUnitChange:C}=p,z=w.useMemo(()=>Xe(j),[j]),[b,y]=w.useState(new Array(Math.max(0,z.length-2)).fill(0)),[v,T]=G(_||g,{onChange:C}),E={...p,displayUnit:v,onDisplayUnitChange:T,displayUnitLocked:void 0},O=w.useMemo(()=>{let L;if(z.length!==0)return z.length===1?L=[j]:z.length===2?L=j:L=_t.get(j,b),I(L!==void 0,`Unsupported value shape ${z}`),n&&(L=L[0].map((S,U)=>L.map(B=>B[U]))),L},[j,b,z,n]),M=w.useMemo(()=>b.reduce((L,S)=>L*S+L,1),[b]),R=({columnIndex:L,rowIndex:S,style:U})=>o.jsx("div",{style:{...U,paddingLeft:4,paddingRight:4,textAlign:"center"},children:o.jsx(Je,{value:O?.[S][L],hiddenUnit:!0,editable:!1,fullWidth:!0,children:e?.({})})}),V=O===void 0?o.jsx(H,{value:void 0}):o.jsxs(o.Fragment,{children:[o.jsx(te,{sx:{borderLeft:xe,borderRight:xe,paddingX:.5,...l?{width:"100%"}:{width:a||"max-content"},height:t||"max-content"},children:o.jsx(Wt,{doNotBailOutOnEmptyChildren:!0,style:{height:"max-content",width:l?"100%":"max-content"},children:({width:L})=>{const S=O.length,U=O[0].length,B=U*r>L,$=S>m,h=t||Math.min(m,S)*i+(B?Ae:0),d=l?L-2*xe:Math.min(u,U)*r+($?Ae:0);return o.jsx(yt,{columnCount:U,columnWidth:r,height:h,rowCount:S,rowHeight:i,width:d,children:R})}},M)}),o.jsxs(te,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end",marginTop:.5},children:[b.map((L,S)=>o.jsx(at,{count:z[S],page:L+1,size:"small",showFirstButton:!0,showLastButton:!0,onChange:(U,B)=>{const $=[...b];$[S]=B-1,y($)}},S)),(g||v)&&o.jsx(Ge,{variant:"standard"})]})]});return o.jsx(xt,{showLabel:!0,...E,children:o.jsx(ze,{sx:{width:E.fullWidth?"100%":"inherit"},marginTop:x?3:void 0,children:V})})}function et(e){const{allowNone:n,allowCustom:t,values:a,value:i,onChange:r,edit:u,editable:m,onError:f,table:p,error:j,inputRef:x,inputProps:l,inputId:_,...g}=q(e),{label:C,placeholder:z,...b}=g,y=u===void 0?m:u;w.useEffect(()=>{!t&&i&&!a.includes(i)&&f?.(`Invalid value: ${i}`)},[t,i,a,f]);const v=w.useCallback((T,E)=>{if(E===null||E===""){r?.(void 0);return}if(!t&&!a.includes(E)){f?.(`Invalid value: ${E}`);return}r?.(E)},[r,f,a,t]);return y?o.jsx(Qe,{variant:"standard",...b,children:o.jsx(De,{freeSolo:!!t,disableClearable:!n,disablePortal:!0,fullWidth:!0,options:a,autoSelect:!1,blurOnSelect:!1,value:i??null,onChange:v,renderInput:T=>o.jsx(be,{...T,InputProps:{...T.InputProps,disableUnderline:p,id:_,...l},inputProps:{...T.inputProps,role:"combobox",onBlur:E=>{T.inputProps.onBlur?.(E),!t&&E.target.value&&!a.includes(E.target.value)&&f?.(`Invalid value: ${E.target.value}`)}},placeholder:z,variant:p?"standard":"filled",size:"small",margin:"none",label:C,hiddenLabel:!C,inputRef:x})})}):o.jsx(H,{value:i,...g})}function Qt(e){const{value:n,onChange:t,error:a,onError:i,editable:r,edit:u,placeholder:m,fullWidth:f,label:p,layout:j="Author",submitOnTypingDelay:x=700}=q(e),l=u??r??!1,_=j==="User",{setQuery:g,suggestions:C,searching:z,getUsers:b}=Ct(x,i),[y,v]=w.useState(void 0),[T,E]=w.useState(!1),[O,M]=w.useState(void 0),R=w.useCallback(()=>{n?.user_id&&n.user_id!==O?b({user_id:n.user_id}).then(c=>{c.length?(v(c[0]),M(n.user_id)):(v(void 0),M(void 0))}).catch(()=>{v(void 0),M(void 0)}):n?.user_id||(v(void 0),M(void 0))},[n?.user_id,O,b]);w.useEffect(()=>{R()},[R]);const V=w.useCallback(c=>!!c.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/),[]),L=w.useCallback(c=>{const s=c.name??[c.first_name,c.last_name].filter(Boolean).join(" ");return c.affiliation?`${s} (${c.affiliation})`:s},[]),S=w.useMemo(()=>C.map(L),[C,L]),U=w.useMemo(()=>y?L(y):void 0,[y,L]),B=w.useCallback(c=>{if(E(!0),c){const s=C.find(k=>L(k)===c);if(s){const k={user_id:s.user_id,first_name:s.first_name,last_name:s.last_name,affiliation:s.affiliation,affiliation_address:s.affiliation_address,email:void 0};t?.(k),v(s),M(s.user_id)}else t?.(void 0),v(void 0),M(void 0)}else t?.(void 0),v(void 0),M(void 0);g("")},[t,C,L,g]),$=w.useCallback(c=>{const s=c.target.value;T||g(s),T&&E(!1)},[g,T]),h=w.useCallback((c,s)=>{n?.user_id||t?.({...n,[c]:s||void 0})},[t,n]),d=!!n?.user_id||!l;return o.jsxs(ze,{spacing:2,sx:{width:f?"100%":"auto"},children:[o.jsx(et,{label:_?p:"User account",placeholder:m,fullWidth:f,error:a,editable:l,value:U,values:S,onChange:B,allowNone:!0,allowCustom:!1,inputProps:{onChange:$,endAdornment:z?o.jsx(ot,{color:"inherit",size:20}):null},sx:{width:"100%"}}),!_&&o.jsxs(o.Fragment,{children:[o.jsx(we,{variant:"h6",sx:{mt:2,mb:1,color:"text.secondary"},children:"Or provide author information manually:"}),o.jsx(H,{label:"First name",value:n?.first_name,onChange:c=>h("first_name",c),editable:!d,fullWidth:f,placeholder:m,error:a,submitOnTypingDelay:x,sx:{width:"100%"}}),o.jsx(H,{label:"Last name",value:n?.last_name,onChange:c=>h("last_name",c),editable:!d,fullWidth:f,placeholder:m,error:a,submitOnTypingDelay:x,sx:{width:"100%"}}),o.jsx(H,{label:"Affiliation",value:n?.affiliation,onChange:c=>h("affiliation",c),editable:!d,fullWidth:f,placeholder:m,error:a,submitOnTypingDelay:x,sx:{width:"100%"}}),o.jsx(H,{label:"Email",value:n?.email,onChange:c=>{const s=c||"";(V(s)||s==="")&&h("email",s)},error:!!n?.email&&!V(n.email),editable:!d,fullWidth:f,placeholder:m,submitOnTypingDelay:x,sx:{width:"100%"}}),!!n?.email&&!V(n.email)&&!d&&o.jsx(we,{variant:"h5",color:"error",sx:{pl:"12px",mt:"-12px"},children:"Invalid email format"}),o.jsx(H,{label:"Address",value:n?.affiliation_address,onChange:c=>h("affiliation_address",c),editable:!d,fullWidth:f,placeholder:m,error:a,submitOnTypingDelay:x,sx:{width:"100%"}})]})]})}function qt(e){const{allowCustom:n,allowNone:t,values:a,value:i,onChange:r,edit:u,editable:m,onError:f,table:p,inputRef:j,inputProps:x,inputId:l,..._}=q(e),{placeholder:g}=_,{label:C,...z}=_,b=u===void 0?m:u,y=w.useCallback((v,T)=>{if(T===null){r?.(void 0);return}I(n||a.includes(T),`Invalid value: ${T}`),r?.(T)},[r,a,n]);return b?o.jsx(Qe,{variant:"standard",...z,children:o.jsx(De,{disableClearable:!t,freeSolo:n,fullWidth:!0,options:a,autoHighlight:!0,value:i||null,onChange:y,renderInput:v=>o.jsx(be,{...v,InputLabelProps:{shrink:!0,...v.InputLabelProps},placeholder:g,variant:p?"standard":"filled",size:"small",margin:"none",label:C,hiddenLabel:!C,InputProps:{...v.InputProps,disableUnderline:p,id:l}})})}):o.jsx(H,{value:i,..._})}function tt({label:e,selectOptions:n,initialPath:t,...a}){e=e||n.entity;const{value:i,onChange:r,onError:u,actions:m,...f}=q(a),{navigate:p,relativePath:j}=We(),{error:x}=f,[l,_]=G(i);w.useEffect(()=>{},[]);const g=w.useCallback(y=>{r?.(y||void 0)},[r]),C=w.useCallback(y=>{_(y||""),g(y)},[g,_]),z=w.useCallback(()=>{I(i!==void 0,"Open should only be possible with value.");const y=i.replace(/^((\.|#)\/)?/,"");y.startsWith("/")?p({path:y}):p({path:`${t}/${y}`})},[i,p,t]),b=w.useCallback(y=>{y=j(y,t),_(y),r?.(y)},[_,r,j,t]);return o.jsx(H,{value:l,onChange:C,...f,inputProps:{...f.inputProps,endAdornment:o.jsxs(o.Fragment,{children:[m,o.jsx(Y,{size:"small",onClick:z,disabled:x||!i,title:"Open",children:o.jsx(wt,{})}),o.jsx($t,{children:o.jsx(Ot,{selectOptions:n,initialPath:t,component:Y,title:`Select ${e}`,description:`Select the ${e} that you want to reference.`,selectButtonLabel:`Select ${e}`,onSelect:b,size:"small",children:o.jsx(Be,{})})})]})},displayStringProps:x&&i!==void 0?void 0:{component:$e,to:i},submitOnTypingDelay:-1})}function Yt({filePattern:e,...n}){const{upload_id:t,mainfile_path:a}=qe();I(a,"mainfile_path is required");const i={entity:"file",filePattern:e},r=a.replace(/[^/]+$/,"").replace(/^\/?/,""),u=`/uploads/${t}/files/${r}`.replace(/\/$/,"");return o.jsx(tt,{...n,selectOptions:i,initialPath:u})}function Zt({...e}){const{edit:n,editable:t,error:a,onError:i,onChange:r,placeholder:u,value:m,fullWidth:f,onBlur:p,onFocus:j,actions:x,inputId:l}=q(e),_=n===void 0?t:n,g=w.useCallback(M=>M===void 0?"":JSON.stringify(M,null,2),[]),[C,z,b]=G(m,{transform:g}),y=w.useCallback(M=>{z(M.target.value)},[z]),v=w.useCallback(M=>{M===""&&(r?.(void 0),i?.(void 0));try{const R=JSON.parse(M);r?.(R),i?.(void 0),z(g(R))}catch(R){I(R instanceof Error,"Invalid JSON"),i?.(R.message)}},[i,r,z,g]),T=w.useCallback(M=>{v(b.current),p?.(M)},[p,v,b]),E=w.useCallback(M=>{M.key==="Enter"&&M.shiftKey===!0&&(M.stopPropagation(),M.preventDefault(),v(b.current))},[v,b]);let O;return _?O=o.jsx(be,{sx:{width:"100%",display:"flex",flexDirection:"row","& .MuiInputBase-root":{flexGrow:1}},margin:"none",hiddenLabel:!0,multiline:!0,variant:"filled",error:a,fullWidth:f,value:C,placeholder:u,onBlur:T,onFocus:j,onKeyDown:E,onChange:y,inputProps:{style:{width:"100%",fontFamily:"monospace",textWrap:"nowrap",whiteSpace:"pre",overflow:"auto"},id:l}}):O=o.jsx(te,{sx:{width:f?"100%":void 0,marginY:1,overflow:"auto"},children:o.jsx(kt,{value:m})}),o.jsxs(te,{sx:{position:"relative",width:"100%"},children:[O,o.jsx(te,{sx:{position:"absolute",top:16,right:8},children:x})]})}function nt(e,n){jt(e,500,n)}function Ce(e){let n;try{n=new URL(e)}catch{return!1}return!(n.protocol!=="http:"&&n.protocol!=="https:")}function Kt({linkComponent:e=lt,...n}){const{value:t,onChange:a,onError:i,actions:r,...u}=q(n),{error:m}=u,[f,p]=G(t),j=w.useCallback(g=>{g?g&&!Ce(g)?i?.("Invalid URL"):(i?.(void 0),a?.(g)):a?.(void 0)},[a,i]),x=w.useCallback(g=>{p(g)},[p]),l=w.useCallback(g=>{j(g)},[j]);nt(()=>{f!==t&&f&&Ce(f)&&j(f)},[j,f,t]);const _=w.useCallback(()=>{window.open(t,"_blank")?.focus()},[t]);return o.jsx(H,{value:f,onSubmit:l,onInputChange:x,...u,inputProps:{...u.inputProps,endAdornment:o.jsxs(o.Fragment,{children:[r,o.jsx(Y,{size:"small",onClick:_,disabled:m||!f||f.trim()==="",children:o.jsx(Nt,{})})]})},displayStringProps:Ce(t)?{component:e,href:t}:void 0,submitOnTypingDelay:-1})}const Gt=Ye,Xt=Intl.NumberFormat(void 0,{useGrouping:!1,maximumSignificantDigits:16}).format;function en({options:e,...n}){const{value:t,onChange:a,fullWidth:i,unit:r,hiddenUnit:u,validate:m,displayUnit:f,onDisplayUnitChange:p,displayUnitLocked:j,onDisplayUnitLockedChange:x,...l}=q(n),{onError:_,editable:g,edit:C,error:z}=l,b=C===void 0?g:C,y=Et(z),[v,T]=G(f||r,{onChange:p}),[E,O]=G(j===void 0?!0:j,{onChange:x}),M=w.useCallback(s=>{I(r!==void 0,"unit must be a unit"),I(v!==void 0,"displayUnit must be defined"),E||a?.(oe(oe(t,r).to(v).toNumber(),s).to(r).toNumber()),T?.(s)},[E,t,a,r,v,T]),R=w.useMemo(()=>e?.notation=="scientific"?Ye:Intl.NumberFormat(void 0,e||{maximumSignificantDigits:12}).format,[e]),V=w.useCallback((s,k)=>{if(s===void 0)return"";if(k&&(I(r!==void 0,"unit must be defined to use displayUnit"),s=oe(s,r).to(k).toNumber()),b){const D=Math.abs(s);return D!==0&&(D<1e-12||D>1e12)?Gt(s):Xt(s)}return R(s)},[R,b,r]),L=w.useCallback(s=>V(s,v),[V,v]),S=w.useCallback(s=>{(y.current||s!==void 0)&&_?.(s)},[_,y]),[U,B]=G(t,{transform:L}),$=w.useCallback(s=>{if(!s){a?.(void 0),S(void 0);return}if(r){const{value:k,error:D,containsUnit:N}=He(s,v);if(D||k===void 0){S(D);return}let A;N&&(A=k.formatUnits(),E||M(A)),S(void 0);const P=k.to(r).toNumber();a?.(P),B(V(P,A||v))}else{const k=Number(s);if(Number.isNaN(k)){S("Invalid number");return}if(m){const D=m(k);if(D.error){S(D.error);return}else S(void 0),a?.(D.value)}else S(void 0),a?.(k)}},[S,a,r,v,E,M,V,B,m]),h=w.useCallback(s=>{B(s)},[B]),d=w.useCallback(s=>{$(s)},[$]);nt(()=>{if(U&&U!==L(t)){if(U.trim()!==U)return;const s=Number(U);if(Number.isNaN(s)||U!==L(s))return;$(U)}},[$,U,L,t]);const c=(r||v)&&!u&&t!==void 0;return o.jsxs(ze,{direction:"row",width:i?"100%":void 0,alignItems:"center",spacing:b?0:1,children:[o.jsx(H,{fullWidth:b,value:U,onInputChange:h,onSubmit:d,...l,submitOnTypingDelay:-1}),c&&o.jsx(Ge,{label:void 0,unit:r,displayUnit:v,displayUnitLocked:b?E:void 0,onDisplayUnitChange:M,onDisplayUnitLockedChange:O,onError:S,variant:b?"edit":"standard"})]})}var fe={exports:{}},tn=fe.exports,Re;function nn(){return Re||(Re=1,function(e,n){(function(t,a){e.exports=a()})(tn,function(){var t=1e3,a=6e4,i=36e5,r="millisecond",u="second",m="minute",f="hour",p="day",j="week",x="month",l="quarter",_="year",g="date",C="Invalid Date",z=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,b=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,y={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function($){var h=["th","st","nd","rd"],d=$%100;return"["+$+(h[(d-20)%10]||h[d]||h[0])+"]"}},v=function($,h,d){var c=String($);return!c||c.length>=h?$:""+Array(h+1-c.length).join(d)+$},T={s:v,z:function($){var h=-$.utcOffset(),d=Math.abs(h),c=Math.floor(d/60),s=d%60;return(h<=0?"+":"-")+v(c,2,"0")+":"+v(s,2,"0")},m:function $(h,d){if(h.date()<d.date())return-$(d,h);var c=12*(d.year()-h.year())+(d.month()-h.month()),s=h.clone().add(c,x),k=d-s<0,D=h.clone().add(c+(k?-1:1),x);return+(-(c+(d-s)/(k?s-D:D-s))||0)},a:function($){return $<0?Math.ceil($)||0:Math.floor($)},p:function($){return{M:x,y:_,w:j,d:p,D:g,h:f,m,s:u,ms:r,Q:l}[$]||String($||"").toLowerCase().replace(/s$/,"")},u:function($){return $===void 0}},E="en",O={};O[E]=y;var M="$isDayjsObject",R=function($){return $ instanceof U||!(!$||!$[M])},V=function $(h,d,c){var s;if(!h)return E;if(typeof h=="string"){var k=h.toLowerCase();O[k]&&(s=k),d&&(O[k]=d,s=k);var D=h.split("-");if(!s&&D.length>1)return $(D[0])}else{var N=h.name;O[N]=h,s=N}return!c&&s&&(E=s),s||!c&&E},L=function($,h){if(R($))return $.clone();var d=typeof h=="object"?h:{};return d.date=$,d.args=arguments,new U(d)},S=T;S.l=V,S.i=R,S.w=function($,h){return L($,{locale:h.$L,utc:h.$u,x:h.$x,$offset:h.$offset})};var U=function(){function $(d){this.$L=V(d.locale,null,!0),this.parse(d),this.$x=this.$x||d.x||{},this[M]=!0}var h=$.prototype;return h.parse=function(d){this.$d=function(c){var s=c.date,k=c.utc;if(s===null)return new Date(NaN);if(S.u(s))return new Date;if(s instanceof Date)return new Date(s);if(typeof s=="string"&&!/Z$/i.test(s)){var D=s.match(z);if(D){var N=D[2]-1||0,A=(D[7]||"0").substring(0,3);return k?new Date(Date.UTC(D[1],N,D[3]||1,D[4]||0,D[5]||0,D[6]||0,A)):new Date(D[1],N,D[3]||1,D[4]||0,D[5]||0,D[6]||0,A)}}return new Date(s)}(d),this.init()},h.init=function(){var d=this.$d;this.$y=d.getFullYear(),this.$M=d.getMonth(),this.$D=d.getDate(),this.$W=d.getDay(),this.$H=d.getHours(),this.$m=d.getMinutes(),this.$s=d.getSeconds(),this.$ms=d.getMilliseconds()},h.$utils=function(){return S},h.isValid=function(){return this.$d.toString()!==C},h.isSame=function(d,c){var s=L(d);return this.startOf(c)<=s&&s<=this.endOf(c)},h.isAfter=function(d,c){return L(d)<this.startOf(c)},h.isBefore=function(d,c){return this.endOf(c)<L(d)},h.$g=function(d,c,s){return S.u(d)?this[c]:this.set(s,d)},h.unix=function(){return Math.floor(this.valueOf()/1e3)},h.valueOf=function(){return this.$d.getTime()},h.startOf=function(d,c){var s=this,k=!!S.u(c)||c,D=S.p(d),N=function(ee,W){var Z=S.w(s.$u?Date.UTC(s.$y,W,ee):new Date(s.$y,W,ee),s);return k?Z:Z.endOf(p)},A=function(ee,W){return S.w(s.toDate()[ee].apply(s.toDate("s"),(k?[0,0,0,0]:[23,59,59,999]).slice(W)),s)},P=this.$W,F=this.$M,J=this.$D,ne="set"+(this.$u?"UTC":"");switch(D){case _:return k?N(1,0):N(31,11);case x:return k?N(1,F):N(0,F+1);case j:var X=this.$locale().weekStart||0,re=(P<X?P+7:P)-X;return N(k?J-re:J+(6-re),F);case p:case g:return A(ne+"Hours",0);case f:return A(ne+"Minutes",1);case m:return A(ne+"Seconds",2);case u:return A(ne+"Milliseconds",3);default:return this.clone()}},h.endOf=function(d){return this.startOf(d,!1)},h.$set=function(d,c){var s,k=S.p(d),D="set"+(this.$u?"UTC":""),N=(s={},s[p]=D+"Date",s[g]=D+"Date",s[x]=D+"Month",s[_]=D+"FullYear",s[f]=D+"Hours",s[m]=D+"Minutes",s[u]=D+"Seconds",s[r]=D+"Milliseconds",s)[k],A=k===p?this.$D+(c-this.$W):c;if(k===x||k===_){var P=this.clone().set(g,1);P.$d[N](A),P.init(),this.$d=P.set(g,Math.min(this.$D,P.daysInMonth())).$d}else N&&this.$d[N](A);return this.init(),this},h.set=function(d,c){return this.clone().$set(d,c)},h.get=function(d){return this[S.p(d)]()},h.add=function(d,c){var s,k=this;d=Number(d);var D=S.p(c),N=function(F){var J=L(k);return S.w(J.date(J.date()+Math.round(F*d)),k)};if(D===x)return this.set(x,this.$M+d);if(D===_)return this.set(_,this.$y+d);if(D===p)return N(1);if(D===j)return N(7);var A=(s={},s[m]=a,s[f]=i,s[u]=t,s)[D]||1,P=this.$d.getTime()+d*A;return S.w(P,this)},h.subtract=function(d,c){return this.add(-1*d,c)},h.format=function(d){var c=this,s=this.$locale();if(!this.isValid())return s.invalidDate||C;var k=d||"YYYY-MM-DDTHH:mm:ssZ",D=S.z(this),N=this.$H,A=this.$m,P=this.$M,F=s.weekdays,J=s.months,ne=s.meridiem,X=function(W,Z,se,ce){return W&&(W[Z]||W(c,k))||se[Z].slice(0,ce)},re=function(W){return S.s(N%12||12,W,"0")},ee=ne||function(W,Z,se){var ce=W<12?"AM":"PM";return se?ce.toLowerCase():ce};return k.replace(b,function(W,Z){return Z||function(se){switch(se){case"YY":return String(c.$y).slice(-2);case"YYYY":return S.s(c.$y,4,"0");case"M":return P+1;case"MM":return S.s(P+1,2,"0");case"MMM":return X(s.monthsShort,P,J,3);case"MMMM":return X(J,P);case"D":return c.$D;case"DD":return S.s(c.$D,2,"0");case"d":return String(c.$W);case"dd":return X(s.weekdaysMin,c.$W,F,2);case"ddd":return X(s.weekdaysShort,c.$W,F,3);case"dddd":return F[c.$W];case"H":return String(N);case"HH":return S.s(N,2,"0");case"h":return re(1);case"hh":return re(2);case"a":return ee(N,A,!0);case"A":return ee(N,A,!1);case"m":return String(A);case"mm":return S.s(A,2,"0");case"s":return String(c.$s);case"ss":return S.s(c.$s,2,"0");case"SSS":return S.s(c.$ms,3,"0");case"Z":return D}return null}(W)||D.replace(":","")})},h.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},h.diff=function(d,c,s){var k,D=this,N=S.p(c),A=L(d),P=(A.utcOffset()-this.utcOffset())*a,F=this-A,J=function(){return S.m(D,A)};switch(N){case _:k=J()/12;break;case x:k=J();break;case l:k=J()/3;break;case j:k=(F-P)/6048e5;break;case p:k=(F-P)/864e5;break;case f:k=F/i;break;case m:k=F/a;break;case u:k=F/t;break;default:k=F}return s?k:S.a(k)},h.daysInMonth=function(){return this.endOf(x).$D},h.$locale=function(){return O[this.$L]},h.locale=function(d,c){if(!d)return this.$L;var s=this.clone(),k=V(d,c,!0);return k&&(s.$L=k),s},h.clone=function(){return S.w(this.$d,this)},h.toDate=function(){return new Date(this.valueOf())},h.toJSON=function(){return this.isValid()?this.toISOString():null},h.toISOString=function(){return this.$d.toISOString()},h.toString=function(){return this.$d.toUTCString()},$}(),B=U.prototype;return L.prototype=B,[["$ms",r],["$s",u],["$m",m],["$H",f],["$W",p],["$M",x],["$y",_],["$D",g]].forEach(function($){B[$[1]]=function(h){return this.$g(h,$[0],$[1])}}),L.extend=function($,h){return $.$i||($(h,U,L),$.$i=!0),L},L.locale=V,L.isDayjs=R,L.unix=function($){return L(1e3*$)},L.en=O[E],L.Ls=O,L.p={},L})}(fe)),fe.exports}var rn=nn();const Ee=Ze(rn);var he={exports:{}},sn=he.exports,Pe;function an(){return Pe||(Pe=1,function(e,n){(function(t,a){e.exports=a()})(sn,function(){return{name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var a=["th","st","nd","rd"],i=t%100;return"["+t+(a[(i-20)%10]||a[i]||a[0])+"]"}}})}(he)),he.exports}an();var me={exports:{}},on=me.exports,Fe;function ln(){return Fe||(Fe=1,function(e,n){(function(t,a){e.exports=a()})(on,function(){return function(t,a,i){t=t||{};var r=a.prototype,u={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function m(p,j,x,l){return r.fromToBase(p,j,x,l)}i.en.relativeTime=u,r.fromToBase=function(p,j,x,l,_){for(var g,C,z,b=x.$locale().relativeTime||u,y=t.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],v=y.length,T=0;T<v;T+=1){var E=y[T];E.d&&(g=l?i(p).diff(x,E.d,!0):x.diff(p,E.d,!0));var O=(t.rounding||Math.round)(Math.abs(g));if(z=g>0,O<=E.r||!E.r){O<=1&&T>0&&(E=y[T-1]);var M=b[E.l];_&&(O=_(""+O)),C=typeof M=="string"?M.replace("%d",O):M(O,j,E.l,z);break}}if(j)return C;var R=z?b.future:b.past;return typeof R=="function"?R(C):R.replace("%s",C)},r.to=function(p,j){return m(p,j,this,!0)},r.from=function(p,j){return m(p,j,this)};var f=function(p){return p.$u?i.utc():i()};r.toNow=function(p){return this.to(f(this),p)},r.fromNow=function(p){return this.from(f(this),p)}}})}(me)),me.exports}var un=ln();const cn=Ze(un);Ee.extend(cn);function dn({referenceTimeValue:e,withoutSuffix:n=!1,...t}){const{editable:a,value:i}=q(t);I(!a,"");const r=e?Ee(i).from(e,n):Ee(i).fromNow(n);return o.jsx(H,{value:r})}function fn({sectionDefinition:e,...n}){const{upload_id:t,entry_id:a}=qe(),i={entity:"section",sectionDefinition:e},r=`/uploads/${t}/entries/${a}/archive`;return o.jsx(tt,{...n,selectOptions:i,initialPath:r})}function ue(e,n){if(!e||typeof e!="object")return;const t=e.eln;if(!(!t||typeof t!="object"||Array.isArray(t)))return t[n]}function Te(){return e=>({value:e})}function hn(e){const n=ue(e,"suggestions");return n?t=>Array.isArray(n)?n.includes(t)?{value:t,values:n}:{error:`Invalid value. Allowed values: ${n.join(", ")}`,values:n}:{error:"Invalid configuration: 'suggestions' must be an array",values:void 0}:t=>({value:t,values:void 0})}function mn(e){const n=ue(e,"minValue"),t=ue(e,"maxValue");return a=>{const i=Number(a);return isNaN(i)?{error:"Value must be a number"}:n!==void 0&&i<n?{error:`Value must be at least ${n}`}:t!==void 0&&i>t?{error:`Value must be at most ${t}`}:{value:i}}}function pn(e){const n=ue(e,"boolean_labels");if(!n)return Te();const t=Object.keys(n),a=Object.values(n);return i=>{let r;if(i===void 0)r="undefined";else if(typeof i=="boolean")r=i?"true":"false";else return{error:"Invalid type, expected boolean or undefined"};return t.includes(r)?{value:i,values:a}:{error:`Invalid value. Allowed values: ${t.join(", ")}`,values:a}}}function Se(e){if(e&&e.type_kind==="enum")return e.type_data.length<=8?{EnumRadio:{row:e.type_data.length<=3,values:e.type_data}}:{EnumSelect:{values:e.type_data}}}const Ve={StringEditQuantity:()=>"Text",URLEditQuantity:()=>"Text",FileEditQuantity:()=>"Text",RichTextEditQuantity:()=>"Text",EnumEditQuantity:e=>Se(e)||"Text",RadioEnumEditQuantity:e=>Se(e)||"EnumRadio",BoolEditQuantity:()=>"Boolean",NumberEditQuantity:()=>"Numeral",DateTimeEditQuantity:()=>({Datetime:{variant:"datetime"}}),DateEditQuantity:()=>({Datetime:{variant:"datetime"}}),TimeEditQuantity:()=>({Datetime:{variant:"datetime"}}),AuthorEditQuantity:e=>({Author:{layout:e?.type_kind==="Author"?"Author":"User"}}),AutocompleteEditQuantity:e=>({Autocomplete:{values:e?.type_kind==="enum"?e.type_data:[]}})};function gn(e,n){const t=typeof n?.eln=="object"&&n.eln!==null&&"component"in n.eln?n.eln.component:void 0;if(t&&Ve[t])return Ve[t](e);if(e.type_kind==="python"){if(e.type_data==="str")return"Text";if(e.type_data==="int"||e.type_data==="float")return"Numeral";if(e.type_data==="bool")return"Boolean";throw new Error(`Unknown quantity python type ${e.type_data}`)}if(e.type_kind==="numpy")return"Numeral";if(e.type_kind==="custom"){if(e.type_data===`${K}.Datetime`)return{Datetime:{variant:"datetime"}};if(e.type_data===`${K}.URL`)return"Link";if(e.type_data===`${K}.File`)return"FileReference";if(e.type_data===`${K}.Capitalized`||e.type_data===`${K}.Bytes`)return"Text";if(e.type_data===`${K}.JSON`)return"JsonData";if(e.type_data===`${K}.Unit`||e.type_data===`${K}.Dimension`)return"Text";throw new Error(`Unknown quantity custom type ${e.type_data}`)}if(e.type_kind==="enum")return Se(e);if(e.type_kind==="reference")return{SectionReference:{sectionDefinition:e.type_data.m_ref}};if(e.type_kind==="Author")return"Author";if(e.type_kind==="User")return{Author:{layout:"User"}};throw new Error(`Unknown quantity type kind ${e.type_kind}`)}function vn(e,n){const t=gn(e,n);return typeof t=="string"?{[t]:{}}:t}function bn(e){const{type:n,shape:t=[]}=e,a=e.m_annotations??void 0,i=vn(n,a),u=n.type_kind==="numpy"&&t.length>=1||t.length>=2,m={...e.unit&&{unit:e.unit}};return u?(i.Numeral&&(i.Numeral.options={notation:"scientific"}),{Matrix:{valueComponent:i,...m}}):(Object.assign(i[Object.keys(i)[0]],{actions:{CopyToClipboard:{}}}),t.length>=1?{List:{valueComponent:i,variant:"horizontal",...m}}:{Value:{valueComponent:i,...m}})}function zn(e){const n=bn(e),t=ue(e.m_annotations,"component"),a=t?_n(t,e.m_annotations):Te();return{component:n,validate:a}}function _n(e,n){switch(e){case"EnumEditQuantity":case"RadioEnumEditQuantity":return hn(n);case"NumberEditQuantity":return mn(n);case"BoolEditQuantity":return pn(n);default:return Te()}}const ae={Text:H,Link:Kt,Numeral:en,Boolean:Mt,EnumRadio:It,EnumSelect:qt,Datetime:St,RelativeTime:dn,Id:Dt,JsonData:Zt,FileReference:Yt,SectionReference:fn,Author:Qt,Autocomplete:et},pe={CopyToClipboard:zt,EditToggle:Vt,Help:Tt},ve={Value:Je,List:Lt,Matrix:Jt};function ge(e,n={},t=!1){return le.isValidElement(e)?e:(e=e,Object.entries(e).map(([i,{...r}],u)=>{const m=ae[i]||pe[i]||ve[i],{actions:f,labelActions:p}=r;f!==void 0&&(r.actions=ge(f)),p!==void 0&&(r.labelActions=ge(p));const j=!!ve[i];let x;if(j){const{emptyValue:l,valueComponent:_={Text:{}},...g}=r;x={key:u,...g,...n,...l!==void 0?{createEmptyValue:()=>l}:{},renderValue:()=>ge(_)}}else x={key:u,...t?n:{},...r};return le.createElement(m,x)}))}function yn(e){function n(i){return typeof i=="string"?(I(pe[i]!==void 0,`Unknown component: ${i}`),{[i]:{}}):Array.isArray(i)?i.reduce((r,u)=>(I(typeof u=="string","Action must be a string."),I(pe[u],`Unknown component: ${u}`),r[u]={},r),{}):(le.isValidElement(i)||(I(ie.isPlainObject(i),"JSON component must be string or an object."),Object.keys(i).forEach(r=>{I(pe[r]!==void 0,`Unknown component: ${r}`),I(ie.isPlainObject(i[r]),"Component must be an object.")})),i)}function t(i){if(I(i!==void 0,"A value component must be specified."),typeof i=="string")return I(ae[i]!==void 0,`Unknown component: ${i}`),{[i]:{}};I(ie.isPlainObject(i),"JSON component must be string or an object."),I(Object.keys(i).length===1,"JSON component must have exactly one key.");const r=Object.keys(i)[0];I(ae[r]!==void 0,`Unknown component: ${r}`),I(ie.isPlainObject(i[r]),"Component must be an object.");const u=i[r],m={...u};return I(m,"Typescript assertion"),u.actions&&(m.actions=n(u.actions)),u.labelActions&&(m.labelActions=n(u.labelActions)),{[r]:m}}function a(i){if(typeof i=="string")return ae[i]!==void 0?{Value:{valueComponent:t(i)}}:(I(ve[i]!==void 0,`Unknown component: ${i}`),{Value:{valueComponent:{[i]:{}}}});I(ie.isPlainObject(i),"JSON component must be string or an object."),i=i,I(Object.keys(i).length===1,"JSON component must have exactly one key.");const r=Object.keys(i)[0];if(ae[r]!==void 0)return{Value:{valueComponent:t(i)}};I(ve[r]!==void 0,`Unknown component: ${r}`),I(ie.isPlainObject(i[r]),"Component must be an object.");const m=i[r],f={...m};return I(f,"Typescript assertion"),f.valueComponent=t(m.valueComponent),m.labelActions&&(f.labelActions=n(m.labelActions)),m.actions&&(f.actions=n(m.actions)),{[r]:f}}return a(e)}function it(e,n,t){const a=Object.keys(n)[0],i=Object.keys(e)[0],r=n[a],u=e[i];return i!==a?{[a]:{...r,...u.actions&&!Object.keys(r).includes("actions")&&{actions:u.actions},...t?.(u,r)??{}}}:{[i]:{...u,...r,...t?.(u,r)??{}}}}function xn(e,n){return it(n,e)}function Cn(e,n){return n?it(e,n,(t,a)=>({valueComponent:xn(t.valueComponent,a.valueComponent)})):e}function Tn({component:e,defaultComponent:n,...t}){const a=w.useMemo(()=>yn(e),[e]);return ge(Cn(a,n),t)}function Ln({path:e,children:n}){return o.jsx(Ke.Provider,{value:{path:e},children:n})}export{Tn as D,Vt as E,Zt as J,Kt as L,Dn as S,Ge as U,At as a,nt as b,zn as c,Ln as d,ge as e,Ut as g,Cn as m,yn as n,Pt as u};
